Run started: 2025-12-29T04:36:24.556242
Arguments: Namespace(source='marin', n_samples=[512, 1024, 4096, 8192, 16384], seq_len=4096, pooling_method='mean', model_path='plantcad/marin_exp2101__pcv2_pretrain_c4096__checkpoints', model_subfolder='checkpoints/wikitext_pretrain_c4096_v0.1', seed=42, batch_size=64, device='cuda', output_dir='eigenspectrum_results_v29', force=False, species_filter=None, split='train', dataset_path='Salesforce/wikitext', dataset_config='wikitext-2-v1', dataset_revision='main', text_column='text', tokenization_mode='lenient')

============================================================
Eigenspectrum Analysis of DNA Sequences
============================================================
Parameters:
  - Source: marin
  - Sample sizes: [512, 1024, 4096, 8192, 16384]
  - Sequence length: 4096 bp
  - Feature dimension: d_model (model hidden size)
  - Pooling method: mean

Loading dataset from HuggingFace (path=Salesforce/wikitext (config: wikitext-2-v1), revision=main, split=train)...
Dataset size: 36,718 records

Preparing sequences (cropping to 4096 bp and filtering empty)...
  Records before filtering: 36,718
  Records after filtering: 23,767
  Empty sequences filtered: 12,951
Sampling 16384 records...
Extracting records...
  Unique species: 1
Loading AutoModelForCausalLM from plantcad/marin_exp2101__pcv2_pretrain_c4096__checkpoints subfolder=checkpoints/wikitext_pretrain_c4096_v0.1 with dtype=torch.bfloat16...
  Hidden size: 384
  Parameters: 48,042,624 (48.0M)
  Device: cuda, Dtype: torch.bfloat16
  Model:
Qwen2ForCausalLM(
  (model): Qwen2Model(
    (embed_tokens): Embedding(50257, 384)
    (layers): ModuleList(
      (0-3): 4 x Qwen2DecoderLayer(
        (self_attn): Qwen2Attention(
          (q_proj): Linear(in_features=384, out_features=384, bias=True)
          (k_proj): Linear(in_features=384, out_features=384, bias=True)
          (v_proj): Linear(in_features=384, out_features=384, bias=True)
          (o_proj): Linear(in_features=384, out_features=384, bias=False)
        )
        (mlp): Qwen2MLP(
          (gate_proj): Linear(in_features=384, out_features=1536, bias=False)
          (up_proj): Linear(in_features=384, out_features=1536, bias=False)
          (down_proj): Linear(in_features=1536, out_features=384, bias=False)
          (act_fn): SiLU()
        )
        (input_layernorm): Qwen2RMSNorm((384,), eps=1e-06)
        (post_attention_layernorm): Qwen2RMSNorm((384,), eps=1e-06)
      )
    )
    (norm): Qwen2RMSNorm((384,), eps=1e-06)
    (rotary_emb): Qwen2RotaryEmbedding()
  )
  (lm_head): Linear(in_features=384, out_features=50257, bias=False)
)
Extracting embeddings:   0%|          | 0/256 [00:00<?, ?it/s]Extracting embeddings:   0%|          | 1/256 [00:02<11:11,  2.63s/it]Extracting embeddings:   1%|          | 2/256 [00:02<05:05,  1.20s/it]Extracting embeddings:   1%|1         | 3/256 [00:03<03:08,  1.34it/s]Extracting embeddings:   2%|1         | 4/256 [00:03<02:13,  1.89it/s]Extracting embeddings:   2%|1         | 5/256 [00:03<01:42,  2.44it/s]Extracting embeddings:   2%|2         | 6/256 [00:03<01:24,  2.96it/s]Extracting embeddings:   3%|2         | 7/256 [00:03<01:12,  3.43it/s]Extracting embeddings:   3%|3         | 8/256 [00:04<01:05,  3.81it/s]Extracting embeddings:   4%|3         | 9/256 [00:04<00:59,  4.12it/s]Extracting embeddings:   4%|3         | 10/256 [00:04<00:56,  4.37it/s]Extracting embeddings:   4%|4         | 11/256 [00:04<00:53,  4.56it/s]Extracting embeddings:   5%|4         | 12/256 [00:04<00:51,  4.70it/s]Extracting embeddings:   5%|5         | 13/256 [00:05<00:50,  4.79it/s]Extracting embeddings:   5%|5         | 14/256 [00:05<00:49,  4.86it/s]Extracting embeddings:   6%|5         | 15/256 [00:05<00:49,  4.89it/s]Extracting embeddings:   6%|6         | 16/256 [00:05<00:48,  4.95it/s]Extracting embeddings:   7%|6         | 17/256 [00:05<00:48,  4.96it/s]Extracting embeddings:   7%|7         | 18/256 [00:06<00:47,  5.00it/s]Extracting embeddings:   7%|7         | 19/256 [00:06<00:47,  5.01it/s]Extracting embeddings:   8%|7         | 20/256 [00:06<00:47,  5.01it/s]Extracting embeddings:   8%|8         | 21/256 [00:06<00:46,  5.02it/s]Extracting embeddings:   9%|8         | 22/256 [00:06<00:46,  5.06it/s]Extracting embeddings:   9%|8         | 23/256 [00:07<00:46,  5.04it/s]Extracting embeddings:   9%|9         | 24/256 [00:07<00:46,  5.04it/s]Extracting embeddings:  10%|9         | 25/256 [00:07<00:45,  5.04it/s]Extracting embeddings:  10%|#         | 26/256 [00:07<00:45,  5.03it/s]Extracting embeddings:  11%|#         | 27/256 [00:07<00:45,  5.03it/s]Extracting embeddings:  11%|#         | 28/256 [00:07<00:45,  5.02it/s]Extracting embeddings:  11%|#1        | 29/256 [00:08<00:45,  5.01it/s]Extracting embeddings:  12%|#1        | 30/256 [00:08<00:45,  5.02it/s]Extracting embeddings:  12%|#2        | 31/256 [00:08<00:44,  5.04it/s]Extracting embeddings:  12%|#2        | 32/256 [00:08<00:44,  5.01it/s]Extracting embeddings:  13%|#2        | 33/256 [00:08<00:44,  5.01it/s]Extracting embeddings:  13%|#3        | 34/256 [00:09<00:44,  5.01it/s]Extracting embeddings:  14%|#3        | 35/256 [00:09<00:44,  5.01it/s]Extracting embeddings:  14%|#4        | 36/256 [00:09<00:43,  5.01it/s]Extracting embeddings:  14%|#4        | 37/256 [00:09<00:43,  5.02it/s]Extracting embeddings:  15%|#4        | 38/256 [00:09<00:43,  5.01it/s]Extracting embeddings:  15%|#5        | 39/256 [00:10<00:43,  5.00it/s]Extracting embeddings:  16%|#5        | 40/256 [00:10<00:43,  5.01it/s]Extracting embeddings:  16%|#6        | 41/256 [00:10<00:42,  5.01it/s]Extracting embeddings:  16%|#6        | 42/256 [00:10<00:42,  5.00it/s]Extracting embeddings:  17%|#6        | 43/256 [00:10<00:42,  5.01it/s]Extracting embeddings:  17%|#7        | 44/256 [00:11<00:42,  5.02it/s]Extracting embeddings:  18%|#7        | 45/256 [00:11<00:41,  5.03it/s]Extracting embeddings:  18%|#7        | 46/256 [00:11<00:41,  5.01it/s]Extracting embeddings:  18%|#8        | 47/256 [00:11<00:41,  4.99it/s]Extracting embeddings:  19%|#8        | 48/256 [00:11<00:41,  5.01it/s]Extracting embeddings:  19%|#9        | 49/256 [00:12<00:41,  5.02it/s]Extracting embeddings:  20%|#9        | 50/256 [00:12<00:41,  5.02it/s]Extracting embeddings:  20%|#9        | 51/256 [00:12<00:40,  5.02it/s]Extracting embeddings:  20%|##        | 52/256 [00:12<00:40,  5.03it/s]Extracting embeddings:  21%|##        | 53/256 [00:12<00:40,  5.03it/s]Extracting embeddings:  21%|##1       | 54/256 [00:13<00:40,  5.03it/s]Extracting embeddings:  21%|##1       | 55/256 [00:13<00:39,  5.03it/s]Extracting embeddings:  22%|##1       | 56/256 [00:13<00:39,  5.01it/s]Extracting embeddings:  22%|##2       | 57/256 [00:13<00:39,  5.04it/s]Extracting embeddings:  23%|##2       | 58/256 [00:13<00:39,  5.01it/s]Extracting embeddings:  23%|##3       | 59/256 [00:14<00:39,  5.01it/s]Extracting embeddings:  23%|##3       | 60/256 [00:14<00:39,  5.02it/s]Extracting embeddings:  24%|##3       | 61/256 [00:14<00:38,  5.01it/s]Extracting embeddings:  24%|##4       | 62/256 [00:14<00:38,  5.00it/s]Extracting embeddings:  25%|##4       | 63/256 [00:14<00:38,  5.00it/s]Extracting embeddings:  25%|##5       | 64/256 [00:15<00:38,  5.03it/s]Extracting embeddings:  25%|##5       | 65/256 [00:15<00:38,  5.00it/s]Extracting embeddings:  26%|##5       | 66/256 [00:15<00:37,  5.01it/s]Extracting embeddings:  26%|##6       | 67/256 [00:15<00:37,  5.01it/s]Extracting embeddings:  27%|##6       | 68/256 [00:15<00:37,  4.99it/s]Extracting embeddings:  27%|##6       | 69/256 [00:16<00:37,  5.01it/s]Extracting embeddings:  27%|##7       | 70/256 [00:16<00:37,  5.02it/s]Extracting embeddings:  28%|##7       | 71/256 [00:16<00:36,  5.02it/s]Extracting embeddings:  28%|##8       | 72/256 [00:16<00:36,  5.01it/s]Extracting embeddings:  29%|##8       | 73/256 [00:16<00:36,  5.02it/s]Extracting embeddings:  29%|##8       | 74/256 [00:17<00:36,  5.02it/s]Extracting embeddings:  29%|##9       | 75/256 [00:17<00:36,  5.02it/s]Extracting embeddings:  30%|##9       | 76/256 [00:17<00:35,  5.03it/s]Extracting embeddings:  30%|###       | 77/256 [00:17<00:35,  5.03it/s]Extracting embeddings:  30%|###       | 78/256 [00:17<00:35,  5.03it/s]Extracting embeddings:  31%|###       | 79/256 [00:18<00:35,  5.02it/s]Extracting embeddings:  31%|###1      | 80/256 [00:18<00:35,  5.01it/s]Extracting embeddings:  32%|###1      | 81/256 [00:18<00:34,  5.01it/s]Extracting embeddings:  32%|###2      | 82/256 [00:18<00:34,  5.02it/s]Extracting embeddings:  32%|###2      | 83/256 [00:18<00:34,  5.03it/s]Extracting embeddings:  33%|###2      | 84/256 [00:19<00:34,  5.01it/s]Extracting embeddings:  33%|###3      | 85/256 [00:19<00:34,  5.01it/s]Extracting embeddings:  34%|###3      | 86/256 [00:19<00:33,  5.02it/s]Extracting embeddings:  34%|###3      | 87/256 [00:19<00:33,  5.03it/s]Extracting embeddings:  34%|###4      | 88/256 [00:19<00:33,  5.03it/s]Extracting embeddings:  35%|###4      | 89/256 [00:20<00:33,  5.03it/s]Extracting embeddings:  35%|###5      | 90/256 [00:20<00:32,  5.03it/s]Extracting embeddings:  36%|###5      | 91/256 [00:20<00:32,  5.03it/s]Extracting embeddings:  36%|###5      | 92/256 [00:20<00:32,  5.02it/s]Extracting embeddings:  36%|###6      | 93/256 [00:20<00:32,  5.03it/s]Extracting embeddings:  37%|###6      | 94/256 [00:21<00:32,  5.03it/s]Extracting embeddings:  37%|###7      | 95/256 [00:21<00:32,  5.02it/s]Extracting embeddings:  38%|###7      | 96/256 [00:21<00:31,  5.03it/s]Extracting embeddings:  38%|###7      | 97/256 [00:21<00:31,  5.03it/s]Extracting embeddings:  38%|###8      | 98/256 [00:21<00:31,  5.02it/s]Extracting embeddings:  39%|###8      | 99/256 [00:22<00:31,  5.03it/s]Extracting embeddings:  39%|###9      | 100/256 [00:22<00:31,  5.01it/s]Extracting embeddings:  39%|###9      | 101/256 [00:22<00:30,  5.02it/s]Extracting embeddings:  40%|###9      | 102/256 [00:22<00:30,  5.03it/s]Extracting embeddings:  40%|####      | 103/256 [00:22<00:30,  5.03it/s]Extracting embeddings:  41%|####      | 104/256 [00:23<00:30,  5.01it/s]Extracting embeddings:  41%|####1     | 105/256 [00:23<00:30,  5.01it/s]Extracting embeddings:  41%|####1     | 106/256 [00:23<00:29,  5.00it/s]Extracting embeddings:  42%|####1     | 107/256 [00:23<00:29,  5.01it/s]Extracting embeddings:  42%|####2     | 108/256 [00:23<00:29,  5.01it/s]Extracting embeddings:  43%|####2     | 109/256 [00:24<00:29,  5.02it/s]Extracting embeddings:  43%|####2     | 110/256 [00:24<00:29,  5.01it/s]Extracting embeddings:  43%|####3     | 111/256 [00:24<00:28,  5.02it/s]Extracting embeddings:  44%|####3     | 112/256 [00:24<00:28,  5.02it/s]Extracting embeddings:  44%|####4     | 113/256 [00:24<00:28,  5.01it/s]Extracting embeddings:  45%|####4     | 114/256 [00:25<00:28,  5.00it/s]Extracting embeddings:  45%|####4     | 115/256 [00:25<00:28,  5.00it/s]Extracting embeddings:  45%|####5     | 116/256 [00:25<00:27,  5.01it/s]Extracting embeddings:  46%|####5     | 117/256 [00:25<00:27,  5.00it/s]Extracting embeddings:  46%|####6     | 118/256 [00:25<00:27,  4.99it/s]Extracting embeddings:  46%|####6     | 119/256 [00:26<00:27,  4.99it/s]Extracting embeddings:  47%|####6     | 120/256 [00:26<00:27,  5.00it/s]Extracting embeddings:  47%|####7     | 121/256 [00:26<00:26,  5.01it/s]Extracting embeddings:  48%|####7     | 122/256 [00:26<00:26,  5.02it/s]Extracting embeddings:  48%|####8     | 123/256 [00:26<00:26,  5.00it/s]Extracting embeddings:  48%|####8     | 124/256 [00:27<00:26,  5.00it/s]Extracting embeddings:  49%|####8     | 125/256 [00:27<00:26,  5.01it/s]Extracting embeddings:  49%|####9     | 126/256 [00:27<00:25,  5.01it/s]Extracting embeddings:  50%|####9     | 127/256 [00:27<00:25,  5.01it/s]Extracting embeddings:  50%|#####     | 128/256 [00:27<00:25,  5.01it/s]Extracting embeddings:  50%|#####     | 129/256 [00:28<00:25,  5.01it/s]Extracting embeddings:  51%|#####     | 130/256 [00:28<00:25,  5.02it/s]Extracting embeddings:  51%|#####1    | 131/256 [00:28<00:24,  5.03it/s]Extracting embeddings:  52%|#####1    | 132/256 [00:28<00:24,  5.03it/s]Extracting embeddings:  52%|#####1    | 133/256 [00:28<00:24,  5.02it/s]Extracting embeddings:  52%|#####2    | 134/256 [00:29<00:24,  5.02it/s]Extracting embeddings:  53%|#####2    | 135/256 [00:29<00:24,  5.01it/s]Extracting embeddings:  53%|#####3    | 136/256 [00:29<00:23,  5.01it/s]Extracting embeddings:  54%|#####3    | 137/256 [00:29<00:23,  5.01it/s]Extracting embeddings:  54%|#####3    | 138/256 [00:29<00:23,  5.01it/s]Extracting embeddings:  54%|#####4    | 139/256 [00:30<00:23,  5.02it/s]Extracting embeddings:  55%|#####4    | 140/256 [00:30<00:23,  5.02it/s]Extracting embeddings:  55%|#####5    | 141/256 [00:30<00:22,  5.01it/s]Extracting embeddings:  55%|#####5    | 142/256 [00:30<00:22,  5.00it/s]Extracting embeddings:  56%|#####5    | 143/256 [00:30<00:22,  5.01it/s]Extracting embeddings:  56%|#####6    | 144/256 [00:31<00:22,  5.02it/s]Extracting embeddings:  57%|#####6    | 145/256 [00:31<00:22,  5.02it/s]Extracting embeddings:  57%|#####7    | 146/256 [00:31<00:21,  5.03it/s]Extracting embeddings:  57%|#####7    | 147/256 [00:31<00:21,  5.02it/s]Extracting embeddings:  58%|#####7    | 148/256 [00:31<00:21,  5.01it/s]Extracting embeddings:  58%|#####8    | 149/256 [00:32<00:21,  5.00it/s]Extracting embeddings:  59%|#####8    | 150/256 [00:32<00:21,  5.01it/s]Extracting embeddings:  59%|#####8    | 151/256 [00:32<00:20,  5.01it/s]Extracting embeddings:  59%|#####9    | 152/256 [00:32<00:20,  5.01it/s]Extracting embeddings:  60%|#####9    | 153/256 [00:32<00:20,  5.01it/s]Extracting embeddings:  60%|######    | 154/256 [00:33<00:20,  5.01it/s]Extracting embeddings:  61%|######    | 155/256 [00:33<00:20,  5.00it/s]Extracting embeddings:  61%|######    | 156/256 [00:33<00:20,  4.99it/s]Extracting embeddings:  61%|######1   | 157/256 [00:33<00:19,  4.99it/s]Extracting embeddings:  62%|######1   | 158/256 [00:33<00:19,  4.98it/s]Extracting embeddings:  62%|######2   | 159/256 [00:34<00:19,  4.98it/s]Extracting embeddings:  62%|######2   | 160/256 [00:34<00:19,  4.99it/s]Extracting embeddings:  63%|######2   | 161/256 [00:34<00:19,  4.99it/s]Extracting embeddings:  63%|######3   | 162/256 [00:34<00:18,  5.00it/s]Extracting embeddings:  64%|######3   | 163/256 [00:34<00:18,  5.01it/s]Extracting embeddings:  64%|######4   | 164/256 [00:35<00:18,  5.01it/s]Extracting embeddings:  64%|######4   | 165/256 [00:35<00:18,  5.01it/s]Extracting embeddings:  65%|######4   | 166/256 [00:35<00:17,  5.02it/s]Extracting embeddings:  65%|######5   | 167/256 [00:35<00:17,  5.00it/s]Extracting embeddings:  66%|######5   | 168/256 [00:35<00:17,  4.99it/s]Extracting embeddings:  66%|######6   | 169/256 [00:36<00:17,  4.98it/s]Extracting embeddings:  66%|######6   | 170/256 [00:36<00:17,  5.00it/s]Extracting embeddings:  67%|######6   | 171/256 [00:36<00:16,  5.01it/s]Extracting embeddings:  67%|######7   | 172/256 [00:36<00:16,  5.00it/s]Extracting embeddings:  68%|######7   | 173/256 [00:36<00:16,  5.00it/s]Extracting embeddings:  68%|######7   | 174/256 [00:37<00:16,  5.00it/s]Extracting embeddings:  68%|######8   | 175/256 [00:37<00:16,  5.00it/s]Extracting embeddings:  69%|######8   | 176/256 [00:37<00:15,  5.01it/s]Extracting embeddings:  69%|######9   | 177/256 [00:37<00:15,  5.01it/s]Extracting embeddings:  70%|######9   | 178/256 [00:37<00:15,  5.00it/s]Extracting embeddings:  70%|######9   | 179/256 [00:38<00:15,  4.99it/s]Extracting embeddings:  70%|#######   | 180/256 [00:38<00:15,  5.00it/s]Extracting embeddings:  71%|#######   | 181/256 [00:38<00:14,  5.00it/s]Extracting embeddings:  71%|#######1  | 182/256 [00:38<00:14,  5.00it/s]Extracting embeddings:  71%|#######1  | 183/256 [00:38<00:14,  5.00it/s]Extracting embeddings:  72%|#######1  | 184/256 [00:39<00:14,  5.00it/s]Extracting embeddings:  72%|#######2  | 185/256 [00:39<00:14,  5.00it/s]Extracting embeddings:  73%|#######2  | 186/256 [00:39<00:14,  4.98it/s]Extracting embeddings:  73%|#######3  | 187/256 [00:39<00:13,  5.01it/s]Extracting embeddings:  73%|#######3  | 188/256 [00:39<00:13,  5.02it/s]Extracting embeddings:  74%|#######3  | 189/256 [00:40<00:13,  5.02it/s]Extracting embeddings:  74%|#######4  | 190/256 [00:40<00:13,  5.02it/s]Extracting embeddings:  75%|#######4  | 191/256 [00:40<00:12,  5.01it/s]Extracting embeddings:  75%|#######5  | 192/256 [00:40<00:12,  4.99it/s]Extracting embeddings:  75%|#######5  | 193/256 [00:40<00:12,  5.00it/s]Extracting embeddings:  76%|#######5  | 194/256 [00:41<00:12,  4.99it/s]Extracting embeddings:  76%|#######6  | 195/256 [00:41<00:12,  5.01it/s]Extracting embeddings:  77%|#######6  | 196/256 [00:41<00:11,  5.01it/s]Extracting embeddings:  77%|#######6  | 197/256 [00:41<00:11,  5.00it/s]Extracting embeddings:  77%|#######7  | 198/256 [00:41<00:11,  4.99it/s]Extracting embeddings:  78%|#######7  | 199/256 [00:42<00:11,  4.99it/s]Extracting embeddings:  78%|#######8  | 200/256 [00:42<00:11,  4.99it/s]Extracting embeddings:  79%|#######8  | 201/256 [00:42<00:10,  5.00it/s]Extracting embeddings:  79%|#######8  | 202/256 [00:42<00:10,  5.00it/s]Extracting embeddings:  79%|#######9  | 203/256 [00:42<00:10,  4.98it/s]Extracting embeddings:  80%|#######9  | 204/256 [00:43<00:10,  4.99it/s]Extracting embeddings:  80%|########  | 205/256 [00:43<00:10,  4.98it/s]Extracting embeddings:  80%|########  | 206/256 [00:43<00:10,  4.99it/s]Extracting embeddings:  81%|########  | 207/256 [00:43<00:09,  4.99it/s]Extracting embeddings:  81%|########1 | 208/256 [00:43<00:09,  5.00it/s]Extracting embeddings:  82%|########1 | 209/256 [00:44<00:09,  5.00it/s]Extracting embeddings:  82%|########2 | 210/256 [00:44<00:09,  5.00it/s]Extracting embeddings:  82%|########2 | 211/256 [00:44<00:08,  5.02it/s]Extracting embeddings:  83%|########2 | 212/256 [00:44<00:08,  5.01it/s]Extracting embeddings:  83%|########3 | 213/256 [00:44<00:08,  5.00it/s]Extracting embeddings:  84%|########3 | 214/256 [00:45<00:08,  5.00it/s]Extracting embeddings:  84%|########3 | 215/256 [00:45<00:08,  4.98it/s]Extracting embeddings:  84%|########4 | 216/256 [00:45<00:08,  4.99it/s]Extracting embeddings:  85%|########4 | 217/256 [00:45<00:07,  4.99it/s]Extracting embeddings:  85%|########5 | 218/256 [00:45<00:07,  5.00it/s]Extracting embeddings:  86%|########5 | 219/256 [00:46<00:07,  5.01it/s]Extracting embeddings:  86%|########5 | 220/256 [00:46<00:07,  5.01it/s]Extracting embeddings:  86%|########6 | 221/256 [00:46<00:06,  5.01it/s]Extracting embeddings:  87%|########6 | 222/256 [00:46<00:06,  5.01it/s]Extracting embeddings:  87%|########7 | 223/256 [00:46<00:06,  5.00it/s]Extracting embeddings:  88%|########7 | 224/256 [00:47<00:06,  5.02it/s]Extracting embeddings:  88%|########7 | 225/256 [00:47<00:06,  5.01it/s]Extracting embeddings:  88%|########8 | 226/256 [00:47<00:05,  5.01it/s]Extracting embeddings:  89%|########8 | 227/256 [00:47<00:05,  5.00it/s]Extracting embeddings:  89%|########9 | 228/256 [00:47<00:05,  5.00it/s]Extracting embeddings:  89%|########9 | 229/256 [00:48<00:05,  5.00it/s]Extracting embeddings:  90%|########9 | 230/256 [00:48<00:05,  4.99it/s]Extracting embeddings:  90%|######### | 231/256 [00:48<00:05,  4.99it/s]Extracting embeddings:  91%|######### | 232/256 [00:48<00:04,  5.01it/s]Extracting embeddings:  91%|#########1| 233/256 [00:48<00:04,  5.00it/s]Extracting embeddings:  91%|#########1| 234/256 [00:49<00:04,  4.98it/s]Extracting embeddings:  92%|#########1| 235/256 [00:49<00:04,  5.00it/s]Extracting embeddings:  92%|#########2| 236/256 [00:49<00:03,  5.01it/s]Extracting embeddings:  93%|#########2| 237/256 [00:49<00:03,  5.00it/s]Extracting embeddings:  93%|#########2| 238/256 [00:49<00:03,  5.00it/s]Extracting embeddings:  93%|#########3| 239/256 [00:50<00:03,  5.01it/s]Extracting embeddings:  94%|#########3| 240/256 [00:50<00:03,  5.01it/s]Extracting embeddings:  94%|#########4| 241/256 [00:50<00:02,  5.01it/s]Extracting embeddings:  95%|#########4| 242/256 [00:50<00:02,  5.00it/s]Extracting embeddings:  95%|#########4| 243/256 [00:50<00:02,  5.01it/s]Extracting embeddings:  95%|#########5| 244/256 [00:51<00:02,  5.01it/s]Extracting embeddings:  96%|#########5| 245/256 [00:51<00:02,  5.02it/s]Extracting embeddings:  96%|#########6| 246/256 [00:51<00:01,  5.01it/s]Extracting embeddings:  96%|#########6| 247/256 [00:51<00:01,  5.01it/s]Extracting embeddings:  97%|#########6| 248/256 [00:51<00:01,  5.00it/s]Extracting embeddings:  97%|#########7| 249/256 [00:52<00:01,  5.01it/s]Extracting embeddings:  98%|#########7| 250/256 [00:52<00:01,  5.01it/s]Extracting embeddings:  98%|#########8| 251/256 [00:52<00:00,  5.01it/s]Extracting embeddings:  98%|#########8| 252/256 [00:52<00:00,  5.01it/s]Extracting embeddings:  99%|#########8| 253/256 [00:52<00:00,  5.00it/s]Extracting embeddings:  99%|#########9| 254/256 [00:53<00:00,  4.98it/s]Extracting embeddings: 100%|#########9| 255/256 [00:53<00:00,  4.98it/s]Extracting embeddings: 100%|##########| 256/256 [00:53<00:00,  4.98it/s]Extracting embeddings: 100%|##########| 256/256 [00:53<00:00,  4.78it/s]
  Embedding matrix shape: (16384, 384)

Computing PCA for n_samples=512...
  Computed 384 eigenvalues
  Top 10 eigenvalues: [2.0560417  1.9429159  1.5635281  1.0726345  0.7192238  0.55228794
 0.4446146  0.3254454  0.29316893 0.22288817]
  Variance explained by top 10: 85.42%

Computing PCA for n_samples=1024...
  Computed 384 eigenvalues
  Top 10 eigenvalues: [2.213513   1.9898003  1.6189997  1.0875279  0.73025185 0.5489567
 0.44404754 0.33564627 0.28728223 0.21745566]
  Variance explained by top 10: 84.78%

Computing PCA for n_samples=4096...
  Computed 384 eigenvalues
  Top 10 eigenvalues: [2.1645381  1.928209   1.5533823  1.0705142  0.8199439  0.5217218
 0.4371093  0.34871733 0.29701307 0.22522783]
  Variance explained by top 10: 84.15%

Computing PCA for n_samples=8192...
  Computed 384 eigenvalues
  Top 10 eigenvalues: [2.1621375  1.8811433  1.5873144  1.0533457  0.7932105  0.51853806
 0.43378213 0.36225334 0.29023585 0.22704487]
  Variance explained by top 10: 83.90%

Computing PCA for n_samples=16384...
  Computed 384 eigenvalues
  Top 10 eigenvalues: [2.175398   1.8512104  1.5915219  1.0563297  0.782935   0.5240229
 0.4315206  0.35582528 0.2834425  0.22526869]
  Variance explained by top 10: 83.78%

Fitting full PCA for classification (n=16384)...

Saving checkpoint to: eigenspectrum_results_v29/eigenspectrum_smarin_l4096_n512_1024_4096_8192_16384_pmean.pkl

For n=16384:
  Components needed for 90% variance: 14
  Components needed for 95% variance: 21
  Effective sample size: 9.19903088
  Condition number: 8.82304102e+09

Figure saved to: eigenspectrum_results_v29/eigenspectrum_smarin_n16384_l4096_pmean.png
PDF saved to: eigenspectrum_results_v29/eigenspectrum_smarin_n16384_l4096_pmean.pdf
Eigenvalue data exported to: eigenspectrum_results_v29/eigenspectrum_smarin_n16384_l4096_pmean.csv

======================================================================
PC SCALING ANALYSIS
Testing n_components: [0, 1, 2, 3, 4, 8, 16, 32, 64, 128, 256, 384]
======================================================================
Extracting sequence features:   0%|          | 0/16384 [00:00<?, ?it/s]Extracting sequence features:  23%|##3       | 3816/16384 [00:00<00:00, 37934.02it/s]Extracting sequence features:  49%|####8     | 7962/16384 [00:00<00:00, 39932.35it/s]Extracting sequence features:  74%|#######4  | 12184/16384 [00:00<00:00, 40820.18it/s]Extracting sequence features: 100%|##########| 16384/16384 [00:00<00:00, 40929.89it/s]
  species              F1: 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00
  gc_content           F1: 0.19 0.30 0.36 0.39 0.40 0.42 0.44 0.45 0.45 0.45 0.46 0.45
  repeat_fraction      F1: 0.20 0.34 0.45 0.48 0.51 0.55 0.62 0.66 0.67 0.67 0.68 0.68
  kmer_entropy_1       F1: 0.20 0.33 0.42 0.47 0.50 0.55 0.59 0.62 0.64 0.64 0.64 0.63
  kmer_entropy_3       F1: 0.19 0.36 0.47 0.53 0.56 0.63 0.68 0.72 0.74 0.74 0.74 0.74
  kmer_entropy_9       F1: 0.20 0.33 0.44 0.51 0.53 0.61 0.68 0.71 0.73 0.73 0.74 0.74
  dinuc_CG             F1: 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00
  dinuc_GC             F1: 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00
  dinuc_AT             F1: 0.16 0.32 0.38 0.40 0.41 0.44 0.46 0.46 0.47 0.46 0.47 0.47
  dinuc_TA             F1: 0.25 0.32 0.40 0.41 0.40 0.46 0.47 0.47 0.49 0.48 0.48 0.47
  dinuc_AA             F1: 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00
  dinuc_TT             F1: 0.44 0.46 0.52 0.52 0.58 0.60 0.62 0.61 0.62 0.60 0.60 0.60

PC scaling curves saved to: eigenspectrum_results_v29/pc_scaling_curves.png
PC scaling curves PDF saved to: eigenspectrum_results_v29/pc_scaling_curves.pdf
PC scaling data exported to: eigenspectrum_results_v29/pc_scaling_curves.csv

======================================================================
SUMMARY: F1 by n_components
======================================================================
Target                     0       1       2       3       4       8      16      32      64     128     256     384
--------------------------------------------------------------------------------------------------------------------
dinuc_AA               1.000   1.000   1.000   1.000   1.000   1.000   1.000   1.000   1.000   1.000   1.000   1.000
dinuc_AT               0.155   0.320   0.378   0.400   0.414   0.442   0.460   0.463   0.471   0.461   0.469   0.470
dinuc_CG               1.000   1.000   1.000   1.000   1.000   1.000   1.000   1.000   1.000   1.000   1.000   1.000
dinuc_GC               1.000   1.000   1.000   1.000   1.000   1.000   1.000   1.000   1.000   1.000   1.000   1.000
dinuc_TA               0.250   0.318   0.397   0.408   0.400   0.457   0.474   0.468   0.490   0.477   0.481   0.469
dinuc_TT               0.444   0.458   0.519   0.520   0.581   0.602   0.616   0.612   0.616   0.602   0.597   0.603
gc_content             0.190   0.300   0.356   0.388   0.401   0.418   0.442   0.452   0.454   0.452   0.455   0.447
kmer_entropy_1         0.202   0.332   0.423   0.475   0.501   0.550   0.587   0.625   0.637   0.636   0.641   0.633
kmer_entropy_3         0.194   0.362   0.468   0.533   0.558   0.627   0.683   0.723   0.736   0.744   0.744   0.739
kmer_entropy_9         0.201   0.331   0.438   0.505   0.527   0.613   0.681   0.713   0.731   0.730   0.740   0.742
repeat_fraction        0.202   0.340   0.447   0.476   0.511   0.546   0.624   0.655   0.673   0.671   0.677   0.681
species                1.000   1.000   1.000   1.000   1.000   1.000   1.000   1.000   1.000   1.000   1.000   1.000

Training species classifier with n_components=384 PCs...

[Species] n_classes=1, acc=1.000, f1=1.000
/work/10459/eczech/vista/envs/ml-rel/lib/python3.11/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
Confusion matrix saved to: eigenspectrum_results_v29/eigenspectrum_smarin_n16384_l4096_pmean_confusion_matrix.png
Confusion matrix PDF saved to: eigenspectrum_results_v29/eigenspectrum_smarin_n16384_l4096_pmean_confusion_matrix.pdf
Confusion matrix data exported to: eigenspectrum_results_v29/eigenspectrum_smarin_n16384_l4096_pmean_confusion_matrix.csv
Classification metrics exported to: eigenspectrum_results_v29/eigenspectrum_smarin_n16384_l4096_pmean_confusion_matrix_metrics.csv

Run completed: 2025-12-29T04:38:34.431592

Done!
