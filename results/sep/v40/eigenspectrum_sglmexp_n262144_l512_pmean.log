Run started: 2025-12-30T14:47:06.471683
Arguments: Namespace(source='glmexp', n_samples=[16384, 65536, 262144], seq_len=512, pooling_method='mean', model_path=None, model_subfolder='', model_revision=None, seed=42, batch_size=1024, device='cuda', dtype=torch.bfloat16, output_dir='results/sep/v40', force=False, species_filter=None, species_filter_file=None, species_column='organism', split='train', dataset_path='eczech/gpn-animal-promoter-dataset', dataset_config=None, dataset_revision='f009db443a914d4113922e3028de0666b85c24d6', text_column='seq', tokenization_mode='strict', dataset_sample_size=None, dataset_shuffle=False, dataset_dir=None)

============================================================
Eigenspectrum Analysis of DNA Sequences
============================================================
Parameters:
  - Source: glmexp
  - Sample sizes: [16384, 65536, 262144]
  - Sequence length: 512 bp
  - Feature dimension: model hidden size
  - Pooling method: mean

Loading dataset from HuggingFace (path=eczech/gpn-animal-promoter-dataset, revision=f009db443a914d4113922e3028de0666b85c24d6, split=train)...
Dataset size: 9,038,354 records

Preparing sequences (cropping to 512 bp and filtering empty)...
  Records before filtering: 9,038,354
  Records after filtering: 9,038,354
  Empty sequences filtered: 0
Sampling 262144 records...
Extracting records...
  Unique species: 417
Loading GLM-Experiments Lightning checkpoint from gonzalobenegas/dev-glm-experiments-logs...
  Downloading checkpoint from HuggingFace...
  Downloading config from HuggingFace...
  Loading config...
  Replacing scheduler/optimizer with dummies for inference...
  Instantiating model from config...
  Loading checkpoint weights...
/work/10459/eczech/vista/repos/plantcad-spectral-analysis/scripts/plantcad_eigenanalysis.py:534: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(checkpoint_path, map_location="cpu")
  Hidden size: 1024
  Parameters: 298,908,672 (298.9M)
  Device: cuda, Dtype: torch.bfloat16
  Loading tokenizer from gonzalobenegas/tokenizer-dna-mlm...
  Tokenizer vocab size: 7
Extracting embeddings:   0%|          | 0/256 [00:00<?, ?it/s]Extracting embeddings:   0%|          | 1/256 [00:04<17:22,  4.09s/it]Extracting embeddings:   1%|          | 2/256 [00:05<10:44,  2.54s/it]Extracting embeddings:   1%|1         | 3/256 [00:06<08:36,  2.04s/it]Extracting embeddings:   2%|1         | 4/256 [00:08<07:35,  1.81s/it]Extracting embeddings:   2%|1         | 5/256 [00:09<07:01,  1.68s/it]Extracting embeddings:   2%|2         | 6/256 [00:11<06:40,  1.60s/it]Extracting embeddings:   3%|2         | 7/256 [00:12<06:26,  1.55s/it]Extracting embeddings:   3%|3         | 8/256 [00:14<06:16,  1.52s/it]Extracting embeddings:   4%|3         | 9/256 [00:15<06:09,  1.50s/it]Extracting embeddings:   4%|3         | 10/256 [00:17<06:04,  1.48s/it]Extracting embeddings:   4%|4         | 11/256 [00:18<06:01,  1.47s/it]Extracting embeddings:   5%|4         | 12/256 [00:20<05:57,  1.47s/it]Extracting embeddings:   5%|5         | 13/256 [00:21<05:55,  1.46s/it]Extracting embeddings:   5%|5         | 14/256 [00:22<05:53,  1.46s/it]Extracting embeddings:   6%|5         | 15/256 [00:24<05:51,  1.46s/it]Extracting embeddings:   6%|6         | 16/256 [00:25<05:49,  1.46s/it]Extracting embeddings:   7%|6         | 17/256 [00:27<05:47,  1.45s/it]Extracting embeddings:   7%|7         | 18/256 [00:28<05:55,  1.49s/it]Extracting embeddings:   7%|7         | 19/256 [00:30<05:51,  1.48s/it]Extracting embeddings:   8%|7         | 20/256 [00:31<05:47,  1.47s/it]Extracting embeddings:   8%|8         | 21/256 [00:33<05:44,  1.47s/it]Extracting embeddings:   9%|8         | 22/256 [00:34<05:42,  1.46s/it]Extracting embeddings:   9%|8         | 23/256 [00:36<05:39,  1.46s/it]Extracting embeddings:   9%|9         | 24/256 [00:37<05:38,  1.46s/it]Extracting embeddings:  10%|9         | 25/256 [00:39<05:36,  1.46s/it]Extracting embeddings:  10%|#         | 26/256 [00:40<05:34,  1.46s/it]Extracting embeddings:  11%|#         | 27/256 [00:41<05:33,  1.46s/it]Extracting embeddings:  11%|#         | 28/256 [00:43<05:31,  1.46s/it]Extracting embeddings:  11%|#1        | 29/256 [00:44<05:30,  1.46s/it]Extracting embeddings:  12%|#1        | 30/256 [00:46<05:28,  1.46s/it]Extracting embeddings:  12%|#2        | 31/256 [00:47<05:27,  1.45s/it]Extracting embeddings:  12%|#2        | 32/256 [00:49<05:25,  1.45s/it]Extracting embeddings:  13%|#2        | 33/256 [00:50<05:24,  1.45s/it]Extracting embeddings:  13%|#3        | 34/256 [00:52<05:22,  1.45s/it]Extracting embeddings:  14%|#3        | 35/256 [00:53<05:21,  1.45s/it]Extracting embeddings:  14%|#4        | 36/256 [00:55<05:20,  1.46s/it]Extracting embeddings:  14%|#4        | 37/256 [00:56<05:18,  1.46s/it]Extracting embeddings:  15%|#4        | 38/256 [00:57<05:17,  1.46s/it]Extracting embeddings:  15%|#5        | 39/256 [00:59<05:15,  1.46s/it]Extracting embeddings:  16%|#5        | 40/256 [01:00<05:14,  1.46s/it]Extracting embeddings:  16%|#6        | 41/256 [01:02<05:21,  1.50s/it]Extracting embeddings:  16%|#6        | 42/256 [01:03<05:17,  1.48s/it]Extracting embeddings:  17%|#6        | 43/256 [01:05<05:14,  1.48s/it]Extracting embeddings:  17%|#7        | 44/256 [01:06<05:11,  1.47s/it]Extracting embeddings:  18%|#7        | 45/256 [01:08<05:09,  1.47s/it]Extracting embeddings:  18%|#7        | 46/256 [01:09<05:07,  1.46s/it]Extracting embeddings:  18%|#8        | 47/256 [01:11<05:05,  1.46s/it]Extracting embeddings:  19%|#8        | 48/256 [01:12<05:03,  1.46s/it]Extracting embeddings:  19%|#9        | 49/256 [01:14<05:01,  1.46s/it]Extracting embeddings:  20%|#9        | 50/256 [01:15<05:00,  1.46s/it]Extracting embeddings:  20%|#9        | 51/256 [01:17<04:58,  1.46s/it]Extracting embeddings:  20%|##        | 52/256 [01:18<04:57,  1.46s/it]Extracting embeddings:  21%|##        | 53/256 [01:19<04:55,  1.46s/it]Extracting embeddings:  21%|##1       | 54/256 [01:21<04:54,  1.46s/it]Extracting embeddings:  21%|##1       | 55/256 [01:22<04:52,  1.46s/it]Extracting embeddings:  22%|##1       | 56/256 [01:24<04:51,  1.46s/it]Extracting embeddings:  22%|##2       | 57/256 [01:25<04:49,  1.46s/it]Extracting embeddings:  23%|##2       | 58/256 [01:27<04:48,  1.46s/it]Extracting embeddings:  23%|##3       | 59/256 [01:28<04:46,  1.46s/it]Extracting embeddings:  23%|##3       | 60/256 [01:30<04:45,  1.46s/it]Extracting embeddings:  24%|##3       | 61/256 [01:31<04:44,  1.46s/it]Extracting embeddings:  24%|##4       | 62/256 [01:33<04:42,  1.46s/it]Extracting embeddings:  25%|##4       | 63/256 [01:34<04:41,  1.46s/it]Extracting embeddings:  25%|##5       | 64/256 [01:36<04:47,  1.50s/it]Extracting embeddings:  25%|##5       | 65/256 [01:37<04:43,  1.49s/it]Extracting embeddings:  26%|##5       | 66/256 [01:39<04:40,  1.48s/it]Extracting embeddings:  26%|##6       | 67/256 [01:40<04:37,  1.47s/it]Extracting embeddings:  27%|##6       | 68/256 [01:41<04:35,  1.47s/it]Extracting embeddings:  27%|##6       | 69/256 [01:43<04:33,  1.46s/it]Extracting embeddings:  27%|##7       | 70/256 [01:44<04:31,  1.46s/it]Extracting embeddings:  28%|##7       | 71/256 [01:46<04:30,  1.46s/it]Extracting embeddings:  28%|##8       | 72/256 [01:47<04:28,  1.46s/it]Extracting embeddings:  29%|##8       | 73/256 [01:49<04:26,  1.46s/it]Extracting embeddings:  29%|##8       | 74/256 [01:50<04:25,  1.46s/it]Extracting embeddings:  29%|##9       | 75/256 [01:52<04:23,  1.46s/it]Extracting embeddings:  30%|##9       | 76/256 [01:53<04:22,  1.46s/it]Extracting embeddings:  30%|###       | 77/256 [01:55<04:20,  1.46s/it]Extracting embeddings:  30%|###       | 78/256 [01:56<04:19,  1.46s/it]Extracting embeddings:  31%|###       | 79/256 [01:57<04:17,  1.46s/it]Extracting embeddings:  31%|###1      | 80/256 [01:59<04:16,  1.46s/it]Extracting embeddings:  32%|###1      | 81/256 [02:00<04:14,  1.46s/it]Extracting embeddings:  32%|###2      | 82/256 [02:02<04:13,  1.46s/it]Extracting embeddings:  32%|###2      | 83/256 [02:03<04:11,  1.46s/it]Extracting embeddings:  33%|###2      | 84/256 [02:05<04:10,  1.46s/it]Extracting embeddings:  33%|###3      | 85/256 [02:06<04:08,  1.46s/it]Extracting embeddings:  34%|###3      | 86/256 [02:08<04:07,  1.46s/it]Extracting embeddings:  34%|###3      | 87/256 [02:09<04:12,  1.50s/it]Extracting embeddings:  34%|###4      | 88/256 [02:11<04:09,  1.49s/it]Extracting embeddings:  35%|###4      | 89/256 [02:12<04:06,  1.48s/it]Extracting embeddings:  35%|###5      | 90/256 [02:14<04:04,  1.47s/it]Extracting embeddings:  36%|###5      | 91/256 [02:15<04:01,  1.47s/it]Extracting embeddings:  36%|###5      | 92/256 [02:17<03:59,  1.46s/it]Extracting embeddings:  36%|###6      | 93/256 [02:18<03:58,  1.46s/it]Extracting embeddings:  37%|###6      | 94/256 [02:19<03:56,  1.46s/it]Extracting embeddings:  37%|###7      | 95/256 [02:21<03:54,  1.46s/it]Extracting embeddings:  38%|###7      | 96/256 [02:22<03:53,  1.46s/it]Extracting embeddings:  38%|###7      | 97/256 [02:24<03:51,  1.46s/it]Extracting embeddings:  38%|###8      | 98/256 [02:25<03:50,  1.46s/it]Extracting embeddings:  39%|###8      | 99/256 [02:27<03:48,  1.46s/it]Extracting embeddings:  39%|###9      | 100/256 [02:28<03:47,  1.46s/it]Extracting embeddings:  39%|###9      | 101/256 [02:30<03:45,  1.46s/it]Extracting embeddings:  40%|###9      | 102/256 [02:31<03:44,  1.46s/it]Extracting embeddings:  40%|####      | 103/256 [02:33<03:42,  1.46s/it]Extracting embeddings:  41%|####      | 104/256 [02:34<03:41,  1.46s/it]Extracting embeddings:  41%|####1     | 105/256 [02:35<03:39,  1.46s/it]Extracting embeddings:  41%|####1     | 106/256 [02:37<03:38,  1.46s/it]Extracting embeddings:  42%|####1     | 107/256 [02:38<03:36,  1.46s/it]Extracting embeddings:  42%|####2     | 108/256 [02:40<03:35,  1.46s/it]Extracting embeddings:  43%|####2     | 109/256 [02:41<03:33,  1.46s/it]Extracting embeddings:  43%|####2     | 110/256 [02:43<03:32,  1.46s/it]Extracting embeddings:  43%|####3     | 111/256 [02:44<03:31,  1.46s/it]Extracting embeddings:  44%|####3     | 112/256 [02:46<03:35,  1.50s/it]Extracting embeddings:  44%|####4     | 113/256 [02:47<03:32,  1.48s/it]Extracting embeddings:  45%|####4     | 114/256 [02:49<03:29,  1.48s/it]Extracting embeddings:  45%|####4     | 115/256 [02:50<03:27,  1.47s/it]Extracting embeddings:  45%|####5     | 116/256 [02:52<03:25,  1.47s/it]Extracting embeddings:  46%|####5     | 117/256 [02:53<03:23,  1.46s/it]Extracting embeddings:  46%|####6     | 118/256 [02:55<03:21,  1.46s/it]Extracting embeddings:  46%|####6     | 119/256 [02:56<03:19,  1.46s/it]Extracting embeddings:  47%|####6     | 120/256 [02:57<03:18,  1.46s/it]Extracting embeddings:  47%|####7     | 121/256 [02:59<03:16,  1.46s/it]Extracting embeddings:  48%|####7     | 122/256 [03:00<03:15,  1.46s/it]Extracting embeddings:  48%|####8     | 123/256 [03:02<03:13,  1.46s/it]Extracting embeddings:  48%|####8     | 124/256 [03:03<03:12,  1.46s/it]Extracting embeddings:  49%|####8     | 125/256 [03:05<03:10,  1.46s/it]Extracting embeddings:  49%|####9     | 126/256 [03:06<03:09,  1.46s/it]Extracting embeddings:  50%|####9     | 127/256 [03:08<03:07,  1.46s/it]Extracting embeddings:  50%|#####     | 128/256 [03:09<03:06,  1.46s/it]Extracting embeddings:  50%|#####     | 129/256 [03:11<03:05,  1.46s/it]Extracting embeddings:  51%|#####     | 130/256 [03:12<03:03,  1.46s/it]Extracting embeddings:  51%|#####1    | 131/256 [03:13<03:02,  1.46s/it]Extracting embeddings:  52%|#####1    | 132/256 [03:15<03:00,  1.46s/it]Extracting embeddings:  52%|#####1    | 133/256 [03:16<02:59,  1.46s/it]Extracting embeddings:  52%|#####2    | 134/256 [03:18<02:57,  1.46s/it]Extracting embeddings:  53%|#####2    | 135/256 [03:19<03:01,  1.50s/it]Extracting embeddings:  53%|#####3    | 136/256 [03:21<02:58,  1.49s/it]Extracting embeddings:  54%|#####3    | 137/256 [03:22<02:55,  1.48s/it]Extracting embeddings:  54%|#####3    | 138/256 [03:24<02:53,  1.47s/it]Extracting embeddings:  54%|#####4    | 139/256 [03:25<02:51,  1.47s/it]Extracting embeddings:  55%|#####4    | 140/256 [03:27<02:49,  1.47s/it]Extracting embeddings:  55%|#####5    | 141/256 [03:28<02:48,  1.46s/it]Extracting embeddings:  55%|#####5    | 142/256 [03:30<02:46,  1.46s/it]Extracting embeddings:  56%|#####5    | 143/256 [03:31<02:44,  1.46s/it]Extracting embeddings:  56%|#####6    | 144/256 [03:33<02:43,  1.46s/it]Extracting embeddings:  57%|#####6    | 145/256 [03:34<02:41,  1.46s/it]Extracting embeddings:  57%|#####7    | 146/256 [03:35<02:40,  1.46s/it]Extracting embeddings:  57%|#####7    | 147/256 [03:37<02:38,  1.46s/it]Extracting embeddings:  58%|#####7    | 148/256 [03:38<02:37,  1.46s/it]Extracting embeddings:  58%|#####8    | 149/256 [03:40<02:36,  1.46s/it]Extracting embeddings:  59%|#####8    | 150/256 [03:41<02:34,  1.46s/it]Extracting embeddings:  59%|#####8    | 151/256 [03:43<02:33,  1.46s/it]Extracting embeddings:  59%|#####9    | 152/256 [03:44<02:31,  1.46s/it]Extracting embeddings:  60%|#####9    | 153/256 [03:46<02:30,  1.46s/it]Extracting embeddings:  60%|######    | 154/256 [03:47<02:28,  1.46s/it]Extracting embeddings:  61%|######    | 155/256 [03:49<02:27,  1.46s/it]Extracting embeddings:  61%|######    | 156/256 [03:50<02:29,  1.50s/it]Extracting embeddings:  61%|######1   | 157/256 [03:52<02:27,  1.49s/it]Extracting embeddings:  62%|######1   | 158/256 [03:53<02:24,  1.48s/it]Extracting embeddings:  62%|######2   | 159/256 [03:55<02:22,  1.47s/it]Extracting embeddings:  62%|######2   | 160/256 [03:56<02:20,  1.47s/it]Extracting embeddings:  63%|######2   | 161/256 [03:57<02:19,  1.46s/it]Extracting embeddings:  63%|######3   | 162/256 [03:59<02:17,  1.46s/it]Extracting embeddings:  64%|######3   | 163/256 [04:00<02:15,  1.46s/it]Extracting embeddings:  64%|######4   | 164/256 [04:02<02:14,  1.46s/it]Extracting embeddings:  64%|######4   | 165/256 [04:03<02:12,  1.46s/it]Extracting embeddings:  65%|######4   | 166/256 [04:05<02:11,  1.46s/it]Extracting embeddings:  65%|######5   | 167/256 [04:06<02:09,  1.46s/it]Extracting embeddings:  66%|######5   | 168/256 [04:08<02:08,  1.46s/it]Extracting embeddings:  66%|######6   | 169/256 [04:09<02:06,  1.46s/it]Extracting embeddings:  66%|######6   | 170/256 [04:11<02:05,  1.45s/it]Extracting embeddings:  67%|######6   | 171/256 [04:12<02:03,  1.46s/it]Extracting embeddings:  67%|######7   | 172/256 [04:13<02:02,  1.46s/it]Extracting embeddings:  68%|######7   | 173/256 [04:15<02:00,  1.46s/it]Extracting embeddings:  68%|######7   | 174/256 [04:16<01:59,  1.46s/it]Extracting embeddings:  68%|######8   | 175/256 [04:18<01:57,  1.45s/it]Extracting embeddings:  69%|######8   | 176/256 [04:19<01:56,  1.45s/it]Extracting embeddings:  69%|######9   | 177/256 [04:21<01:54,  1.45s/it]Extracting embeddings:  70%|######9   | 178/256 [04:22<01:56,  1.50s/it]Extracting embeddings:  70%|######9   | 179/256 [04:24<01:54,  1.48s/it]Extracting embeddings:  70%|#######   | 180/256 [04:25<01:52,  1.47s/it]Extracting embeddings:  71%|#######   | 181/256 [04:27<01:50,  1.47s/it]Extracting embeddings:  71%|#######1  | 182/256 [04:28<01:48,  1.46s/it]Extracting embeddings:  71%|#######1  | 183/256 [04:30<01:46,  1.46s/it]Extracting embeddings:  72%|#######1  | 184/256 [04:31<01:45,  1.46s/it]Extracting embeddings:  72%|#######2  | 185/256 [04:33<01:43,  1.46s/it]Extracting embeddings:  73%|#######2  | 186/256 [04:34<01:42,  1.46s/it]Extracting embeddings:  73%|#######3  | 187/256 [04:35<01:40,  1.46s/it]Extracting embeddings:  73%|#######3  | 188/256 [04:37<01:39,  1.46s/it]Extracting embeddings:  74%|#######3  | 189/256 [04:38<01:37,  1.46s/it]Extracting embeddings:  74%|#######4  | 190/256 [04:40<01:36,  1.46s/it]Extracting embeddings:  75%|#######4  | 191/256 [04:41<01:34,  1.46s/it]Extracting embeddings:  75%|#######5  | 192/256 [04:43<01:33,  1.46s/it]Extracting embeddings:  75%|#######5  | 193/256 [04:44<01:31,  1.46s/it]Extracting embeddings:  76%|#######5  | 194/256 [04:46<01:30,  1.46s/it]Extracting embeddings:  76%|#######6  | 195/256 [04:47<01:28,  1.46s/it]Extracting embeddings:  77%|#######6  | 196/256 [04:49<01:27,  1.46s/it]Extracting embeddings:  77%|#######6  | 197/256 [04:50<01:25,  1.46s/it]Extracting embeddings:  77%|#######7  | 198/256 [04:51<01:24,  1.46s/it]Extracting embeddings:  78%|#######7  | 199/256 [04:53<01:22,  1.46s/it]Extracting embeddings:  78%|#######8  | 200/256 [04:54<01:21,  1.46s/it]Extracting embeddings:  79%|#######8  | 201/256 [04:56<01:22,  1.50s/it]Extracting embeddings:  79%|#######8  | 202/256 [04:57<01:20,  1.49s/it]Extracting embeddings:  79%|#######9  | 203/256 [04:59<01:18,  1.48s/it]Extracting embeddings:  80%|#######9  | 204/256 [05:00<01:16,  1.47s/it]Extracting embeddings:  80%|########  | 205/256 [05:02<01:14,  1.47s/it]Extracting embeddings:  80%|########  | 206/256 [05:03<01:13,  1.46s/it]Extracting embeddings:  81%|########  | 207/256 [05:05<01:11,  1.46s/it]Extracting embeddings:  81%|########1 | 208/256 [05:06<01:10,  1.46s/it]Extracting embeddings:  82%|########1 | 209/256 [05:08<01:08,  1.46s/it]Extracting embeddings:  82%|########2 | 210/256 [05:09<01:07,  1.46s/it]Extracting embeddings:  82%|########2 | 211/256 [05:11<01:05,  1.46s/it]Extracting embeddings:  83%|########2 | 212/256 [05:12<01:04,  1.46s/it]Extracting embeddings:  83%|########3 | 213/256 [05:13<01:02,  1.46s/it]Extracting embeddings:  84%|########3 | 214/256 [05:15<01:01,  1.46s/it]Extracting embeddings:  84%|########3 | 215/256 [05:16<00:59,  1.46s/it]Extracting embeddings:  84%|########4 | 216/256 [05:18<00:58,  1.46s/it]Extracting embeddings:  85%|########4 | 217/256 [05:19<00:56,  1.46s/it]Extracting embeddings:  85%|########5 | 218/256 [05:21<00:55,  1.46s/it]Extracting embeddings:  86%|########5 | 219/256 [05:22<00:53,  1.46s/it]Extracting embeddings:  86%|########5 | 220/256 [05:24<00:52,  1.46s/it]Extracting embeddings:  86%|########6 | 221/256 [05:25<00:50,  1.46s/it]Extracting embeddings:  87%|########6 | 222/256 [05:27<00:49,  1.46s/it]Extracting embeddings:  87%|########7 | 223/256 [05:28<00:48,  1.46s/it]Extracting embeddings:  88%|########7 | 224/256 [05:30<00:47,  1.50s/it]Extracting embeddings:  88%|########7 | 225/256 [05:31<00:46,  1.49s/it]Extracting embeddings:  88%|########8 | 226/256 [05:33<00:44,  1.48s/it]Extracting embeddings:  89%|########8 | 227/256 [05:34<00:42,  1.47s/it]Extracting embeddings:  89%|########9 | 228/256 [05:35<00:41,  1.47s/it]Extracting embeddings:  89%|########9 | 229/256 [05:37<00:39,  1.46s/it]Extracting embeddings:  90%|########9 | 230/256 [05:38<00:37,  1.46s/it]Extracting embeddings:  90%|######### | 231/256 [05:40<00:36,  1.46s/it]Extracting embeddings:  91%|######### | 232/256 [05:41<00:34,  1.46s/it]Extracting embeddings:  91%|#########1| 233/256 [05:43<00:33,  1.46s/it]Extracting embeddings:  91%|#########1| 234/256 [05:44<00:32,  1.46s/it]Extracting embeddings:  92%|#########1| 235/256 [05:46<00:30,  1.46s/it]Extracting embeddings:  92%|#########2| 236/256 [05:47<00:29,  1.46s/it]Extracting embeddings:  93%|#########2| 237/256 [05:49<00:27,  1.46s/it]Extracting embeddings:  93%|#########2| 238/256 [05:50<00:26,  1.46s/it]Extracting embeddings:  93%|#########3| 239/256 [05:51<00:24,  1.46s/it]Extracting embeddings:  94%|#########3| 240/256 [05:53<00:23,  1.46s/it]Extracting embeddings:  94%|#########4| 241/256 [05:54<00:21,  1.46s/it]Extracting embeddings:  95%|#########4| 242/256 [05:56<00:20,  1.46s/it]Extracting embeddings:  95%|#########4| 243/256 [05:57<00:18,  1.46s/it]Extracting embeddings:  95%|#########5| 244/256 [05:59<00:17,  1.46s/it]Extracting embeddings:  96%|#########5| 245/256 [06:00<00:16,  1.46s/it]Extracting embeddings:  96%|#########6| 246/256 [06:02<00:14,  1.46s/it]Extracting embeddings:  96%|#########6| 247/256 [06:03<00:13,  1.50s/it]Extracting embeddings:  97%|#########6| 248/256 [06:05<00:11,  1.49s/it]Extracting embeddings:  97%|#########7| 249/256 [06:06<00:10,  1.48s/it]Extracting embeddings:  98%|#########7| 250/256 [06:08<00:08,  1.47s/it]Extracting embeddings:  98%|#########8| 251/256 [06:09<00:07,  1.47s/it]Extracting embeddings:  98%|#########8| 252/256 [06:11<00:05,  1.46s/it]Extracting embeddings:  99%|#########8| 253/256 [06:12<00:04,  1.46s/it]Extracting embeddings:  99%|#########9| 254/256 [06:13<00:02,  1.46s/it]Extracting embeddings: 100%|#########9| 255/256 [06:15<00:01,  1.46s/it]Extracting embeddings: 100%|##########| 256/256 [06:16<00:00,  1.46s/it]Extracting embeddings: 100%|##########| 256/256 [06:16<00:00,  1.47s/it]
  Embedding matrix shape: (262144, 1024)

Computing PCA for n_samples=16384...
  Computed 1024 eigenvalues
  Top 10 eigenvalues: [0.54366714 0.0507568  0.04546674 0.03485246 0.02854545 0.02276642
 0.01770478 0.01430446 0.0130925  0.00945888]
  Variance explained by top 10: 78.27%

Computing PCA for n_samples=65536...
  Computed 1024 eigenvalues
  Top 10 eigenvalues: [0.54567546 0.0522627  0.04612705 0.03551131 0.02882829 0.02232266
 0.01810791 0.01446347 0.01310725 0.00964457]
  Variance explained by top 10: 78.29%

Computing PCA for n_samples=262144...
  Computed 1024 eigenvalues
  Top 10 eigenvalues: [0.5449407  0.05081695 0.04676056 0.0360752  0.02856448 0.02239364
 0.01805821 0.01420695 0.0131293  0.00971982]
  Variance explained by top 10: 78.23%

Fitting full PCA for classification (n=262144)...

Saving checkpoint to: results/sep/v40/eigenspectrum_sglmexp_l512_n16384_65536_262144_pmean.pkl

For n=262144:
  Components needed for 90% variance: 42
  Components needed for 95% variance: 97
  Effective sample size: 3.29036355
  Condition number: 9.20192180e+14

Figure saved to: results/sep/v40/eigenspectrum_sglmexp_n262144_l512_pmean.png
PDF saved to: results/sep/v40/eigenspectrum_sglmexp_n262144_l512_pmean.pdf
Eigenvalue data exported to: results/sep/v40/eigenspectrum_sglmexp_n262144_l512_pmean.csv

======================================================================
PC SCALING ANALYSIS
Testing n_components: [0, 1, 2, 3, 4, 8, 16, 32, 64, 128, 256, 512, 1024]
======================================================================
Extracting sequence features:   0%|          | 0/262144 [00:00<?, ?it/s]Extracting sequence features:   2%|1         | 4194/262144 [00:00<00:06, 41930.24it/s]Extracting sequence features:   3%|3         | 8388/262144 [00:00<00:06, 39973.01it/s]Extracting sequence features:   5%|4         | 12392/262144 [00:00<00:06, 39521.45it/s]Extracting sequence features:   6%|6         | 16347/262144 [00:00<00:06, 39337.86it/s]Extracting sequence features:   8%|7         | 20283/262144 [00:00<00:06, 39208.05it/s]Extracting sequence features:   9%|9         | 24205/262144 [00:00<00:06, 39209.97it/s]Extracting sequence features:  11%|#         | 28127/262144 [00:00<00:05, 39055.11it/s]Extracting sequence features:  12%|#2        | 32081/262144 [00:00<00:05, 39190.33it/s]Extracting sequence features:  14%|#3        | 36013/262144 [00:00<00:05, 39221.20it/s]Extracting sequence features:  15%|#5        | 39944/262144 [00:01<00:05, 39243.83it/s]Extracting sequence features:  17%|#6        | 43869/262144 [00:01<00:05, 39146.69it/s]Extracting sequence features:  18%|#8        | 47812/262144 [00:01<00:05, 39230.43it/s]Extracting sequence features:  20%|#9        | 51742/262144 [00:01<00:05, 39249.17it/s]Extracting sequence features:  21%|##1       | 55668/262144 [00:01<00:05, 39219.38it/s]Extracting sequence features:  23%|##2       | 59591/262144 [00:01<00:05, 39151.27it/s]Extracting sequence features:  24%|##4       | 63509/262144 [00:01<00:05, 39147.58it/s]Extracting sequence features:  26%|##5       | 67424/262144 [00:01<00:04, 39111.24it/s]Extracting sequence features:  27%|##7       | 71336/262144 [00:01<00:04, 39095.26it/s]Extracting sequence features:  29%|##8       | 75251/262144 [00:01<00:04, 39110.48it/s]Extracting sequence features:  30%|###       | 79178/262144 [00:02<00:04, 39156.98it/s]Extracting sequence features:  32%|###1      | 83094/262144 [00:02<00:04, 39138.76it/s]Extracting sequence features:  33%|###3      | 87008/262144 [00:02<00:04, 39065.87it/s]Extracting sequence features:  35%|###4      | 90926/262144 [00:02<00:04, 39092.47it/s]Extracting sequence features:  36%|###6      | 94850/262144 [00:02<00:04, 39082.19it/s]Extracting sequence features:  38%|###7      | 98775/262144 [00:02<00:04, 39126.44it/s]Extracting sequence features:  39%|###9      | 102698/262144 [00:02<00:04, 39134.25it/s]Extracting sequence features:  41%|####      | 106618/262144 [00:02<00:03, 39109.18it/s]Extracting sequence features:  42%|####2     | 110544/262144 [00:02<00:03, 39129.21it/s]Extracting sequence features:  44%|####3     | 114468/262144 [00:02<00:03, 39146.41it/s]Extracting sequence features:  45%|####5     | 118395/262144 [00:03<00:03, 39135.76it/s]Extracting sequence features:  47%|####6     | 122315/262144 [00:03<00:03, 39082.77it/s]Extracting sequence features:  48%|####8     | 126242/262144 [00:03<00:03, 39093.71it/s]Extracting sequence features:  50%|####9     | 130166/262144 [00:03<00:03, 39073.85it/s]Extracting sequence features:  51%|#####1    | 134096/262144 [00:03<00:03, 39139.53it/s]Extracting sequence features:  53%|#####2    | 138011/262144 [00:03<00:03, 39094.01it/s]Extracting sequence features:  54%|#####4    | 141937/262144 [00:03<00:03, 39123.60it/s]Extracting sequence features:  56%|#####5    | 145861/262144 [00:03<00:02, 39127.77it/s]Extracting sequence features:  57%|#####7    | 149793/262144 [00:03<00:02, 39184.36it/s]Extracting sequence features:  59%|#####8    | 153718/262144 [00:03<00:02, 39196.05it/s]Extracting sequence features:  60%|######    | 157643/262144 [00:04<00:02, 39209.68it/s]Extracting sequence features:  62%|######1   | 161564/262144 [00:04<00:02, 39178.12it/s]Extracting sequence features:  63%|######3   | 165511/262144 [00:04<00:02, 39256.68it/s]Extracting sequence features:  65%|######4   | 169454/262144 [00:04<00:02, 39307.60it/s]Extracting sequence features:  66%|######6   | 173385/262144 [00:04<00:02, 39298.19it/s]Extracting sequence features:  68%|######7   | 177315/262144 [00:04<00:02, 39205.96it/s]Extracting sequence features:  69%|######9   | 181236/262144 [00:04<00:02, 39178.74it/s]Extracting sequence features:  71%|#######   | 185160/262144 [00:04<00:01, 39192.59it/s]Extracting sequence features:  72%|#######2  | 189094/262144 [00:04<00:01, 39220.48it/s]Extracting sequence features:  74%|#######3  | 193032/262144 [00:04<00:01, 39267.42it/s]Extracting sequence features:  75%|#######5  | 196959/262144 [00:05<00:01, 39241.95it/s]Extracting sequence features:  77%|#######6  | 200884/262144 [00:05<00:01, 39234.15it/s]Extracting sequence features:  78%|#######8  | 204808/262144 [00:05<00:01, 39185.99it/s]Extracting sequence features:  80%|#######9  | 208727/262144 [00:05<00:01, 39166.59it/s]Extracting sequence features:  81%|########1 | 212644/262144 [00:05<00:01, 39141.73it/s]Extracting sequence features:  83%|########2 | 216559/262144 [00:05<00:01, 39137.76it/s]Extracting sequence features:  84%|########4 | 220491/262144 [00:05<00:01, 39174.16it/s]Extracting sequence features:  86%|########5 | 224424/262144 [00:05<00:00, 39210.40it/s]Extracting sequence features:  87%|########7 | 228359/262144 [00:05<00:00, 39246.39it/s]Extracting sequence features:  89%|########8 | 232284/262144 [00:05<00:00, 39179.55it/s]Extracting sequence features:  90%|######### | 236202/262144 [00:06<00:00, 39125.67it/s]Extracting sequence features:  92%|#########1| 240129/262144 [00:06<00:00, 39167.60it/s]Extracting sequence features:  93%|#########3| 244057/262144 [00:06<00:00, 39194.92it/s]Extracting sequence features:  95%|#########4| 247977/262144 [00:06<00:00, 39157.46it/s]Extracting sequence features:  96%|#########6| 251914/262144 [00:06<00:00, 39219.87it/s]Extracting sequence features:  98%|#########7| 255837/262144 [00:06<00:00, 39210.76it/s]Extracting sequence features:  99%|#########9| 259759/262144 [00:06<00:00, 39081.06it/s]Extracting sequence features: 100%|##########| 262144/262144 [00:06<00:00, 39195.18it/s]
[species[0]] Filtered: 408/417 classes, 262135/262144 samples
  Classes: Acanthaster planci, Acanthisitta chloris, Acanthopagrus latus, Acipenser ruthenus, Acropora millepora, Actinia tenebrosa, Adelges cooleyi, Aethina tumida, Agrilus planipennis, Alligator mississippiensis, ... (+398 more)
  species              F1: 0.00 0.00 0.00 0.00 0.00 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01
[gc_content[0]] 5 classes, 262144 samples
  Classes: 0.094-0.365, 0.365-0.416, 0.416-0.475, 0.475-0.586, 0.586-1.000
  gc_content           F1: 0.19 0.79 0.79 0.80 0.81 0.82 0.86 0.87 0.89 0.89 0.89 0.89 0.89
[repeat_fraction[0]] 5 classes, 262144 samples
  Classes: 0.000-0.055, 0.055-0.123, 0.123-0.193, 0.193-0.311, 0.311-1.000
  repeat_fraction      F1: 0.20 0.28 0.31 0.34 0.36 0.37 0.42 0.43 0.44 0.45 0.45 0.45 0.44
[kmer_entropy_1[0]] 5 classes, 262144 samples
  Classes: 0.000-1.896, 1.896-1.944, 1.944-1.968, 1.968-1.985, 1.985-2.000
  kmer_entropy_1       F1: 0.20 0.60 0.62 0.65 0.66 0.70 0.73 0.74 0.75 0.75 0.75 0.75 0.75
[kmer_entropy_3[0]] 5 classes, 262144 samples
  Classes: 0.000-5.507, 5.507-5.650, 5.650-5.727, 5.727-5.794, 5.794-5.949
  kmer_entropy_3       F1: 0.20 0.47 0.52 0.55 0.56 0.61 0.66 0.67 0.68 0.69 0.69 0.68 0.68
[kmer_entropy_9[0]] 5 classes, 262144 samples
  Classes: 0.000-8.920, 8.920-8.957, 8.957-8.969, 8.969-8.973, 8.973-8.977
  kmer_entropy_9       F1: 0.10 0.24 0.31 0.35 0.37 0.40 0.42 0.42 0.42 0.42 0.42 0.42 0.42
[dinuc_CG[0]] 5 classes, 262144 samples
  Classes: 0.000-0.014, 0.014-0.027, 0.027-0.041, 0.041-0.067, 0.067-0.384
  dinuc_CG             F1: 0.15 0.41 0.45 0.50 0.55 0.69 0.71 0.72 0.74 0.75 0.75 0.75 0.75
[dinuc_GC[0]] 5 classes, 262144 samples
  Classes: 0.000-0.033, 0.033-0.045, 0.045-0.059, 0.059-0.086, 0.086-0.382
  dinuc_GC             F1: 0.18 0.60 0.61 0.62 0.62 0.63 0.64 0.67 0.71 0.71 0.72 0.72 0.72
[dinuc_AT[0]] 5 classes, 262144 samples
  Classes: 0.000-0.031, 0.031-0.055, 0.055-0.072, 0.072-0.092, 0.092-0.376
  dinuc_AT             F1: 0.17 0.66 0.66 0.66 0.67 0.68 0.69 0.72 0.75 0.75 0.75 0.76 0.75
[dinuc_TA[0]] 5 classes, 262144 samples
  Classes: 0.000-0.023, 0.023-0.045, 0.045-0.063, 0.063-0.082, 0.082-0.376
  dinuc_TA             F1: 0.18 0.63 0.63 0.64 0.64 0.67 0.71 0.75 0.76 0.76 0.76 0.77 0.76
[dinuc_AA[0]] 5 classes, 262144 samples
  Classes: 0.000-0.045, 0.045-0.072, 0.072-0.094, 0.094-0.117, 0.117-0.456
  dinuc_AA             F1: 0.17 0.51 0.53 0.53 0.53 0.61 0.65 0.67 0.69 0.70 0.70 0.70 0.70
[dinuc_TT[0]] 5 classes, 262144 samples
  Classes: 0.000-0.043, 0.043-0.072, 0.072-0.094, 0.094-0.117, 0.117-0.550
  dinuc_TT             F1: 0.18 0.52 0.53 0.54 0.55 0.62 0.66 0.68 0.69 0.70 0.70 0.70 0.70

PC scaling curves saved to: results/sep/v40/pc_scaling_curves.png
PC scaling curves PDF saved to: results/sep/v40/pc_scaling_curves.pdf
PC scaling data exported to: results/sep/v40/pc_scaling_curves.csv

======================================================================
SUMMARY: F1 by n_components
======================================================================
Target                     0       1       2       3       4       8      16      32      64     128     256     512    1024
----------------------------------------------------------------------------------------------------------------------------
dinuc_AA               0.172   0.514   0.529   0.532   0.534   0.609   0.652   0.666   0.687   0.698   0.698   0.697   0.696
dinuc_AT               0.166   0.655   0.658   0.662   0.666   0.676   0.690   0.716   0.747   0.752   0.755   0.755   0.755
dinuc_CG               0.148   0.408   0.454   0.501   0.549   0.688   0.712   0.724   0.744   0.747   0.749   0.750   0.749
dinuc_GC               0.185   0.604   0.610   0.616   0.622   0.628   0.643   0.675   0.706   0.710   0.716   0.716   0.716
dinuc_TA               0.183   0.631   0.635   0.641   0.644   0.674   0.710   0.746   0.759   0.763   0.764   0.765   0.763
dinuc_TT               0.181   0.519   0.532   0.543   0.550   0.619   0.665   0.678   0.694   0.703   0.703   0.703   0.701
gc_content             0.190   0.790   0.793   0.800   0.806   0.821   0.863   0.873   0.891   0.892   0.893   0.892   0.892
kmer_entropy_1         0.198   0.604   0.620   0.648   0.658   0.695   0.733   0.739   0.751   0.750   0.750   0.747   0.747
kmer_entropy_3         0.201   0.472   0.523   0.549   0.558   0.610   0.662   0.674   0.684   0.685   0.687   0.684   0.683
kmer_entropy_9         0.102   0.235   0.305   0.354   0.366   0.397   0.416   0.419   0.423   0.424   0.423   0.422   0.421
repeat_fraction        0.198   0.278   0.309   0.339   0.356   0.372   0.417   0.433   0.444   0.446   0.446   0.445   0.444
species                0.000   0.001   0.002   0.004   0.004   0.008   0.009   0.010   0.011   0.008   0.010   0.005   0.008

Training species classifier with n_components=1024 PCs...
[Species] Filtered: 408/417 classes, 262135/262144 samples
  Classes: Acanthaster planci, Acanthisitta chloris, Acanthopagrus latus, Acipenser ruthenus, Acropora millepora, Actinia tenebrosa, Adelges cooleyi, Aethina tumida, Agrilus planipennis, Alligator mississippiensis, ... (+398 more)
