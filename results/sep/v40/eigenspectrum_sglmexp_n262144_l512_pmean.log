Run started: 2025-12-30T19:48:57.754073
Arguments: Namespace(source='glmexp', n_samples=[16384, 65536, 262144], seq_len=512, pooling_method='mean', model_path=None, model_subfolder='', model_revision=None, seed=42, batch_size=1024, device='cuda', dtype=torch.bfloat16, output_dir='results/sep/v40', force=False, species_filter=None, species_filter_file=None, species_column='organism', split='train', dataset_path='eczech/gpn-animal-promoter-dataset', dataset_config=None, dataset_revision='f009db443a914d4113922e3028de0666b85c24d6', text_column='seq', tokenization_mode='strict', dataset_sample_size=None, dataset_shuffle=False, dataset_dir=None, min_samples_per_class=16)

============================================================
Eigenspectrum Analysis of DNA Sequences
============================================================
Parameters:
  - Source: glmexp
  - Sample sizes: [16384, 65536, 262144]
  - Sequence length: 512 bp
  - Feature dimension: model hidden size
  - Pooling method: mean

Loading dataset from HuggingFace (path=eczech/gpn-animal-promoter-dataset, revision=f009db443a914d4113922e3028de0666b85c24d6, split=train)...
Dataset size: 9,038,354 records

Preparing sequences (cropping to 512 bp and filtering empty)...
  Records before filtering: 9,038,354
  Records after filtering: 9,038,354
  Empty sequences filtered: 0
Sampling 262144 records...
Extracting records...
  Unique species: 417
Loading GLM-Experiments Lightning checkpoint from gonzalobenegas/dev-glm-experiments-logs...
  Downloading checkpoint from HuggingFace...
  Downloading config from HuggingFace...
  Loading config...
  Replacing scheduler/optimizer with dummies for inference...
  Instantiating model from config...
  Loading checkpoint weights...
/work/10459/eczech/vista/repos/plantcad-spectral-analysis/scripts/plantcad_eigenanalysis.py:536: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(checkpoint_path, map_location="cpu")
  Hidden size: 1024
  Parameters: 298,908,672 (298.9M)
  Device: cuda, Dtype: torch.bfloat16
  Loading tokenizer from gonzalobenegas/tokenizer-dna-mlm...
  Tokenizer vocab size: 7
Extracting embeddings:   0%|          | 0/256 [00:00<?, ?it/s]Extracting embeddings:   0%|          | 1/256 [00:01<07:08,  1.68s/it]Extracting embeddings:   1%|          | 2/256 [00:03<06:31,  1.54s/it]Extracting embeddings:   1%|1         | 3/256 [00:04<06:18,  1.50s/it]Extracting embeddings:   2%|1         | 4/256 [00:06<06:11,  1.48s/it]Extracting embeddings:   2%|1         | 5/256 [00:07<06:07,  1.46s/it]Extracting embeddings:   2%|2         | 6/256 [00:08<06:04,  1.46s/it]Extracting embeddings:   3%|2         | 7/256 [00:10<06:01,  1.45s/it]Extracting embeddings:   3%|3         | 8/256 [00:11<05:59,  1.45s/it]Extracting embeddings:   4%|3         | 9/256 [00:13<05:57,  1.45s/it]Extracting embeddings:   4%|3         | 10/256 [00:14<05:56,  1.45s/it]Extracting embeddings:   4%|4         | 11/256 [00:16<05:54,  1.45s/it]Extracting embeddings:   5%|4         | 12/256 [00:17<05:52,  1.45s/it]Extracting embeddings:   5%|5         | 13/256 [00:19<05:51,  1.45s/it]Extracting embeddings:   5%|5         | 14/256 [00:20<05:49,  1.45s/it]Extracting embeddings:   6%|5         | 15/256 [00:21<05:48,  1.45s/it]Extracting embeddings:   6%|6         | 16/256 [00:23<05:47,  1.45s/it]Extracting embeddings:   7%|6         | 17/256 [00:24<05:45,  1.45s/it]Extracting embeddings:   7%|7         | 18/256 [00:26<05:53,  1.49s/it]Extracting embeddings:   7%|7         | 19/256 [00:27<05:49,  1.48s/it]Extracting embeddings:   8%|7         | 20/256 [00:29<05:46,  1.47s/it]Extracting embeddings:   8%|8         | 21/256 [00:30<05:43,  1.46s/it]Extracting embeddings:   9%|8         | 22/256 [00:32<05:40,  1.46s/it]Extracting embeddings:   9%|8         | 23/256 [00:33<05:38,  1.45s/it]Extracting embeddings:   9%|9         | 24/256 [00:35<05:36,  1.45s/it]Extracting embeddings:  10%|9         | 25/256 [00:36<05:34,  1.45s/it]Extracting embeddings:  10%|#         | 26/256 [00:37<05:33,  1.45s/it]Extracting embeddings:  11%|#         | 27/256 [00:39<05:31,  1.45s/it]Extracting embeddings:  11%|#         | 28/256 [00:40<05:30,  1.45s/it]Extracting embeddings:  11%|#1        | 29/256 [00:42<05:28,  1.45s/it]Extracting embeddings:  12%|#1        | 30/256 [00:43<05:27,  1.45s/it]Extracting embeddings:  12%|#2        | 31/256 [00:45<05:25,  1.45s/it]Extracting embeddings:  12%|#2        | 32/256 [00:46<05:24,  1.45s/it]Extracting embeddings:  13%|#2        | 33/256 [00:48<05:22,  1.45s/it]Extracting embeddings:  13%|#3        | 34/256 [00:49<05:21,  1.45s/it]Extracting embeddings:  14%|#3        | 35/256 [00:50<05:19,  1.45s/it]Extracting embeddings:  14%|#4        | 36/256 [00:52<05:18,  1.45s/it]Extracting embeddings:  14%|#4        | 37/256 [00:53<05:17,  1.45s/it]Extracting embeddings:  15%|#4        | 38/256 [00:55<05:15,  1.45s/it]Extracting embeddings:  15%|#5        | 39/256 [00:56<05:14,  1.45s/it]Extracting embeddings:  16%|#5        | 40/256 [00:58<05:21,  1.49s/it]Extracting embeddings:  16%|#6        | 41/256 [00:59<05:17,  1.48s/it]Extracting embeddings:  16%|#6        | 42/256 [01:01<05:14,  1.47s/it]Extracting embeddings:  17%|#6        | 43/256 [01:02<05:11,  1.46s/it]Extracting embeddings:  17%|#7        | 44/256 [01:04<05:09,  1.46s/it]Extracting embeddings:  18%|#7        | 45/256 [01:05<05:06,  1.45s/it]Extracting embeddings:  18%|#7        | 46/256 [01:07<05:04,  1.45s/it]Extracting embeddings:  18%|#8        | 47/256 [01:08<05:03,  1.45s/it]Extracting embeddings:  19%|#8        | 48/256 [01:09<05:01,  1.45s/it]Extracting embeddings:  19%|#9        | 49/256 [01:11<05:00,  1.45s/it]Extracting embeddings:  20%|#9        | 50/256 [01:12<04:58,  1.45s/it]Extracting embeddings:  20%|#9        | 51/256 [01:14<04:57,  1.45s/it]Extracting embeddings:  20%|##        | 52/256 [01:15<04:55,  1.45s/it]Extracting embeddings:  21%|##        | 53/256 [01:17<04:54,  1.45s/it]Extracting embeddings:  21%|##1       | 54/256 [01:18<04:52,  1.45s/it]Extracting embeddings:  21%|##1       | 55/256 [01:20<04:51,  1.45s/it]Extracting embeddings:  22%|##1       | 56/256 [01:21<04:49,  1.45s/it]Extracting embeddings:  22%|##2       | 57/256 [01:22<04:48,  1.45s/it]Extracting embeddings:  23%|##2       | 58/256 [01:24<04:46,  1.45s/it]Extracting embeddings:  23%|##3       | 59/256 [01:25<04:45,  1.45s/it]Extracting embeddings:  23%|##3       | 60/256 [01:27<04:43,  1.45s/it]Extracting embeddings:  24%|##3       | 61/256 [01:28<04:42,  1.45s/it]Extracting embeddings:  24%|##4       | 62/256 [01:30<04:41,  1.45s/it]Extracting embeddings:  25%|##4       | 63/256 [01:31<04:47,  1.49s/it]Extracting embeddings:  25%|##5       | 64/256 [01:33<04:43,  1.48s/it]Extracting embeddings:  25%|##5       | 65/256 [01:34<04:40,  1.47s/it]Extracting embeddings:  26%|##5       | 66/256 [01:36<04:37,  1.46s/it]Extracting embeddings:  26%|##6       | 67/256 [01:37<04:35,  1.46s/it]Extracting embeddings:  27%|##6       | 68/256 [01:39<04:33,  1.45s/it]Extracting embeddings:  27%|##6       | 69/256 [01:40<04:31,  1.45s/it]Extracting embeddings:  27%|##7       | 70/256 [01:41<04:29,  1.45s/it]Extracting embeddings:  28%|##7       | 71/256 [01:43<04:28,  1.45s/it]Extracting embeddings:  28%|##8       | 72/256 [01:44<04:26,  1.45s/it]Extracting embeddings:  29%|##8       | 73/256 [01:46<04:25,  1.45s/it]Extracting embeddings:  29%|##8       | 74/256 [01:47<04:23,  1.45s/it]Extracting embeddings:  29%|##9       | 75/256 [01:49<04:22,  1.45s/it]Extracting embeddings:  30%|##9       | 76/256 [01:50<04:20,  1.45s/it]Extracting embeddings:  30%|###       | 77/256 [01:52<04:19,  1.45s/it]Extracting embeddings:  30%|###       | 78/256 [01:53<04:17,  1.45s/it]Extracting embeddings:  31%|###       | 79/256 [01:54<04:16,  1.45s/it]Extracting embeddings:  31%|###1      | 80/256 [01:56<04:14,  1.45s/it]Extracting embeddings:  32%|###1      | 81/256 [01:57<04:13,  1.45s/it]Extracting embeddings:  32%|###2      | 82/256 [01:59<04:11,  1.45s/it]Extracting embeddings:  32%|###2      | 83/256 [02:00<04:10,  1.45s/it]Extracting embeddings:  33%|###2      | 84/256 [02:02<04:08,  1.45s/it]Extracting embeddings:  33%|###3      | 85/256 [02:03<04:07,  1.45s/it]Extracting embeddings:  34%|###3      | 86/256 [02:05<04:13,  1.49s/it]Extracting embeddings:  34%|###3      | 87/256 [02:06<04:09,  1.48s/it]Extracting embeddings:  34%|###4      | 88/256 [02:08<04:06,  1.47s/it]Extracting embeddings:  35%|###4      | 89/256 [02:09<04:04,  1.46s/it]Extracting embeddings:  35%|###5      | 90/256 [02:11<04:02,  1.46s/it]Extracting embeddings:  36%|###5      | 91/256 [02:12<04:00,  1.46s/it]Extracting embeddings:  36%|###5      | 92/256 [02:13<03:58,  1.45s/it]Extracting embeddings:  36%|###6      | 93/256 [02:15<03:56,  1.45s/it]Extracting embeddings:  37%|###6      | 94/256 [02:16<03:54,  1.45s/it]Extracting embeddings:  37%|###7      | 95/256 [02:18<03:53,  1.45s/it]Extracting embeddings:  38%|###7      | 96/256 [02:19<03:51,  1.45s/it]Extracting embeddings:  38%|###7      | 97/256 [02:21<03:50,  1.45s/it]Extracting embeddings:  38%|###8      | 98/256 [02:22<03:48,  1.45s/it]Extracting embeddings:  39%|###8      | 99/256 [02:24<03:47,  1.45s/it]Extracting embeddings:  39%|###9      | 100/256 [02:25<03:46,  1.45s/it]Extracting embeddings:  39%|###9      | 101/256 [02:26<03:44,  1.45s/it]Extracting embeddings:  40%|###9      | 102/256 [02:28<03:43,  1.45s/it]Extracting embeddings:  40%|####      | 103/256 [02:29<03:41,  1.45s/it]Extracting embeddings:  41%|####      | 104/256 [02:31<03:40,  1.45s/it]Extracting embeddings:  41%|####1     | 105/256 [02:32<03:38,  1.45s/it]Extracting embeddings:  41%|####1     | 106/256 [02:34<03:37,  1.45s/it]Extracting embeddings:  42%|####1     | 107/256 [02:35<03:35,  1.45s/it]Extracting embeddings:  42%|####2     | 108/256 [02:37<03:34,  1.45s/it]Extracting embeddings:  43%|####2     | 109/256 [02:38<03:32,  1.45s/it]Extracting embeddings:  43%|####2     | 110/256 [02:40<03:37,  1.49s/it]Extracting embeddings:  43%|####3     | 111/256 [02:41<03:34,  1.48s/it]Extracting embeddings:  44%|####3     | 112/256 [02:43<03:31,  1.47s/it]Extracting embeddings:  44%|####4     | 113/256 [02:44<03:29,  1.46s/it]Extracting embeddings:  45%|####4     | 114/256 [02:45<03:27,  1.46s/it]Extracting embeddings:  45%|####4     | 115/256 [02:47<03:25,  1.45s/it]Extracting embeddings:  45%|####5     | 116/256 [02:48<03:23,  1.45s/it]Extracting embeddings:  46%|####5     | 117/256 [02:50<03:21,  1.45s/it]Extracting embeddings:  46%|####6     | 118/256 [02:51<03:20,  1.45s/it]Extracting embeddings:  46%|####6     | 119/256 [02:53<03:18,  1.45s/it]Extracting embeddings:  47%|####6     | 120/256 [02:54<03:17,  1.45s/it]Extracting embeddings:  47%|####7     | 121/256 [02:56<03:15,  1.45s/it]Extracting embeddings:  48%|####7     | 122/256 [02:57<03:14,  1.45s/it]Extracting embeddings:  48%|####8     | 123/256 [02:58<03:12,  1.45s/it]Extracting embeddings:  48%|####8     | 124/256 [03:00<03:11,  1.45s/it]Extracting embeddings:  49%|####8     | 125/256 [03:01<03:09,  1.45s/it]Extracting embeddings:  49%|####9     | 126/256 [03:03<03:08,  1.45s/it]Extracting embeddings:  50%|####9     | 127/256 [03:04<03:06,  1.45s/it]Extracting embeddings:  50%|#####     | 128/256 [03:06<03:05,  1.45s/it]Extracting embeddings:  50%|#####     | 129/256 [03:07<03:03,  1.45s/it]Extracting embeddings:  51%|#####     | 130/256 [03:09<03:02,  1.45s/it]Extracting embeddings:  51%|#####1    | 131/256 [03:10<03:01,  1.45s/it]Extracting embeddings:  52%|#####1    | 132/256 [03:11<02:59,  1.45s/it]Extracting embeddings:  52%|#####1    | 133/256 [03:13<02:58,  1.45s/it]Extracting embeddings:  52%|#####2    | 134/256 [03:14<02:56,  1.45s/it]Extracting embeddings:  53%|#####2    | 135/256 [03:16<03:00,  1.49s/it]Extracting embeddings:  53%|#####3    | 136/256 [03:17<02:57,  1.48s/it]Extracting embeddings:  54%|#####3    | 137/256 [03:19<02:54,  1.47s/it]Extracting embeddings:  54%|#####3    | 138/256 [03:20<02:52,  1.46s/it]Extracting embeddings:  54%|#####4    | 139/256 [03:22<02:50,  1.46s/it]Extracting embeddings:  55%|#####4    | 140/256 [03:23<02:48,  1.46s/it]Extracting embeddings:  55%|#####5    | 141/256 [03:25<02:47,  1.45s/it]Extracting embeddings:  55%|#####5    | 142/256 [03:26<02:45,  1.45s/it]Extracting embeddings:  56%|#####5    | 143/256 [03:28<02:43,  1.45s/it]Extracting embeddings:  56%|#####6    | 144/256 [03:29<02:42,  1.45s/it]Extracting embeddings:  57%|#####6    | 145/256 [03:30<02:40,  1.45s/it]Extracting embeddings:  57%|#####7    | 146/256 [03:32<02:39,  1.45s/it]Extracting embeddings:  57%|#####7    | 147/256 [03:33<02:37,  1.45s/it]Extracting embeddings:  58%|#####7    | 148/256 [03:35<02:36,  1.45s/it]Extracting embeddings:  58%|#####8    | 149/256 [03:36<02:35,  1.45s/it]Extracting embeddings:  59%|#####8    | 150/256 [03:38<02:33,  1.45s/it]Extracting embeddings:  59%|#####8    | 151/256 [03:39<02:32,  1.45s/it]Extracting embeddings:  59%|#####9    | 152/256 [03:41<02:30,  1.45s/it]Extracting embeddings:  60%|#####9    | 153/256 [03:42<02:29,  1.45s/it]Extracting embeddings:  60%|######    | 154/256 [03:44<02:27,  1.45s/it]Extracting embeddings:  61%|######    | 155/256 [03:45<02:26,  1.45s/it]Extracting embeddings:  61%|######    | 156/256 [03:46<02:24,  1.45s/it]Extracting embeddings:  61%|######1   | 157/256 [03:48<02:23,  1.45s/it]Extracting embeddings:  62%|######1   | 158/256 [03:49<02:25,  1.49s/it]Extracting embeddings:  62%|######2   | 159/256 [03:51<02:23,  1.48s/it]Extracting embeddings:  62%|######2   | 160/256 [03:52<02:20,  1.47s/it]Extracting embeddings:  63%|######2   | 161/256 [03:54<02:18,  1.46s/it]Extracting embeddings:  63%|######3   | 162/256 [03:55<02:17,  1.46s/it]Extracting embeddings:  64%|######3   | 163/256 [03:57<02:15,  1.46s/it]Extracting embeddings:  64%|######4   | 164/256 [03:58<02:13,  1.45s/it]Extracting embeddings:  64%|######4   | 165/256 [04:00<02:12,  1.45s/it]Extracting embeddings:  65%|######4   | 166/256 [04:01<02:10,  1.45s/it]Extracting embeddings:  65%|######5   | 167/256 [04:02<02:08,  1.45s/it]Extracting embeddings:  66%|######5   | 168/256 [04:04<02:07,  1.45s/it]Extracting embeddings:  66%|######6   | 169/256 [04:05<02:05,  1.45s/it]Extracting embeddings:  66%|######6   | 170/256 [04:07<02:04,  1.45s/it]Extracting embeddings:  67%|######6   | 171/256 [04:08<02:03,  1.45s/it]Extracting embeddings:  67%|######7   | 172/256 [04:10<02:01,  1.45s/it]Extracting embeddings:  68%|######7   | 173/256 [04:11<02:00,  1.45s/it]Extracting embeddings:  68%|######7   | 174/256 [04:13<01:58,  1.45s/it]Extracting embeddings:  68%|######8   | 175/256 [04:14<01:57,  1.45s/it]Extracting embeddings:  69%|######8   | 176/256 [04:16<01:55,  1.45s/it]Extracting embeddings:  69%|######9   | 177/256 [04:17<01:54,  1.45s/it]Extracting embeddings:  70%|######9   | 178/256 [04:18<01:53,  1.45s/it]Extracting embeddings:  70%|######9   | 179/256 [04:20<01:54,  1.49s/it]Extracting embeddings:  70%|#######   | 180/256 [04:21<01:52,  1.48s/it]Extracting embeddings:  71%|#######   | 181/256 [04:23<01:50,  1.47s/it]Extracting embeddings:  71%|#######1  | 182/256 [04:24<01:48,  1.46s/it]Extracting embeddings:  71%|#######1  | 183/256 [04:26<01:46,  1.46s/it]Extracting embeddings:  72%|#######1  | 184/256 [04:27<01:44,  1.46s/it]Extracting embeddings:  72%|#######2  | 185/256 [04:29<01:43,  1.45s/it]Extracting embeddings:  73%|#######2  | 186/256 [04:30<01:41,  1.45s/it]Extracting embeddings:  73%|#######3  | 187/256 [04:32<01:40,  1.45s/it]Extracting embeddings:  73%|#######3  | 188/256 [04:33<01:38,  1.45s/it]Extracting embeddings:  74%|#######3  | 189/256 [04:34<01:37,  1.45s/it]Extracting embeddings:  74%|#######4  | 190/256 [04:36<01:35,  1.45s/it]Extracting embeddings:  75%|#######4  | 191/256 [04:37<01:34,  1.45s/it]Extracting embeddings:  75%|#######5  | 192/256 [04:39<01:32,  1.45s/it]Extracting embeddings:  75%|#######5  | 193/256 [04:40<01:31,  1.45s/it]Extracting embeddings:  76%|#######5  | 194/256 [04:42<01:29,  1.45s/it]Extracting embeddings:  76%|#######6  | 195/256 [04:43<01:28,  1.45s/it]Extracting embeddings:  77%|#######6  | 196/256 [04:45<01:26,  1.45s/it]Extracting embeddings:  77%|#######6  | 197/256 [04:46<01:25,  1.45s/it]Extracting embeddings:  77%|#######7  | 198/256 [04:48<01:24,  1.45s/it]Extracting embeddings:  78%|#######7  | 199/256 [04:49<01:22,  1.45s/it]Extracting embeddings:  78%|#######8  | 200/256 [04:50<01:21,  1.45s/it]Extracting embeddings:  79%|#######8  | 201/256 [04:52<01:21,  1.49s/it]Extracting embeddings:  79%|#######8  | 202/256 [04:53<01:19,  1.48s/it]Extracting embeddings:  79%|#######9  | 203/256 [04:55<01:17,  1.47s/it]Extracting embeddings:  80%|#######9  | 204/256 [04:56<01:16,  1.46s/it]Extracting embeddings:  80%|########  | 205/256 [04:58<01:14,  1.46s/it]Extracting embeddings:  80%|########  | 206/256 [04:59<01:12,  1.45s/it]Extracting embeddings:  81%|########  | 207/256 [05:01<01:11,  1.45s/it]Extracting embeddings:  81%|########1 | 208/256 [05:02<01:09,  1.45s/it]Extracting embeddings:  82%|########1 | 209/256 [05:04<01:08,  1.45s/it]Extracting embeddings:  82%|########2 | 210/256 [05:05<01:06,  1.45s/it]Extracting embeddings:  82%|########2 | 211/256 [05:06<01:05,  1.45s/it]Extracting embeddings:  83%|########2 | 212/256 [05:08<01:03,  1.45s/it]Extracting embeddings:  83%|########3 | 213/256 [05:09<01:02,  1.45s/it]Extracting embeddings:  84%|########3 | 214/256 [05:11<01:00,  1.45s/it]Extracting embeddings:  84%|########3 | 215/256 [05:12<00:59,  1.45s/it]Extracting embeddings:  84%|########4 | 216/256 [05:14<00:57,  1.45s/it]Extracting embeddings:  85%|########4 | 217/256 [05:15<00:56,  1.45s/it]Extracting embeddings:  85%|########5 | 218/256 [05:17<00:55,  1.45s/it]Extracting embeddings:  86%|########5 | 219/256 [05:18<00:53,  1.45s/it]Extracting embeddings:  86%|########5 | 220/256 [05:20<00:52,  1.45s/it]Extracting embeddings:  86%|########6 | 221/256 [05:21<00:50,  1.45s/it]Extracting embeddings:  87%|########6 | 222/256 [05:22<00:49,  1.45s/it]Extracting embeddings:  87%|########7 | 223/256 [05:24<00:47,  1.45s/it]Extracting embeddings:  88%|########7 | 224/256 [05:25<00:47,  1.49s/it]Extracting embeddings:  88%|########7 | 225/256 [05:27<00:45,  1.48s/it]Extracting embeddings:  88%|########8 | 226/256 [05:28<00:44,  1.47s/it]Extracting embeddings:  89%|########8 | 227/256 [05:30<00:42,  1.46s/it]Extracting embeddings:  89%|########9 | 228/256 [05:31<00:40,  1.46s/it]Extracting embeddings:  89%|########9 | 229/256 [05:33<00:39,  1.46s/it]Extracting embeddings:  90%|########9 | 230/256 [05:34<00:37,  1.45s/it]Extracting embeddings:  90%|######### | 231/256 [05:36<00:36,  1.45s/it]Extracting embeddings:  91%|######### | 232/256 [05:37<00:34,  1.45s/it]Extracting embeddings:  91%|#########1| 233/256 [05:38<00:33,  1.45s/it]Extracting embeddings:  91%|#########1| 234/256 [05:40<00:31,  1.45s/it]Extracting embeddings:  92%|#########1| 235/256 [05:41<00:30,  1.45s/it]Extracting embeddings:  92%|#########2| 236/256 [05:43<00:28,  1.45s/it]Extracting embeddings:  93%|#########2| 237/256 [05:44<00:27,  1.45s/it]Extracting embeddings:  93%|#########2| 238/256 [05:46<00:26,  1.45s/it]Extracting embeddings:  93%|#########3| 239/256 [05:47<00:24,  1.45s/it]Extracting embeddings:  94%|#########3| 240/256 [05:49<00:23,  1.45s/it]Extracting embeddings:  94%|#########4| 241/256 [05:50<00:21,  1.45s/it]Extracting embeddings:  95%|#########4| 242/256 [05:52<00:20,  1.45s/it]Extracting embeddings:  95%|#########4| 243/256 [05:53<00:18,  1.45s/it]Extracting embeddings:  95%|#########5| 244/256 [05:54<00:17,  1.45s/it]Extracting embeddings:  96%|#########5| 245/256 [05:56<00:15,  1.45s/it]Extracting embeddings:  96%|#########6| 246/256 [05:57<00:14,  1.45s/it]Extracting embeddings:  96%|#########6| 247/256 [05:59<00:13,  1.49s/it]Extracting embeddings:  97%|#########6| 248/256 [06:00<00:11,  1.48s/it]Extracting embeddings:  97%|#########7| 249/256 [06:02<00:10,  1.47s/it]Extracting embeddings:  98%|#########7| 250/256 [06:03<00:08,  1.46s/it]Extracting embeddings:  98%|#########8| 251/256 [06:05<00:07,  1.46s/it]Extracting embeddings:  98%|#########8| 252/256 [06:06<00:05,  1.46s/it]Extracting embeddings:  99%|#########8| 253/256 [06:08<00:04,  1.45s/it]Extracting embeddings:  99%|#########9| 254/256 [06:09<00:02,  1.45s/it]Extracting embeddings: 100%|#########9| 255/256 [06:10<00:01,  1.45s/it]Extracting embeddings: 100%|##########| 256/256 [06:12<00:00,  1.45s/it]Extracting embeddings: 100%|##########| 256/256 [06:12<00:00,  1.45s/it]
  Embedding matrix shape: (262144, 1024)

Computing PCA for n_samples=16384...
  Computed 1024 eigenvalues
  Top 10 eigenvalues: [0.54366714 0.0507568  0.04546674 0.03485246 0.02854545 0.02276642
 0.01770478 0.01430446 0.0130925  0.00945888]
  Variance explained by top 10: 78.27%

Computing PCA for n_samples=65536...
  Computed 1024 eigenvalues
  Top 10 eigenvalues: [0.54567546 0.0522627  0.04612705 0.03551131 0.02882829 0.02232266
 0.01810791 0.01446347 0.01310725 0.00964457]
  Variance explained by top 10: 78.29%

Computing PCA for n_samples=262144...
  Computed 1024 eigenvalues
  Top 10 eigenvalues: [0.5449407  0.05081695 0.04676056 0.0360752  0.02856448 0.02239364
 0.01805821 0.01420695 0.0131293  0.00971982]
  Variance explained by top 10: 78.23%

Fitting full PCA for classification (n=262144)...

Saving checkpoint to: results/sep/v40/eigenspectrum_sglmexp_l512_n16384_65536_262144_pmean.pkl

For n=262144:
  Components needed for 90% variance: 42
  Components needed for 95% variance: 97
  Effective sample size: 3.29036355
  Condition number: 9.20192180e+14

Figure saved to: results/sep/v40/eigenspectrum_sglmexp_n262144_l512_pmean.png
PDF saved to: results/sep/v40/eigenspectrum_sglmexp_n262144_l512_pmean.pdf
Eigenvalue data exported to: results/sep/v40/eigenspectrum_sglmexp_n262144_l512_pmean.csv

======================================================================
PC SCALING ANALYSIS
Testing n_components: [0, 1, 2, 3, 4, 8, 16, 32, 64, 128, 256, 512, 1024]
======================================================================
Extracting sequence features:   0%|          | 0/262144 [00:00<?, ?it/s]Extracting sequence features:   1%|1         | 3565/262144 [00:00<00:07, 35646.63it/s]Extracting sequence features:   3%|2         | 7403/262144 [00:00<00:06, 37251.90it/s]Extracting sequence features:   4%|4         | 11292/262144 [00:00<00:06, 37996.72it/s]Extracting sequence features:   6%|5         | 15168/262144 [00:00<00:06, 38294.76it/s]Extracting sequence features:   7%|7         | 19074/262144 [00:00<00:06, 38569.50it/s]Extracting sequence features:   9%|8         | 22995/262144 [00:00<00:06, 38785.82it/s]Extracting sequence features:  10%|#         | 26901/262144 [00:00<00:06, 38873.43it/s]Extracting sequence features:  12%|#1        | 30811/262144 [00:00<00:05, 38944.03it/s]Extracting sequence features:  13%|#3        | 34724/262144 [00:00<00:05, 38999.29it/s]Extracting sequence features:  15%|#4        | 38634/262144 [00:01<00:05, 39028.84it/s]Extracting sequence features:  16%|#6        | 42538/262144 [00:01<00:05, 39012.03it/s]Extracting sequence features:  18%|#7        | 46495/262144 [00:01<00:05, 39103.24it/s]Extracting sequence features:  19%|#9        | 50431/262144 [00:01<00:05, 39179.26it/s]Extracting sequence features:  21%|##        | 54349/262144 [00:01<00:05, 39143.04it/s]Extracting sequence features:  22%|##2       | 58279/262144 [00:01<00:05, 39188.52it/s]Extracting sequence features:  24%|##3       | 62232/262144 [00:01<00:05, 39215.78it/s]Extracting sequence features:  25%|##5       | 66170/262144 [00:01<00:04, 39263.80it/s]Extracting sequence features:  27%|##6       | 70097/262144 [00:01<00:04, 39237.55it/s]Extracting sequence features:  28%|##8       | 74021/262144 [00:01<00:04, 39215.44it/s]Extracting sequence features:  30%|##9       | 77951/262144 [00:02<00:04, 39188.23it/s]Extracting sequence features:  31%|###1      | 81870/262144 [00:02<00:04, 39066.20it/s]Extracting sequence features:  33%|###2      | 85830/262144 [00:02<00:04, 39224.77it/s]Extracting sequence features:  34%|###4      | 89753/262144 [00:02<00:04, 39172.82it/s]Extracting sequence features:  36%|###5      | 93671/262144 [00:02<00:04, 39134.44it/s]Extracting sequence features:  37%|###7      | 97585/262144 [00:02<00:04, 39134.13it/s]Extracting sequence features:  39%|###8      | 101511/262144 [00:02<00:04, 39163.47it/s]Extracting sequence features:  40%|####      | 105439/262144 [00:02<00:04, 39145.83it/s]Extracting sequence features:  42%|####1     | 109354/262144 [00:02<00:03, 39098.02it/s]Extracting sequence features:  43%|####3     | 113274/262144 [00:02<00:03, 39126.80it/s]Extracting sequence features:  45%|####4     | 117187/262144 [00:03<00:03, 39070.26it/s]Extracting sequence features:  46%|####6     | 121095/262144 [00:03<00:03, 39065.38it/s]Extracting sequence features:  48%|####7     | 125002/262144 [00:03<00:03, 39026.67it/s]Extracting sequence features:  49%|####9     | 128905/262144 [00:03<00:03, 38961.48it/s]Extracting sequence features:  51%|#####     | 132802/262144 [00:03<00:03, 38930.27it/s]Extracting sequence features:  52%|#####2    | 136706/262144 [00:03<00:03, 38960.01it/s]Extracting sequence features:  54%|#####3    | 140630/262144 [00:03<00:03, 38987.36it/s]Extracting sequence features:  55%|#####5    | 144545/262144 [00:03<00:03, 39035.64it/s]Extracting sequence features:  57%|#####6    | 148476/262144 [00:03<00:02, 39085.37it/s]Extracting sequence features:  58%|#####8    | 152398/262144 [00:03<00:02, 39120.73it/s]Extracting sequence features:  60%|#####9    | 156324/262144 [00:04<00:02, 39159.50it/s]Extracting sequence features:  61%|######1   | 160263/262144 [00:04<00:02, 39225.60it/s]Extracting sequence features:  63%|######2   | 164209/262144 [00:04<00:02, 39295.35it/s]Extracting sequence features:  64%|######4   | 168139/262144 [00:04<00:02, 39242.50it/s]Extracting sequence features:  66%|######5   | 172064/262144 [00:04<00:02, 39103.56it/s]Extracting sequence features:  67%|######7   | 175975/262144 [00:04<00:02, 39093.43it/s]Extracting sequence features:  69%|######8   | 179885/262144 [00:04<00:02, 39048.05it/s]Extracting sequence features:  70%|#######   | 183794/262144 [00:04<00:02, 39017.08it/s]Extracting sequence features:  72%|#######1  | 187710/262144 [00:04<00:01, 38979.80it/s]Extracting sequence features:  73%|#######3  | 191636/262144 [00:04<00:01, 39062.65it/s]Extracting sequence features:  75%|#######4  | 195543/262144 [00:05<00:01, 39014.16it/s]Extracting sequence features:  76%|#######6  | 199445/262144 [00:05<00:01, 39014.42it/s]Extracting sequence features:  78%|#######7  | 203365/262144 [00:05<00:01, 39064.70it/s]Extracting sequence features:  79%|#######9  | 207272/262144 [00:05<00:01, 39059.88it/s]Extracting sequence features:  81%|########  | 211179/262144 [00:05<00:01, 39044.40it/s]Extracting sequence features:  82%|########2 | 215084/262144 [00:05<00:01, 39032.93it/s]Extracting sequence features:  84%|########3 | 219009/262144 [00:05<00:01, 39091.18it/s]Extracting sequence features:  85%|########5 | 222940/262144 [00:05<00:01, 39156.11it/s]Extracting sequence features:  87%|########6 | 226868/262144 [00:05<00:00, 39192.71it/s]Extracting sequence features:  88%|########8 | 230788/262144 [00:05<00:00, 39175.64it/s]Extracting sequence features:  90%|########9 | 234706/262144 [00:06<00:00, 39161.76it/s]Extracting sequence features:  91%|#########1| 238623/262144 [00:06<00:00, 39158.36it/s]Extracting sequence features:  93%|#########2| 242557/262144 [00:06<00:00, 39212.58it/s]Extracting sequence features:  94%|#########4| 246479/262144 [00:06<00:00, 39214.00it/s]Extracting sequence features:  96%|#########5| 250410/262144 [00:06<00:00, 39241.34it/s]Extracting sequence features:  97%|#########7| 254335/262144 [00:06<00:00, 39164.58it/s]Extracting sequence features:  99%|#########8| 258277/262144 [00:06<00:00, 39238.80it/s]Extracting sequence features: 100%|##########| 262144/262144 [00:06<00:00, 39059.21it/s]
[species[n_comp=0]] Filtered: 406/417 classes, 262127/262144 samples
  Classes: Acanthaster planci, Acanthisitta chloris, Acanthopagrus latus, Acipenser ruthenus, Acropora millepora, Actinia tenebrosa, Adelges cooleyi, Aethina tumida, Agrilus planipennis, Alligator mississippiensis, ... (+396 more)
  species              Performance by n_components:
    Accuracy:  0.081 0.059 0.005 0.008 0.010 0.010 0.014 0.014 0.010 0.007 0.013 0.020 0.010
    F1:        0.000 0.000 0.001 0.003 0.006 0.008 0.011 0.009 0.010 0.005 0.010 0.008 0.008
    ROC AUC:   0.502 0.570 0.501 0.501 0.503 0.504 0.506 0.504 0.505 0.502 0.505 0.503 0.504
    AUPRC:     0.003 0.005 0.002 0.003 0.003 0.003 0.003 0.003 0.003 0.003 0.003 0.003 0.003
[gc_content[n_comp=0]] 5 classes, 262144 samples
  Classes: 0.094-0.365, 0.365-0.416, 0.416-0.475, 0.475-0.586, 0.586-1.000
  gc_content           Performance by n_components:
    Accuracy:  0.198 0.790 0.793 0.799 0.806 0.821 0.863 0.873 0.890 0.892 0.893 0.892 0.892
    F1:        0.190 0.790 0.793 0.800 0.806 0.821 0.863 0.873 0.891 0.892 0.893 0.892 0.892
    ROC AUC:   0.500 0.960 0.961 0.963 0.965 0.970 0.981 0.983 0.987 0.988 0.988 0.988 0.987
    AUPRC:     0.199 0.836 0.842 0.850 0.858 0.877 0.922 0.929 0.946 0.948 0.948 0.947 0.946
[repeat_fraction[n_comp=0]] 5 classes, 262144 samples
  Classes: 0.000-0.055, 0.055-0.123, 0.123-0.193, 0.193-0.311, 0.311-1.000
  repeat_fraction      Performance by n_components:
    Accuracy:  0.201 0.286 0.326 0.356 0.367 0.384 0.425 0.441 0.451 0.453 0.454 0.454 0.453
    F1:        0.198 0.278 0.309 0.339 0.356 0.372 0.417 0.433 0.444 0.446 0.446 0.445 0.444
    ROC AUC:   0.498 0.608 0.654 0.685 0.702 0.720 0.759 0.771 0.779 0.781 0.781 0.780 0.779
    AUPRC:     0.199 0.282 0.322 0.350 0.370 0.393 0.442 0.456 0.468 0.469 0.470 0.469 0.469
[kmer_entropy_1[n_comp=0]] 5 classes, 262144 samples
  Classes: 0.000-1.896, 1.896-1.944, 1.944-1.968, 1.968-1.985, 1.985-2.000
  kmer_entropy_1       Performance by n_components:
    Accuracy:  0.199 0.606 0.622 0.648 0.658 0.695 0.733 0.739 0.750 0.750 0.749 0.747 0.747
    F1:        0.198 0.604 0.620 0.648 0.658 0.695 0.733 0.739 0.751 0.750 0.750 0.747 0.747
    ROC AUC:   0.498 0.873 0.888 0.905 0.909 0.926 0.941 0.943 0.947 0.947 0.947 0.946 0.946
    AUPRC:     0.199 0.604 0.638 0.677 0.685 0.731 0.778 0.786 0.798 0.799 0.798 0.796 0.794
[kmer_entropy_3[n_comp=0]] 5 classes, 262144 samples
  Classes: 0.000-5.507, 5.507-5.650, 5.650-5.727, 5.727-5.794, 5.794-5.949
  kmer_entropy_3       Performance by n_components:
    Accuracy:  0.201 0.479 0.530 0.556 0.565 0.612 0.662 0.674 0.684 0.686 0.688 0.685 0.684
    F1:        0.201 0.472 0.523 0.549 0.558 0.610 0.662 0.674 0.684 0.685 0.687 0.684 0.683
    ROC AUC:   0.499 0.789 0.830 0.850 0.857 0.886 0.911 0.915 0.921 0.922 0.921 0.921 0.921
    AUPRC:     0.199 0.477 0.536 0.571 0.590 0.642 0.696 0.707 0.720 0.724 0.723 0.722 0.721
[kmer_entropy_9[n_comp=0]] 5 classes, 262144 samples
  Classes: 0.000-8.920, 8.920-8.957, 8.957-8.969, 8.969-8.973, 8.973-8.977
  kmer_entropy_9       Performance by n_components:
    Accuracy:  0.345 0.405 0.466 0.507 0.517 0.542 0.558 0.560 0.563 0.565 0.564 0.564 0.563
    F1:        0.102 0.235 0.305 0.354 0.366 0.397 0.416 0.419 0.423 0.424 0.423 0.422 0.421
    ROC AUC:   0.502 0.615 0.686 0.728 0.746 0.765 0.778 0.781 0.782 0.785 0.784 0.784 0.783
    AUPRC:     0.201 0.294 0.368 0.413 0.434 0.457 0.471 0.477 0.479 0.482 0.482 0.482 0.481
[dinuc_CG[n_comp=0]] 5 classes, 262144 samples
  Classes: 0.000-0.014, 0.014-0.027, 0.027-0.041, 0.041-0.067, 0.067-0.384
  dinuc_CG             Performance by n_components:
    Accuracy:  0.218 0.417 0.455 0.498 0.548 0.684 0.708 0.720 0.741 0.744 0.746 0.747 0.746
    F1:        0.148 0.408 0.454 0.501 0.549 0.688 0.712 0.724 0.744 0.747 0.749 0.750 0.749
    ROC AUC:   0.501 0.750 0.772 0.806 0.846 0.921 0.931 0.936 0.944 0.945 0.946 0.946 0.946
    AUPRC:     0.201 0.436 0.471 0.524 0.591 0.729 0.755 0.768 0.792 0.796 0.799 0.799 0.798
[dinuc_GC[n_comp=0]] 5 classes, 262144 samples
  Classes: 0.000-0.033, 0.033-0.045, 0.045-0.059, 0.059-0.086, 0.086-0.382
  dinuc_GC             Performance by n_components:
    Accuracy:  0.206 0.601 0.607 0.613 0.619 0.625 0.641 0.672 0.704 0.708 0.714 0.714 0.713
    F1:        0.185 0.604 0.610 0.616 0.622 0.628 0.643 0.675 0.706 0.710 0.716 0.716 0.716
    ROC AUC:   0.502 0.874 0.881 0.885 0.887 0.890 0.898 0.914 0.928 0.929 0.931 0.931 0.931
    AUPRC:     0.201 0.619 0.631 0.640 0.646 0.654 0.669 0.706 0.741 0.745 0.749 0.749 0.749
[dinuc_AT[n_comp=0]] 5 classes, 262144 samples
  Classes: 0.000-0.031, 0.031-0.055, 0.055-0.072, 0.072-0.092, 0.092-0.376
  dinuc_AT             Performance by n_components:
    Accuracy:  0.203 0.652 0.654 0.658 0.662 0.673 0.687 0.713 0.744 0.750 0.752 0.753 0.752
    F1:        0.166 0.655 0.658 0.662 0.666 0.676 0.690 0.716 0.747 0.752 0.755 0.755 0.755
    ROC AUC:   0.500 0.905 0.906 0.909 0.911 0.916 0.922 0.933 0.945 0.947 0.947 0.948 0.947
    AUPRC:     0.199 0.679 0.685 0.693 0.697 0.708 0.726 0.754 0.788 0.792 0.794 0.795 0.794
[dinuc_TA[n_comp=0]] 5 classes, 262144 samples
  Classes: 0.000-0.023, 0.023-0.045, 0.045-0.063, 0.063-0.082, 0.082-0.376
  dinuc_TA             Performance by n_components:
    Accuracy:  0.203 0.626 0.630 0.638 0.640 0.671 0.707 0.743 0.756 0.760 0.761 0.763 0.761
    F1:        0.183 0.631 0.635 0.641 0.644 0.674 0.710 0.746 0.759 0.763 0.764 0.765 0.763
    ROC AUC:   0.499 0.893 0.896 0.901 0.903 0.916 0.931 0.945 0.950 0.951 0.951 0.951 0.951
    AUPRC:     0.200 0.650 0.659 0.670 0.676 0.708 0.750 0.788 0.801 0.807 0.808 0.807 0.806
[dinuc_AA[n_comp=0]] 5 classes, 262144 samples
  Classes: 0.000-0.045, 0.045-0.072, 0.072-0.094, 0.094-0.117, 0.117-0.456
  dinuc_AA             Performance by n_components:
    Accuracy:  0.206 0.518 0.534 0.539 0.541 0.614 0.654 0.669 0.689 0.700 0.701 0.700 0.699
    F1:        0.172 0.514 0.529 0.532 0.534 0.609 0.652 0.666 0.687 0.698 0.698 0.697 0.696
    ROC AUC:   0.499 0.822 0.833 0.838 0.840 0.884 0.905 0.913 0.921 0.925 0.926 0.925 0.925
    AUPRC:     0.200 0.524 0.544 0.553 0.557 0.638 0.683 0.701 0.720 0.730 0.731 0.730 0.729
[dinuc_TT[n_comp=0]] 5 classes, 262144 samples
  Classes: 0.000-0.043, 0.043-0.072, 0.072-0.094, 0.094-0.117, 0.117-0.550
  dinuc_TT             Performance by n_components:
    Accuracy:  0.207 0.522 0.537 0.547 0.551 0.620 0.665 0.678 0.694 0.703 0.703 0.703 0.701
    F1:        0.181 0.519 0.532 0.543 0.550 0.619 0.665 0.678 0.694 0.703 0.703 0.703 0.701
    ROC AUC:   0.501 0.826 0.836 0.842 0.847 0.888 0.912 0.917 0.924 0.928 0.928 0.927 0.927
    AUPRC:     0.201 0.533 0.554 0.565 0.575 0.649 0.702 0.715 0.732 0.741 0.742 0.741 0.740

PC scaling curves saved to: results/sep/v40/pc_scaling_curves.png
PC scaling curves PDF saved to: results/sep/v40/pc_scaling_curves.pdf
PC scaling data exported to: results/sep/v40/pc_scaling_curves.csv

======================================================================
SUMMARY: F1 by n_components
======================================================================
Target                     0       1       2       3       4       8      16      32      64     128     256     512    1024
----------------------------------------------------------------------------------------------------------------------------
dinuc_AA               0.172   0.514   0.529   0.532   0.534   0.609   0.652   0.666   0.687   0.698   0.698   0.697   0.696
dinuc_AT               0.166   0.655   0.658   0.662   0.666   0.676   0.690   0.716   0.747   0.752   0.755   0.755   0.755
dinuc_CG               0.148   0.408   0.454   0.501   0.549   0.688   0.712   0.724   0.744   0.747   0.749   0.750   0.749
dinuc_GC               0.185   0.604   0.610   0.616   0.622   0.628   0.643   0.675   0.706   0.710   0.716   0.716   0.716
dinuc_TA               0.183   0.631   0.635   0.641   0.644   0.674   0.710   0.746   0.759   0.763   0.764   0.765   0.763
dinuc_TT               0.181   0.519   0.532   0.543   0.550   0.619   0.665   0.678   0.694   0.703   0.703   0.703   0.701
gc_content             0.190   0.790   0.793   0.800   0.806   0.821   0.863   0.873   0.891   0.892   0.893   0.892   0.892
kmer_entropy_1         0.198   0.604   0.620   0.648   0.658   0.695   0.733   0.739   0.751   0.750   0.750   0.747   0.747
kmer_entropy_3         0.201   0.472   0.523   0.549   0.558   0.610   0.662   0.674   0.684   0.685   0.687   0.684   0.683
kmer_entropy_9         0.102   0.235   0.305   0.354   0.366   0.397   0.416   0.419   0.423   0.424   0.423   0.422   0.421
repeat_fraction        0.198   0.278   0.309   0.339   0.356   0.372   0.417   0.433   0.444   0.446   0.446   0.445   0.444
species                0.000   0.000   0.001   0.003   0.006   0.008   0.011   0.009   0.010   0.005   0.010   0.008   0.008

Training species classifier with n_components=1024 PCs...
[Species] Filtered: 406/417 classes, 262127/262144 samples
  Classes: Acanthaster planci, Acanthisitta chloris, Acanthopagrus latus, Acipenser ruthenus, Acropora millepora, Actinia tenebrosa, Adelges cooleyi, Aethina tumida, Agrilus planipennis, Alligator mississippiensis, ... (+396 more)

[Species] n_classes=406, acc=0.011, f1=0.008
Confusion matrix saved to: results/sep/v40/eigenspectrum_sglmexp_n262144_l512_pmean_confusion_matrix.png
Confusion matrix PDF saved to: results/sep/v40/eigenspectrum_sglmexp_n262144_l512_pmean_confusion_matrix.pdf
Confusion matrix data exported to: results/sep/v40/eigenspectrum_sglmexp_n262144_l512_pmean_confusion_matrix.csv
Classification metrics exported to: results/sep/v40/eigenspectrum_sglmexp_n262144_l512_pmean_confusion_matrix_metrics.csv

Run completed: 2025-12-30T20:31:27.978137

Done!
