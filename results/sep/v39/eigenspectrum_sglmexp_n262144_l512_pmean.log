Run started: 2026-01-03T08:31:44.182740
Arguments: Namespace(source='glmexp', n_samples=[16384, 65536, 262144], seq_len=512, pooling_method='mean', model_path=None, model_subfolder='', model_revision=None, seed=42, batch_size=1024, device='cuda', dtype=torch.bfloat16, output_dir='results/sep/v39', force=True, species_filter=None, species_filter_file='data/filters/gpn_promoter_65_most_common_species.txt', species_column='organism', split='train', dataset_path='eczech/gpn-animal-promoter-dataset', dataset_config=None, dataset_revision='f009db443a914d4113922e3028de0666b85c24d6', text_column='seq', tokenization_mode='strict', dataset_sample_size=None, dataset_shuffle=False, dataset_dir=None, min_samples_per_class=2, membership_split='validation', membership_n_samples=8192)

============================================================
Eigenspectrum Analysis of DNA Sequences
============================================================
Parameters:
  - Source: glmexp
  - Sample sizes: [16384, 65536, 262144]
  - Sequence length: 512 bp
  - Feature dimension: model hidden size
  - Pooling method: mean

Reading species list from: data/filters/gpn_promoter_65_most_common_species.txt
  Loaded 65 species names (65 unique)
Loading dataset from HuggingFace (path=eczech/gpn-animal-promoter-dataset, revision=f009db443a914d4113922e3028de0666b85c24d6, split=train)...
Dataset size: 9,038,354 records

Filtering data to 65 species:
  Acipenser ruthenus, Acropora millepora, Anguilla rostrata, Astatotilapia calliptera, Astyanax mexicanus, Biomphalaria glabrata, Brienomyrus brachyistius, Bubalus bubalis, Callithrix jacchus, Carassius gibelio ... (+55 more)
  Records before filtering: 9,038,354
  Records after filtering: 2,004,166

Preparing sequences (cropping to 512 bp and filtering empty)...
  Records before filtering: 2,004,166
  Records after filtering: 2,004,166
  Empty sequences filtered: 0
Sampling 262144 records...
Extracting records...
  Unique species: 65
Loading GLM-Experiments Lightning checkpoint from gonzalobenegas/dev-glm-experiments-logs...
  Downloading checkpoint from HuggingFace...
  Downloading config from HuggingFace...
  Loading config...
  Replacing scheduler/optimizer with dummies for inference...
  Instantiating model from config...
  Loading checkpoint weights...
/work/10459/eczech/vista/repos/plantcad-spectral-analysis/scripts/decompose.py:544: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(checkpoint_path, map_location="cpu")
  Hidden size: 1024
  Parameters: 298,908,672 (298.9M)
  Device: cuda, Dtype: torch.bfloat16
  Loading tokenizer from gonzalobenegas/tokenizer-dna-mlm...
  Tokenizer vocab size: 7
Extracting embeddings:   0%|          | 0/256 [00:00<?, ?it/s]Extracting embeddings:   0%|          | 1/256 [00:03<15:19,  3.61s/it]Extracting embeddings:   1%|          | 2/256 [00:05<09:54,  2.34s/it]Extracting embeddings:   1%|1         | 3/256 [00:06<08:09,  1.94s/it]Extracting embeddings:   2%|1         | 4/256 [00:07<07:19,  1.74s/it]Extracting embeddings:   2%|1         | 5/256 [00:09<06:51,  1.64s/it]Extracting embeddings:   2%|2         | 6/256 [00:10<06:34,  1.58s/it]Extracting embeddings:   3%|2         | 7/256 [00:12<06:22,  1.54s/it]Extracting embeddings:   3%|3         | 8/256 [00:13<06:14,  1.51s/it]Extracting embeddings:   4%|3         | 9/256 [00:15<06:08,  1.49s/it]Extracting embeddings:   4%|3         | 10/256 [00:16<06:04,  1.48s/it]Extracting embeddings:   4%|4         | 11/256 [00:18<06:00,  1.47s/it]Extracting embeddings:   5%|4         | 12/256 [00:19<05:57,  1.47s/it]Extracting embeddings:   5%|5         | 13/256 [00:21<05:55,  1.46s/it]Extracting embeddings:   5%|5         | 14/256 [00:22<05:53,  1.46s/it]Extracting embeddings:   6%|5         | 15/256 [00:24<06:01,  1.50s/it]Extracting embeddings:   6%|6         | 16/256 [00:25<05:57,  1.49s/it]Extracting embeddings:   7%|6         | 17/256 [00:27<05:53,  1.48s/it]Extracting embeddings:   7%|7         | 18/256 [00:28<05:50,  1.47s/it]Extracting embeddings:   7%|7         | 19/256 [00:29<05:47,  1.47s/it]Extracting embeddings:   8%|7         | 20/256 [00:31<05:45,  1.46s/it]Extracting embeddings:   8%|8         | 21/256 [00:32<05:43,  1.46s/it]Extracting embeddings:   9%|8         | 22/256 [00:34<05:41,  1.46s/it]Extracting embeddings:   9%|8         | 23/256 [00:35<05:39,  1.46s/it]Extracting embeddings:   9%|9         | 24/256 [00:37<05:37,  1.46s/it]Extracting embeddings:  10%|9         | 25/256 [00:38<05:36,  1.46s/it]Extracting embeddings:  10%|#         | 26/256 [00:40<05:34,  1.46s/it]Extracting embeddings:  11%|#         | 27/256 [00:41<05:33,  1.46s/it]Extracting embeddings:  11%|#         | 28/256 [00:43<05:31,  1.46s/it]Extracting embeddings:  11%|#1        | 29/256 [00:44<05:30,  1.46s/it]Extracting embeddings:  12%|#1        | 30/256 [00:45<05:29,  1.46s/it]Extracting embeddings:  12%|#2        | 31/256 [00:47<05:27,  1.46s/it]Extracting embeddings:  12%|#2        | 32/256 [00:48<05:26,  1.46s/it]Extracting embeddings:  13%|#2        | 33/256 [00:50<05:24,  1.46s/it]Extracting embeddings:  13%|#3        | 34/256 [00:51<05:23,  1.46s/it]Extracting embeddings:  14%|#3        | 35/256 [00:53<05:21,  1.46s/it]Extracting embeddings:  14%|#4        | 36/256 [00:54<05:20,  1.46s/it]Extracting embeddings:  14%|#4        | 37/256 [00:56<05:18,  1.46s/it]Extracting embeddings:  15%|#4        | 38/256 [00:57<05:17,  1.46s/it]Extracting embeddings:  15%|#5        | 39/256 [00:59<05:16,  1.46s/it]Extracting embeddings:  16%|#5        | 40/256 [01:00<05:23,  1.50s/it]Extracting embeddings:  16%|#6        | 41/256 [01:02<05:19,  1.49s/it]Extracting embeddings:  16%|#6        | 42/256 [01:03<05:16,  1.48s/it]Extracting embeddings:  17%|#6        | 43/256 [01:05<05:13,  1.47s/it]Extracting embeddings:  17%|#7        | 44/256 [01:06<05:11,  1.47s/it]Extracting embeddings:  18%|#7        | 45/256 [01:07<05:09,  1.47s/it]Extracting embeddings:  18%|#7        | 46/256 [01:09<05:07,  1.46s/it]Extracting embeddings:  18%|#8        | 47/256 [01:10<05:05,  1.46s/it]Extracting embeddings:  19%|#8        | 48/256 [01:12<05:03,  1.46s/it]Extracting embeddings:  19%|#9        | 49/256 [01:13<05:02,  1.46s/it]Extracting embeddings:  20%|#9        | 50/256 [01:15<05:00,  1.46s/it]Extracting embeddings:  20%|#9        | 51/256 [01:16<04:59,  1.46s/it]Extracting embeddings:  20%|##        | 52/256 [01:18<04:57,  1.46s/it]Extracting embeddings:  21%|##        | 53/256 [01:19<04:56,  1.46s/it]Extracting embeddings:  21%|##1       | 54/256 [01:21<04:54,  1.46s/it]Extracting embeddings:  21%|##1       | 55/256 [01:22<04:53,  1.46s/it]Extracting embeddings:  22%|##1       | 56/256 [01:23<04:51,  1.46s/it]Extracting embeddings:  22%|##2       | 57/256 [01:25<04:50,  1.46s/it]Extracting embeddings:  23%|##2       | 58/256 [01:26<04:48,  1.46s/it]Extracting embeddings:  23%|##3       | 59/256 [01:28<04:47,  1.46s/it]Extracting embeddings:  23%|##3       | 60/256 [01:29<04:45,  1.46s/it]Extracting embeddings:  24%|##3       | 61/256 [01:31<04:44,  1.46s/it]Extracting embeddings:  24%|##4       | 62/256 [01:32<04:42,  1.46s/it]Extracting embeddings:  25%|##4       | 63/256 [01:34<04:49,  1.50s/it]Extracting embeddings:  25%|##5       | 64/256 [01:35<04:45,  1.49s/it]Extracting embeddings:  25%|##5       | 65/256 [01:37<04:42,  1.48s/it]Extracting embeddings:  26%|##5       | 66/256 [01:38<04:39,  1.47s/it]Extracting embeddings:  26%|##6       | 67/256 [01:40<04:37,  1.47s/it]Extracting embeddings:  27%|##6       | 68/256 [01:41<04:35,  1.46s/it]Extracting embeddings:  27%|##6       | 69/256 [01:43<04:33,  1.46s/it]Extracting embeddings:  27%|##7       | 70/256 [01:44<04:31,  1.46s/it]Extracting embeddings:  28%|##7       | 71/256 [01:45<04:30,  1.46s/it]Extracting embeddings:  28%|##8       | 72/256 [01:47<04:28,  1.46s/it]Extracting embeddings:  29%|##8       | 73/256 [01:48<04:26,  1.46s/it]Extracting embeddings:  29%|##8       | 74/256 [01:50<04:25,  1.46s/it]Extracting embeddings:  29%|##9       | 75/256 [01:51<04:24,  1.46s/it]Extracting embeddings:  30%|##9       | 76/256 [01:53<04:22,  1.46s/it]Extracting embeddings:  30%|###       | 77/256 [01:54<04:21,  1.46s/it]Extracting embeddings:  30%|###       | 78/256 [01:56<04:19,  1.46s/it]Extracting embeddings:  31%|###       | 79/256 [01:57<04:18,  1.46s/it]Extracting embeddings:  31%|###1      | 80/256 [01:59<04:16,  1.46s/it]Extracting embeddings:  32%|###1      | 81/256 [02:00<04:15,  1.46s/it]Extracting embeddings:  32%|###2      | 82/256 [02:02<04:13,  1.46s/it]Extracting embeddings:  32%|###2      | 83/256 [02:03<04:12,  1.46s/it]Extracting embeddings:  33%|###2      | 84/256 [02:05<04:17,  1.50s/it]Extracting embeddings:  33%|###3      | 85/256 [02:06<04:14,  1.49s/it]Extracting embeddings:  34%|###3      | 86/256 [02:07<04:11,  1.48s/it]Extracting embeddings:  34%|###3      | 87/256 [02:09<04:08,  1.47s/it]Extracting embeddings:  34%|###4      | 88/256 [02:10<04:06,  1.47s/it]Extracting embeddings:  35%|###4      | 89/256 [02:12<04:04,  1.47s/it]Extracting embeddings:  35%|###5      | 90/256 [02:13<04:03,  1.46s/it]Extracting embeddings:  36%|###5      | 91/256 [02:15<04:01,  1.46s/it]Extracting embeddings:  36%|###5      | 92/256 [02:16<03:59,  1.46s/it]Extracting embeddings:  36%|###6      | 93/256 [02:18<03:57,  1.46s/it]Extracting embeddings:  37%|###6      | 94/256 [02:19<03:56,  1.46s/it]Extracting embeddings:  37%|###7      | 95/256 [02:21<03:54,  1.46s/it]Extracting embeddings:  38%|###7      | 96/256 [02:22<03:53,  1.46s/it]Extracting embeddings:  38%|###7      | 97/256 [02:24<03:52,  1.46s/it]Extracting embeddings:  38%|###8      | 98/256 [02:25<03:50,  1.46s/it]Extracting embeddings:  39%|###8      | 99/256 [02:26<03:49,  1.46s/it]Extracting embeddings:  39%|###9      | 100/256 [02:28<03:47,  1.46s/it]Extracting embeddings:  39%|###9      | 101/256 [02:29<03:46,  1.46s/it]Extracting embeddings:  40%|###9      | 102/256 [02:31<03:44,  1.46s/it]Extracting embeddings:  40%|####      | 103/256 [02:32<03:43,  1.46s/it]Extracting embeddings:  41%|####      | 104/256 [02:34<03:41,  1.46s/it]Extracting embeddings:  41%|####1     | 105/256 [02:35<03:40,  1.46s/it]Extracting embeddings:  41%|####1     | 106/256 [02:37<03:44,  1.50s/it]Extracting embeddings:  42%|####1     | 107/256 [02:38<03:41,  1.49s/it]Extracting embeddings:  42%|####2     | 108/256 [02:40<03:39,  1.48s/it]Extracting embeddings:  43%|####2     | 109/256 [02:41<03:36,  1.47s/it]Extracting embeddings:  43%|####2     | 110/256 [02:43<03:34,  1.47s/it]Extracting embeddings:  43%|####3     | 111/256 [02:44<03:32,  1.47s/it]Extracting embeddings:  44%|####3     | 112/256 [02:46<03:30,  1.46s/it]Extracting embeddings:  44%|####4     | 113/256 [02:47<03:29,  1.46s/it]Extracting embeddings:  45%|####4     | 114/256 [02:48<03:27,  1.46s/it]Extracting embeddings:  45%|####4     | 115/256 [02:50<03:25,  1.46s/it]Extracting embeddings:  45%|####5     | 116/256 [02:51<03:24,  1.46s/it]Extracting embeddings:  46%|####5     | 117/256 [02:53<03:22,  1.46s/it]Extracting embeddings:  46%|####6     | 118/256 [02:54<03:21,  1.46s/it]Extracting embeddings:  46%|####6     | 119/256 [02:56<03:19,  1.46s/it]Extracting embeddings:  47%|####6     | 120/256 [02:57<03:18,  1.46s/it]Extracting embeddings:  47%|####7     | 121/256 [02:59<03:16,  1.46s/it]Extracting embeddings:  48%|####7     | 122/256 [03:00<03:15,  1.46s/it]Extracting embeddings:  48%|####8     | 123/256 [03:02<03:13,  1.46s/it]Extracting embeddings:  48%|####8     | 124/256 [03:03<03:12,  1.46s/it]Extracting embeddings:  49%|####8     | 125/256 [03:04<03:10,  1.46s/it]Extracting embeddings:  49%|####9     | 126/256 [03:06<03:09,  1.46s/it]Extracting embeddings:  50%|####9     | 127/256 [03:07<03:08,  1.46s/it]Extracting embeddings:  50%|#####     | 128/256 [03:09<03:06,  1.46s/it]Extracting embeddings:  50%|#####     | 129/256 [03:10<03:10,  1.50s/it]Extracting embeddings:  51%|#####     | 130/256 [03:12<03:07,  1.49s/it]Extracting embeddings:  51%|#####1    | 131/256 [03:13<03:04,  1.48s/it]Extracting embeddings:  52%|#####1    | 132/256 [03:15<03:02,  1.47s/it]Extracting embeddings:  52%|#####1    | 133/256 [03:16<03:00,  1.47s/it]Extracting embeddings:  52%|#####2    | 134/256 [03:18<02:58,  1.46s/it]Extracting embeddings:  53%|#####2    | 135/256 [03:19<02:56,  1.46s/it]Extracting embeddings:  53%|#####3    | 136/256 [03:21<02:55,  1.46s/it]Extracting embeddings:  54%|#####3    | 137/256 [03:22<02:53,  1.46s/it]Extracting embeddings:  54%|#####3    | 138/256 [03:24<02:52,  1.46s/it]Extracting embeddings:  54%|#####4    | 139/256 [03:25<02:50,  1.46s/it]Extracting embeddings:  55%|#####4    | 140/256 [03:26<02:49,  1.46s/it]Extracting embeddings:  55%|#####5    | 141/256 [03:28<02:47,  1.46s/it]Extracting embeddings:  55%|#####5    | 142/256 [03:29<02:46,  1.46s/it]Extracting embeddings:  56%|#####5    | 143/256 [03:31<02:44,  1.46s/it]Extracting embeddings:  56%|#####6    | 144/256 [03:32<02:43,  1.46s/it]Extracting embeddings:  57%|#####6    | 145/256 [03:34<02:41,  1.46s/it]Extracting embeddings:  57%|#####7    | 146/256 [03:35<02:40,  1.46s/it]Extracting embeddings:  57%|#####7    | 147/256 [03:37<02:38,  1.45s/it]Extracting embeddings:  58%|#####7    | 148/256 [03:38<02:37,  1.45s/it]Extracting embeddings:  58%|#####8    | 149/256 [03:40<02:35,  1.46s/it]Extracting embeddings:  59%|#####8    | 150/256 [03:41<02:34,  1.46s/it]Extracting embeddings:  59%|#####8    | 151/256 [03:42<02:32,  1.46s/it]Extracting embeddings:  59%|#####9    | 152/256 [03:44<02:35,  1.50s/it]Extracting embeddings:  60%|#####9    | 153/256 [03:46<02:32,  1.49s/it]Extracting embeddings:  60%|######    | 154/256 [03:47<02:30,  1.48s/it]Extracting embeddings:  61%|######    | 155/256 [03:48<02:28,  1.47s/it]Extracting embeddings:  61%|######    | 156/256 [03:50<02:26,  1.47s/it]Extracting embeddings:  61%|######1   | 157/256 [03:51<02:24,  1.46s/it]Extracting embeddings:  62%|######1   | 158/256 [03:53<02:23,  1.46s/it]Extracting embeddings:  62%|######2   | 159/256 [03:54<02:21,  1.46s/it]Extracting embeddings:  62%|######2   | 160/256 [03:56<02:19,  1.46s/it]Extracting embeddings:  63%|######2   | 161/256 [03:57<02:18,  1.46s/it]Extracting embeddings:  63%|######3   | 162/256 [03:59<02:16,  1.46s/it]Extracting embeddings:  64%|######3   | 163/256 [04:00<02:15,  1.46s/it]Extracting embeddings:  64%|######4   | 164/256 [04:02<02:14,  1.46s/it]Extracting embeddings:  64%|######4   | 165/256 [04:03<02:12,  1.46s/it]Extracting embeddings:  65%|######4   | 166/256 [04:04<02:11,  1.46s/it]Extracting embeddings:  65%|######5   | 167/256 [04:06<02:09,  1.46s/it]Extracting embeddings:  66%|######5   | 168/256 [04:07<02:08,  1.46s/it]Extracting embeddings:  66%|######6   | 169/256 [04:09<02:06,  1.46s/it]Extracting embeddings:  66%|######6   | 170/256 [04:10<02:05,  1.46s/it]Extracting embeddings:  67%|######6   | 171/256 [04:12<02:03,  1.46s/it]Extracting embeddings:  67%|######7   | 172/256 [04:13<02:02,  1.46s/it]Extracting embeddings:  68%|######7   | 173/256 [04:15<02:00,  1.46s/it]Extracting embeddings:  68%|######7   | 174/256 [04:16<01:59,  1.46s/it]Extracting embeddings:  68%|######8   | 175/256 [04:18<02:01,  1.50s/it]Extracting embeddings:  69%|######8   | 176/256 [04:19<01:59,  1.49s/it]Extracting embeddings:  69%|######9   | 177/256 [04:21<01:56,  1.48s/it]Extracting embeddings:  70%|######9   | 178/256 [04:22<01:54,  1.47s/it]Extracting embeddings:  70%|######9   | 179/256 [04:24<01:53,  1.47s/it]Extracting embeddings:  70%|#######   | 180/256 [04:25<01:51,  1.47s/it]Extracting embeddings:  71%|#######   | 181/256 [04:26<01:49,  1.46s/it]Extracting embeddings:  71%|#######1  | 182/256 [04:28<01:48,  1.46s/it]Extracting embeddings:  71%|#######1  | 183/256 [04:29<01:46,  1.46s/it]Extracting embeddings:  72%|#######1  | 184/256 [04:31<01:45,  1.46s/it]Extracting embeddings:  72%|#######2  | 185/256 [04:32<01:43,  1.46s/it]Extracting embeddings:  73%|#######2  | 186/256 [04:34<01:42,  1.46s/it]Extracting embeddings:  73%|#######3  | 187/256 [04:35<01:40,  1.46s/it]Extracting embeddings:  73%|#######3  | 188/256 [04:37<01:39,  1.46s/it]Extracting embeddings:  74%|#######3  | 189/256 [04:38<01:37,  1.46s/it]Extracting embeddings:  74%|#######4  | 190/256 [04:40<01:36,  1.46s/it]Extracting embeddings:  75%|#######4  | 191/256 [04:41<01:34,  1.46s/it]Extracting embeddings:  75%|#######5  | 192/256 [04:43<01:33,  1.46s/it]Extracting embeddings:  75%|#######5  | 193/256 [04:44<01:31,  1.46s/it]Extracting embeddings:  76%|#######5  | 194/256 [04:45<01:30,  1.46s/it]Extracting embeddings:  76%|#######6  | 195/256 [04:47<01:28,  1.46s/it]Extracting embeddings:  77%|#######6  | 196/256 [04:48<01:27,  1.46s/it]Extracting embeddings:  77%|#######6  | 197/256 [04:50<01:26,  1.46s/it]Extracting embeddings:  77%|#######7  | 198/256 [04:51<01:24,  1.46s/it]Extracting embeddings:  78%|#######7  | 199/256 [04:53<01:23,  1.46s/it]Extracting embeddings:  78%|#######8  | 200/256 [04:54<01:23,  1.50s/it]Extracting embeddings:  79%|#######8  | 201/256 [04:56<01:21,  1.49s/it]Extracting embeddings:  79%|#######8  | 202/256 [04:57<01:19,  1.48s/it]Extracting embeddings:  79%|#######9  | 203/256 [04:59<01:18,  1.47s/it]Extracting embeddings:  80%|#######9  | 204/256 [05:00<01:16,  1.47s/it]Extracting embeddings:  80%|########  | 205/256 [05:02<01:14,  1.46s/it]Extracting embeddings:  80%|########  | 206/256 [05:03<01:13,  1.46s/it]Extracting embeddings:  81%|########  | 207/256 [05:05<01:11,  1.46s/it]Extracting embeddings:  81%|########1 | 208/256 [05:06<01:10,  1.46s/it]Extracting embeddings:  82%|########1 | 209/256 [05:07<01:08,  1.46s/it]Extracting embeddings:  82%|########2 | 210/256 [05:09<01:07,  1.46s/it]Extracting embeddings:  82%|########2 | 211/256 [05:10<01:05,  1.46s/it]Extracting embeddings:  83%|########2 | 212/256 [05:12<01:04,  1.46s/it]Extracting embeddings:  83%|########3 | 213/256 [05:13<01:02,  1.46s/it]Extracting embeddings:  84%|########3 | 214/256 [05:15<01:01,  1.46s/it]Extracting embeddings:  84%|########3 | 215/256 [05:16<00:59,  1.46s/it]Extracting embeddings:  84%|########4 | 216/256 [05:18<00:58,  1.46s/it]Extracting embeddings:  85%|########4 | 217/256 [05:19<00:56,  1.46s/it]Extracting embeddings:  85%|########5 | 218/256 [05:21<00:55,  1.46s/it]Extracting embeddings:  86%|########5 | 219/256 [05:22<00:53,  1.46s/it]Extracting embeddings:  86%|########5 | 220/256 [05:23<00:52,  1.46s/it]Extracting embeddings:  86%|########6 | 221/256 [05:25<00:51,  1.46s/it]Extracting embeddings:  87%|########6 | 222/256 [05:26<00:49,  1.46s/it]Extracting embeddings:  87%|########7 | 223/256 [05:28<00:49,  1.50s/it]Extracting embeddings:  88%|########7 | 224/256 [05:29<00:47,  1.48s/it]Extracting embeddings:  88%|########7 | 225/256 [05:31<00:45,  1.48s/it]Extracting embeddings:  88%|########8 | 226/256 [05:32<00:44,  1.47s/it]Extracting embeddings:  89%|########8 | 227/256 [05:34<00:42,  1.47s/it]Extracting embeddings:  89%|########9 | 228/256 [05:35<00:40,  1.46s/it]Extracting embeddings:  89%|########9 | 229/256 [05:37<00:39,  1.46s/it]Extracting embeddings:  90%|########9 | 230/256 [05:38<00:37,  1.46s/it]Extracting embeddings:  90%|######### | 231/256 [05:40<00:36,  1.46s/it]Extracting embeddings:  91%|######### | 232/256 [05:41<00:34,  1.46s/it]Extracting embeddings:  91%|#########1| 233/256 [05:43<00:33,  1.46s/it]Extracting embeddings:  91%|#########1| 234/256 [05:44<00:32,  1.46s/it]Extracting embeddings:  92%|#########1| 235/256 [05:45<00:30,  1.46s/it]Extracting embeddings:  92%|#########2| 236/256 [05:47<00:29,  1.46s/it]Extracting embeddings:  93%|#########2| 237/256 [05:48<00:27,  1.46s/it]Extracting embeddings:  93%|#########2| 238/256 [05:50<00:26,  1.46s/it]Extracting embeddings:  93%|#########3| 239/256 [05:51<00:24,  1.46s/it]Extracting embeddings:  94%|#########3| 240/256 [05:53<00:23,  1.46s/it]Extracting embeddings:  94%|#########4| 241/256 [05:54<00:21,  1.46s/it]Extracting embeddings:  95%|#########4| 242/256 [05:56<00:20,  1.46s/it]Extracting embeddings:  95%|#########4| 243/256 [05:57<00:18,  1.46s/it]Extracting embeddings:  95%|#########5| 244/256 [05:59<00:17,  1.50s/it]Extracting embeddings:  96%|#########5| 245/256 [06:00<00:16,  1.49s/it]Extracting embeddings:  96%|#########6| 246/256 [06:02<00:14,  1.48s/it]Extracting embeddings:  96%|#########6| 247/256 [06:03<00:13,  1.47s/it]Extracting embeddings:  97%|#########6| 248/256 [06:05<00:11,  1.47s/it]Extracting embeddings:  97%|#########7| 249/256 [06:06<00:10,  1.46s/it]Extracting embeddings:  98%|#########7| 250/256 [06:07<00:08,  1.46s/it]Extracting embeddings:  98%|#########8| 251/256 [06:09<00:07,  1.46s/it]Extracting embeddings:  98%|#########8| 252/256 [06:10<00:05,  1.46s/it]Extracting embeddings:  99%|#########8| 253/256 [06:12<00:04,  1.46s/it]Extracting embeddings:  99%|#########9| 254/256 [06:13<00:02,  1.46s/it]Extracting embeddings: 100%|#########9| 255/256 [06:15<00:01,  1.46s/it]Extracting embeddings: 100%|##########| 256/256 [06:16<00:00,  1.46s/it]Extracting embeddings: 100%|##########| 256/256 [06:16<00:00,  1.47s/it]
  Embedding matrix shape: (262144, 1024)

Computing PCA for n_samples=16384...
  Computed 1024 eigenvalues
  Top 10 eigenvalues: [0.4046432  0.04865691 0.04403201 0.03522133 0.02640803 0.01952652
 0.01753575 0.01242025 0.0120052  0.00924321]
  Variance explained by top 10: 77.50%

Computing PCA for n_samples=65536...
  Computed 1024 eigenvalues
  Top 10 eigenvalues: [0.40040556 0.05065943 0.04638342 0.03419816 0.02666385 0.01975472
 0.01758596 0.01251317 0.01235636 0.00931634]
  Variance explained by top 10: 77.43%

Computing PCA for n_samples=262144...
  Computed 1024 eigenvalues
  Top 10 eigenvalues: [0.40270576 0.05050071 0.04582359 0.0345512  0.02676789 0.01966112
 0.01758999 0.01255984 0.0121532  0.00941912]
  Variance explained by top 10: 77.48%

Fitting full PCA for classification (n=262144)...

Loading membership data from split 'validation' (no species filter)...
Loading dataset from HuggingFace (path=eczech/gpn-animal-promoter-dataset, revision=f009db443a914d4113922e3028de0666b85c24d6, split=validation)...
Dataset size: 8,792 records

Preparing sequences (cropping to 512 bp and filtering empty)...
  Records before filtering: 8,792
  Records after filtering: 8,792
  Empty sequences filtered: 0
Sampling 8192 records...
Extracting records...
  Unique species: 5
Loading GLM-Experiments Lightning checkpoint from gonzalobenegas/dev-glm-experiments-logs...
  Downloading checkpoint from HuggingFace...
  Downloading config from HuggingFace...
  Loading config...
  Replacing scheduler/optimizer with dummies for inference...
  Instantiating model from config...
  Loading checkpoint weights...
/work/10459/eczech/vista/repos/plantcad-spectral-analysis/scripts/decompose.py:544: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(checkpoint_path, map_location="cpu")
  Hidden size: 1024
  Parameters: 298,908,672 (298.9M)
  Device: cuda, Dtype: torch.bfloat16
  Loading tokenizer from gonzalobenegas/tokenizer-dna-mlm...
  Tokenizer vocab size: 7
Extracting embeddings:   0%|          | 0/8 [00:00<?, ?it/s]Extracting embeddings:  12%|#2        | 1/8 [00:01<00:10,  1.46s/it]Extracting embeddings:  25%|##5       | 2/8 [00:02<00:08,  1.46s/it]Extracting embeddings:  38%|###7      | 3/8 [00:04<00:07,  1.46s/it]Extracting embeddings:  50%|#####     | 4/8 [00:05<00:05,  1.46s/it]Extracting embeddings:  62%|######2   | 5/8 [00:07<00:04,  1.45s/it]Extracting embeddings:  75%|#######5  | 6/8 [00:08<00:02,  1.45s/it]Extracting embeddings:  88%|########7 | 7/8 [00:10<00:01,  1.45s/it]Extracting embeddings: 100%|##########| 8/8 [00:11<00:00,  1.50s/it]Extracting embeddings: 100%|##########| 8/8 [00:11<00:00,  1.47s/it]
  Embedding matrix shape: (8192, 1024)

Saving checkpoint to: results/sep/v39/eigenspectrum_sglmexp_l512_n16384_65536_262144_pmean.pkl

For n=262144:
  Components needed for 90% variance: 44
  Components needed for 95% variance: 102
  Effective sample size: 3.90456843
  Condition number: 7.79680513e+14

Figure saved to: results/sep/v39/eigenspectrum_sglmexp_n262144_l512_pmean.png
PDF saved to: results/sep/v39/eigenspectrum_sglmexp_n262144_l512_pmean.pdf
Eigenvalue data exported to: results/sep/v39/eigenspectrum_sglmexp_n262144_l512_pmean.csv

======================================================================
PC SCALING ANALYSIS
Testing n_components: [0, 1, 2, 3, 4, 8, 16, 32, 64, 128, 256, 512, 1024]
======================================================================
Extracting sequence features:   0%|          | 0/262144 [00:00<?, ?it/s]Extracting sequence features:   2%|1         | 4088/262144 [00:00<00:06, 40842.35it/s]Extracting sequence features:   3%|3         | 8173/262144 [00:00<00:06, 39920.58it/s]Extracting sequence features:   5%|4         | 12167/262144 [00:00<00:06, 39817.22it/s]Extracting sequence features:   6%|6         | 16150/262144 [00:00<00:06, 39659.12it/s]Extracting sequence features:   8%|7         | 20139/262144 [00:00<00:06, 39740.59it/s]Extracting sequence features:   9%|9         | 24124/262144 [00:00<00:05, 39761.69it/s]Extracting sequence features:  11%|#         | 28129/262144 [00:00<00:05, 39797.37it/s]Extracting sequence features:  12%|#2        | 32109/262144 [00:00<00:05, 39718.63it/s]Extracting sequence features:  14%|#3        | 36100/262144 [00:00<00:05, 39762.35it/s]Extracting sequence features:  15%|#5        | 40077/262144 [00:01<00:05, 39742.55it/s]Extracting sequence features:  17%|#6        | 44067/262144 [00:01<00:05, 39654.91it/s]Extracting sequence features:  18%|#8        | 48036/262144 [00:01<00:05, 39660.40it/s]Extracting sequence features:  20%|#9        | 52023/262144 [00:01<00:05, 39723.35it/s]Extracting sequence features:  21%|##1       | 56026/262144 [00:01<00:05, 39812.21it/s]Extracting sequence features:  23%|##2       | 60009/262144 [00:01<00:05, 39810.78it/s]Extracting sequence features:  24%|##4       | 63991/262144 [00:01<00:04, 39649.26it/s]Extracting sequence features:  26%|##5       | 67983/262144 [00:01<00:04, 39730.01it/s]Extracting sequence features:  27%|##7       | 71960/262144 [00:01<00:04, 39722.82it/s]Extracting sequence features:  29%|##8       | 75977/262144 [00:01<00:04, 39852.95it/s]Extracting sequence features:  31%|###       | 79963/262144 [00:02<00:04, 39767.11it/s]Extracting sequence features:  32%|###2      | 83940/262144 [00:02<00:04, 39749.91it/s]Extracting sequence features:  34%|###3      | 87916/262144 [00:02<00:04, 39716.03it/s]Extracting sequence features:  35%|###5      | 91888/262144 [00:02<00:04, 39644.77it/s]Extracting sequence features:  37%|###6      | 95853/262144 [00:02<00:04, 39571.31it/s]Extracting sequence features:  38%|###8      | 99836/262144 [00:02<00:04, 39647.98it/s]Extracting sequence features:  40%|###9      | 103801/262144 [00:02<00:04, 39584.21it/s]Extracting sequence features:  41%|####1     | 107787/262144 [00:02<00:03, 39661.87it/s]Extracting sequence features:  43%|####2     | 111754/262144 [00:02<00:03, 39618.19it/s]Extracting sequence features:  44%|####4     | 115774/262144 [00:02<00:03, 39792.08it/s]Extracting sequence features:  46%|####5     | 119754/262144 [00:03<00:03, 39746.35it/s]Extracting sequence features:  47%|####7     | 123729/262144 [00:03<00:03, 39738.40it/s]Extracting sequence features:  49%|####8     | 127710/262144 [00:03<00:03, 39752.14it/s]Extracting sequence features:  50%|#####     | 131688/262144 [00:03<00:03, 39682.79it/s]Extracting sequence features:  52%|#####1    | 135689/262144 [00:03<00:03, 39780.04it/s]Extracting sequence features:  53%|#####3    | 139699/262144 [00:03<00:03, 39870.37it/s]Extracting sequence features:  55%|#####4    | 143687/262144 [00:03<00:02, 39850.23it/s]Extracting sequence features:  56%|#####6    | 147675/262144 [00:03<00:02, 39846.07it/s]Extracting sequence features:  58%|#####7    | 151660/262144 [00:03<00:02, 39785.55it/s]Extracting sequence features:  59%|#####9    | 155639/262144 [00:03<00:02, 39732.68it/s]Extracting sequence features:  61%|######    | 159613/262144 [00:04<00:02, 39694.23it/s]Extracting sequence features:  62%|######2   | 163614/262144 [00:04<00:02, 39785.29it/s]Extracting sequence features:  64%|######3   | 167595/262144 [00:04<00:02, 39791.63it/s]Extracting sequence features:  65%|######5   | 171575/262144 [00:04<00:02, 39746.39it/s]Extracting sequence features:  67%|######6   | 175550/262144 [00:04<00:02, 39735.73it/s]Extracting sequence features:  68%|######8   | 179535/262144 [00:04<00:02, 39686.27it/s]Extracting sequence features:  70%|#######   | 183533/262144 [00:04<00:01, 39771.83it/s]Extracting sequence features:  72%|#######1  | 187511/262144 [00:04<00:01, 39740.66it/s]Extracting sequence features:  73%|#######3  | 191510/262144 [00:04<00:01, 39811.02it/s]Extracting sequence features:  75%|#######4  | 195492/262144 [00:04<00:01, 39775.20it/s]Extracting sequence features:  76%|#######6  | 199490/262144 [00:05<00:01, 39770.15it/s]Extracting sequence features:  78%|#######7  | 203472/262144 [00:05<00:01, 39781.25it/s]Extracting sequence features:  79%|#######9  | 207451/262144 [00:05<00:01, 39735.79it/s]Extracting sequence features:  81%|########  | 211452/262144 [00:05<00:01, 39810.25it/s]Extracting sequence features:  82%|########2 | 215440/262144 [00:05<00:01, 39826.66it/s]Extracting sequence features:  84%|########3 | 219437/262144 [00:05<00:01, 39802.40it/s]Extracting sequence features:  85%|########5 | 223436/262144 [00:05<00:00, 39846.46it/s]Extracting sequence features:  87%|########6 | 227421/262144 [00:05<00:00, 39726.74it/s]Extracting sequence features:  88%|########8 | 231412/262144 [00:05<00:00, 39773.61it/s]Extracting sequence features:  90%|########9 | 235390/262144 [00:05<00:00, 39726.81it/s]Extracting sequence features:  91%|#########1| 239382/262144 [00:06<00:00, 39759.75it/s]Extracting sequence features:  93%|#########2| 243392/262144 [00:06<00:00, 39853.50it/s]Extracting sequence features:  94%|#########4| 247400/262144 [00:06<00:00, 39907.04it/s]Extracting sequence features:  96%|#########5| 251391/262144 [00:06<00:00, 39813.93it/s]Extracting sequence features:  97%|#########7| 255401/262144 [00:06<00:00, 39798.35it/s]Extracting sequence features:  99%|#########8| 259421/262144 [00:06<00:00, 39914.81it/s]Extracting sequence features: 100%|##########| 262144/262144 [00:06<00:00, 39766.34it/s]

  Membership task: 262144 train + 8192 membership -> 8192 each (balanced)
[membership[n_comp=0]] 2 classes, 16384 samples
  Classes: membership, train
  membership           Performance by n_components:
    Accuracy:  0.500 0.589 0.579 0.584 0.656 0.728 0.739 0.783 0.803 0.807 0.812 0.814 0.814
    F1:        0.333 0.575 0.569 0.573 0.649 0.728 0.739 0.782 0.802 0.805 0.810 0.812 0.813
    ROC AUC:   0.490 0.608 0.612 0.610 0.743 0.772 0.792 0.842 0.862 0.870 0.874 0.875 0.875
    AUPRC:     0.493 0.610 0.618 0.619 0.713 0.729 0.742 0.795 0.823 0.835 0.839 0.840 0.840
[species[n_comp=0]] 65 classes, 262144 samples
  Classes: Acipenser ruthenus, Acropora millepora, Anguilla rostrata, Astatotilapia calliptera, Astyanax mexicanus, Biomphalaria glabrata, Brienomyrus brachyistius, Bubalus bubalis, Callithrix jacchus, Carassius gibelio, ... (+55 more)
  species              Performance by n_components:
    Accuracy:  0.021 0.050 0.056 0.067 0.079 0.112 0.143 0.166 0.178 0.181 0.182 0.180 0.175
    F1:        0.006 0.031 0.040 0.053 0.066 0.098 0.130 0.151 0.165 0.166 0.168 0.166 0.161
    ROC AUC:   0.499 0.700 0.687 0.755 0.782 0.842 0.869 0.877 0.881 0.880 0.881 0.878 0.876
    AUPRC:     0.015 0.036 0.039 0.050 0.060 0.084 0.112 0.131 0.143 0.143 0.147 0.144 0.141
[gc_content[n_comp=0]] 5 classes, 262144 samples
  Classes: 0.141-0.369, 0.369-0.412, 0.412-0.455, 0.455-0.543, 0.543-0.998
  gc_content           Performance by n_components:
    Accuracy:  0.202 0.753 0.755 0.764 0.767 0.784 0.812 0.846 0.865 0.867 0.867 0.868 0.867
    F1:        0.190 0.754 0.756 0.765 0.768 0.784 0.813 0.846 0.866 0.867 0.868 0.868 0.867
    ROC AUC:   0.501 0.945 0.947 0.950 0.952 0.957 0.966 0.976 0.981 0.982 0.981 0.981 0.981
    AUPRC:     0.201 0.787 0.798 0.806 0.813 0.829 0.863 0.900 0.919 0.920 0.919 0.919 0.918
[repeat_fraction[n_comp=0]] 5 classes, 262144 samples
  Classes: 0.000-0.049, 0.049-0.113, 0.113-0.182, 0.182-0.291, 0.291-1.000
  repeat_fraction      Performance by n_components:
    Accuracy:  0.203 0.266 0.314 0.347 0.356 0.380 0.405 0.431 0.444 0.445 0.446 0.443 0.444
    F1:        0.190 0.262 0.305 0.339 0.349 0.370 0.399 0.425 0.439 0.441 0.441 0.438 0.438
    ROC AUC:   0.502 0.599 0.649 0.685 0.695 0.717 0.746 0.766 0.776 0.777 0.777 0.776 0.776
    AUPRC:     0.201 0.268 0.314 0.345 0.360 0.387 0.424 0.449 0.463 0.463 0.463 0.463 0.463
[kmer_entropy_1[n_comp=0]] 5 classes, 262144 samples
  Classes: 0.020-1.916, 1.916-1.951, 1.951-1.970, 1.970-1.985, 1.985-2.000
  kmer_entropy_1       Performance by n_components:
    Accuracy:  0.198 0.567 0.581 0.611 0.617 0.652 0.677 0.708 0.717 0.718 0.717 0.716 0.715
    F1:        0.197 0.565 0.578 0.609 0.616 0.651 0.676 0.708 0.717 0.717 0.716 0.716 0.714
    ROC AUC:   0.497 0.850 0.867 0.885 0.888 0.907 0.918 0.931 0.935 0.935 0.934 0.934 0.933
    AUPRC:     0.199 0.563 0.598 0.633 0.640 0.681 0.710 0.747 0.760 0.761 0.759 0.757 0.756
[kmer_entropy_3[n_comp=0]] 5 classes, 262144 samples
  Classes: 0.061-5.570, 5.570-5.675, 5.675-5.740, 5.740-5.799, 5.799-5.949
  kmer_entropy_3       Performance by n_components:
    Accuracy:  0.200 0.432 0.503 0.528 0.533 0.591 0.615 0.639 0.653 0.653 0.654 0.653 0.653
    F1:        0.200 0.425 0.496 0.521 0.527 0.589 0.613 0.638 0.651 0.652 0.652 0.652 0.651
    ROC AUC:   0.503 0.751 0.812 0.832 0.837 0.875 0.886 0.900 0.906 0.906 0.906 0.906 0.905
    AUPRC:     0.201 0.431 0.508 0.542 0.554 0.618 0.639 0.669 0.685 0.685 0.684 0.683 0.684
[kmer_entropy_9[n_comp=0]] 4 classes, 262144 samples
  Classes: 0.186-8.926, 8.926-8.961, 8.961-8.969, 8.969-8.977
  kmer_entropy_9       Performance by n_components:
    Accuracy:  0.448 0.478 0.545 0.598 0.604 0.611 0.647 0.652 0.652 0.653 0.653 0.653 0.652
    F1:        0.155 0.245 0.360 0.431 0.438 0.448 0.495 0.502 0.502 0.502 0.502 0.501 0.499
    ROC AUC:   0.499 0.592 0.695 0.757 0.765 0.773 0.805 0.811 0.812 0.815 0.815 0.815 0.814
    AUPRC:     0.250 0.330 0.444 0.515 0.527 0.535 0.573 0.582 0.584 0.589 0.589 0.588 0.587
[dinuc_CG[n_comp=0]] 5 classes, 262144 samples
  Classes: 0.000-0.014, 0.014-0.025, 0.025-0.037, 0.037-0.055, 0.055-0.235
  dinuc_CG             Performance by n_components:
    Accuracy:  0.203 0.395 0.452 0.472 0.497 0.672 0.681 0.694 0.715 0.719 0.721 0.722 0.722
    F1:        0.182 0.356 0.443 0.468 0.494 0.675 0.684 0.697 0.717 0.721 0.723 0.724 0.724
    ROC AUC:   0.501 0.720 0.763 0.783 0.805 0.916 0.920 0.926 0.935 0.937 0.937 0.937 0.937
    AUPRC:     0.200 0.406 0.468 0.497 0.534 0.712 0.721 0.737 0.762 0.768 0.772 0.771 0.772
[dinuc_GC[n_comp=0]] 5 classes, 262144 samples
  Classes: 0.000-0.033, 0.033-0.043, 0.043-0.055, 0.055-0.074, 0.074-0.249
  dinuc_GC             Performance by n_components:
    Accuracy:  0.212 0.552 0.564 0.569 0.569 0.578 0.595 0.635 0.664 0.671 0.674 0.674 0.673
    F1:        0.147 0.554 0.565 0.570 0.571 0.580 0.596 0.637 0.666 0.673 0.676 0.676 0.675
    ROC AUC:   0.501 0.846 0.855 0.858 0.859 0.865 0.874 0.895 0.910 0.912 0.914 0.914 0.913
    AUPRC:     0.201 0.568 0.584 0.589 0.592 0.603 0.619 0.662 0.694 0.700 0.704 0.703 0.702
[dinuc_AT[n_comp=0]] 5 classes, 262144 samples
  Classes: 0.000-0.037, 0.037-0.061, 0.061-0.074, 0.074-0.090, 0.090-0.282
  dinuc_AT             Performance by n_components:
    Accuracy:  0.216 0.617 0.620 0.623 0.628 0.639 0.649 0.684 0.714 0.723 0.727 0.725 0.724
    F1:        0.141 0.613 0.615 0.618 0.623 0.635 0.644 0.680 0.711 0.720 0.724 0.722 0.720
    ROC AUC:   0.504 0.883 0.886 0.888 0.889 0.896 0.902 0.918 0.932 0.935 0.936 0.936 0.935
    AUPRC:     0.201 0.634 0.643 0.648 0.652 0.666 0.678 0.713 0.747 0.756 0.758 0.757 0.755
[dinuc_TA[n_comp=0]] 5 classes, 262144 samples
  Classes: 0.000-0.029, 0.029-0.051, 0.051-0.065, 0.065-0.080, 0.080-0.331
  dinuc_TA             Performance by n_components:
    Accuracy:  0.216 0.591 0.597 0.610 0.614 0.646 0.671 0.715 0.731 0.739 0.738 0.739 0.737
    F1:        0.143 0.589 0.594 0.606 0.610 0.642 0.668 0.712 0.728 0.736 0.735 0.736 0.734
    ROC AUC:   0.501 0.872 0.876 0.882 0.885 0.902 0.914 0.933 0.940 0.942 0.942 0.942 0.942
    AUPRC:     0.201 0.611 0.624 0.637 0.642 0.678 0.701 0.751 0.770 0.777 0.776 0.776 0.776
[dinuc_AA[n_comp=0]] 5 classes, 262144 samples
  Classes: 0.000-0.051, 0.051-0.076, 0.076-0.096, 0.096-0.115, 0.115-0.346
  dinuc_AA             Performance by n_components:
    Accuracy:  0.208 0.467 0.487 0.493 0.497 0.571 0.591 0.628 0.649 0.667 0.669 0.668 0.666
    F1:        0.176 0.460 0.478 0.482 0.486 0.567 0.587 0.628 0.649 0.667 0.668 0.667 0.666
    ROC AUC:   0.501 0.783 0.801 0.807 0.810 0.860 0.873 0.895 0.904 0.912 0.913 0.913 0.912
    AUPRC:     0.200 0.471 0.499 0.508 0.513 0.597 0.619 0.662 0.680 0.700 0.701 0.701 0.699
[dinuc_TT[n_comp=0]] 5 classes, 262144 samples
  Classes: 0.000-0.051, 0.051-0.076, 0.076-0.094, 0.094-0.115, 0.115-0.732
  dinuc_TT             Performance by n_components:
    Accuracy:  0.206 0.468 0.482 0.489 0.498 0.572 0.601 0.634 0.647 0.661 0.663 0.663 0.663
    F1:        0.171 0.463 0.473 0.480 0.490 0.567 0.596 0.630 0.644 0.657 0.658 0.659 0.659
    ROC AUC:   0.503 0.786 0.799 0.805 0.812 0.862 0.878 0.897 0.903 0.909 0.910 0.910 0.909
    AUPRC:     0.201 0.474 0.495 0.506 0.521 0.600 0.630 0.667 0.680 0.693 0.696 0.695 0.694

PC scaling curves saved to: results/sep/v39/pc_scaling_curves.png
PC scaling curves PDF saved to: results/sep/v39/pc_scaling_curves.pdf
PC scaling data exported to: results/sep/v39/pc_scaling_curves.csv

======================================================================
SUMMARY: F1 by n_components
======================================================================
Target                     0       1       2       3       4       8      16      32      64     128     256     512    1024
----------------------------------------------------------------------------------------------------------------------------
dinuc_AA               0.176   0.460   0.478   0.482   0.486   0.567   0.587   0.628   0.649   0.667   0.668   0.667   0.666
dinuc_AT               0.141   0.613   0.615   0.618   0.623   0.635   0.644   0.680   0.711   0.720   0.724   0.722   0.720
dinuc_CG               0.182   0.356   0.443   0.468   0.494   0.675   0.684   0.697   0.717   0.721   0.723   0.724   0.724
dinuc_GC               0.147   0.554   0.565   0.570   0.571   0.580   0.596   0.637   0.666   0.673   0.676   0.676   0.675
dinuc_TA               0.143   0.589   0.594   0.606   0.610   0.642   0.668   0.712   0.728   0.736   0.735   0.736   0.734
dinuc_TT               0.171   0.463   0.473   0.480   0.490   0.567   0.596   0.630   0.644   0.657   0.658   0.659   0.659
gc_content             0.190   0.754   0.756   0.765   0.768   0.784   0.813   0.846   0.866   0.867   0.868   0.868   0.867
kmer_entropy_1         0.197   0.565   0.578   0.609   0.616   0.651   0.676   0.708   0.717   0.717   0.716   0.716   0.714
kmer_entropy_3         0.200   0.425   0.496   0.521   0.527   0.589   0.613   0.638   0.651   0.652   0.652   0.652   0.651
kmer_entropy_9         0.155   0.245   0.360   0.431   0.438   0.448   0.495   0.502   0.502   0.502   0.502   0.501   0.499
membership             0.333   0.575   0.569   0.573   0.649   0.728   0.739   0.782   0.802   0.805   0.810   0.812   0.813
repeat_fraction        0.190   0.262   0.305   0.339   0.349   0.370   0.399   0.425   0.439   0.441   0.441   0.438   0.438
species                0.006   0.031   0.040   0.053   0.066   0.098   0.130   0.151   0.165   0.166   0.168   0.166   0.161

Training species classifier with n_components=1024 PCs...
[Species] 65 classes, 262144 samples
  Classes: Acipenser ruthenus, Acropora millepora, Anguilla rostrata, Astatotilapia calliptera, Astyanax mexicanus, Biomphalaria glabrata, Brienomyrus brachyistius, Bubalus bubalis, Callithrix jacchus, Carassius gibelio, ... (+55 more)

[Species] n_classes=65, acc=0.175, f1=0.161
Confusion matrix saved to: results/sep/v39/eigenspectrum_sglmexp_n262144_l512_pmean_confusion_matrix.png
Confusion matrix PDF saved to: results/sep/v39/eigenspectrum_sglmexp_n262144_l512_pmean_confusion_matrix.pdf
Confusion matrix data exported to: results/sep/v39/eigenspectrum_sglmexp_n262144_l512_pmean_confusion_matrix.csv
Classification metrics exported to: results/sep/v39/eigenspectrum_sglmexp_n262144_l512_pmean_confusion_matrix_metrics.csv

Run completed: 2026-01-03T08:54:30.792779

Done!
