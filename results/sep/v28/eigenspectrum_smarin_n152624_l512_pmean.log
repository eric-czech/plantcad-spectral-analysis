Run started: 2026-01-03T12:32:46.510485
Arguments: Namespace(source='marin', n_samples=[512, 4096, 16384, 65536, 152624], seq_len=512, pooling_method='mean', model_path='plantcad/marin_exp2101__pcv2_pretrain_c4096__checkpoints', model_subfolder='checkpoints/gpn_promoter_pretrain_c512_v0.2', model_revision=None, seed=42, batch_size=512, device='cuda', dtype=torch.bfloat16, output_dir='results/sep/v28', force=True, species_filter=None, species_filter_file='data/filters/gpn_star_extended_species.txt', species_column='organism', split='train', dataset_path='eczech/gpn-animal-promoter-dataset', dataset_config=None, dataset_revision='f009db443a914d4113922e3028de0666b85c24d6', text_column='seq', tokenization_mode='strict', dataset_sample_size=None, dataset_shuffle=False, dataset_dir=None, min_samples_per_class=2, membership_split='validation', membership_n_samples=8192)

============================================================
Eigenspectrum Analysis of DNA Sequences
============================================================
Parameters:
  - Source: marin
  - Sample sizes: [512, 4096, 16384, 65536, 152624]
  - Sequence length: 512 bp
  - Feature dimension: model hidden size
  - Pooling method: mean

Reading species list from: data/filters/gpn_star_extended_species.txt
  Loaded 6 species names (6 unique)
Loading dataset from HuggingFace (path=eczech/gpn-animal-promoter-dataset, revision=f009db443a914d4113922e3028de0666b85c24d6, split=train)...
Dataset size: 9,038,354 records

Filtering data to 6 species:
  Caenorhabditis elegans, Callithrix jacchus, Drosophila melanogaster, Fundulus heteroclitus, Homo sapiens, Mus musculus
  Records before filtering: 9,038,354
  Records after filtering: 152,624

Preparing sequences (cropping to 512 bp and filtering empty)...
  Records before filtering: 152,624
  Records after filtering: 152,624
  Empty sequences filtered: 0
Sampling 152624 records...
Extracting records...
  Unique species: 6
Loading AutoModelForCausalLM from plantcad/marin_exp2101__pcv2_pretrain_c4096__checkpoints subfolder=checkpoints/gpn_promoter_pretrain_c512_v0.2 with dtype=torch.bfloat16...
  Hidden size: 384
  Parameters: 9,450,624 (9.5M)
  Device: cuda, Dtype: torch.bfloat16
  Model:
Qwen2ForCausalLM(
  (model): Qwen2Model(
    (embed_tokens): Embedding(7, 384)
    (layers): ModuleList(
      (0-3): 4 x Qwen2DecoderLayer(
        (self_attn): Qwen2Attention(
          (q_proj): Linear(in_features=384, out_features=384, bias=True)
          (k_proj): Linear(in_features=384, out_features=384, bias=True)
          (v_proj): Linear(in_features=384, out_features=384, bias=True)
          (o_proj): Linear(in_features=384, out_features=384, bias=False)
        )
        (mlp): Qwen2MLP(
          (gate_proj): Linear(in_features=384, out_features=1536, bias=False)
          (up_proj): Linear(in_features=384, out_features=1536, bias=False)
          (down_proj): Linear(in_features=1536, out_features=384, bias=False)
          (act_fn): SiLU()
        )
        (input_layernorm): Qwen2RMSNorm((384,), eps=1e-06)
        (post_attention_layernorm): Qwen2RMSNorm((384,), eps=1e-06)
      )
    )
    (norm): Qwen2RMSNorm((384,), eps=1e-06)
    (rotary_emb): Qwen2RotaryEmbedding()
  )
  (lm_head): Linear(in_features=384, out_features=7, bias=False)
)
Extracting embeddings:   0%|          | 0/299 [00:00<?, ?it/s]Extracting embeddings:   0%|          | 1/299 [00:02<13:32,  2.73s/it]Extracting embeddings:   1%|          | 2/299 [00:02<05:53,  1.19s/it]Extracting embeddings:   1%|1         | 3/299 [00:02<03:27,  1.43it/s]Extracting embeddings:   1%|1         | 4/299 [00:03<02:18,  2.13it/s]Extracting embeddings:   2%|1         | 5/299 [00:03<01:40,  2.92it/s]Extracting embeddings:   2%|2         | 6/299 [00:03<01:17,  3.77it/s]Extracting embeddings:   2%|2         | 7/299 [00:03<01:03,  4.62it/s]Extracting embeddings:   3%|2         | 8/299 [00:03<00:53,  5.42it/s]Extracting embeddings:   3%|3         | 9/299 [00:03<00:47,  6.12it/s]Extracting embeddings:   3%|3         | 10/299 [00:03<00:42,  6.73it/s]Extracting embeddings:   4%|3         | 11/299 [00:03<00:39,  7.20it/s]Extracting embeddings:   4%|4         | 12/299 [00:04<00:37,  7.60it/s]Extracting embeddings:   4%|4         | 13/299 [00:04<00:36,  7.87it/s]Extracting embeddings:   5%|4         | 14/299 [00:04<00:35,  8.10it/s]Extracting embeddings:   5%|5         | 15/299 [00:04<00:34,  8.24it/s]Extracting embeddings:   5%|5         | 16/299 [00:04<00:33,  8.37it/s]Extracting embeddings:   6%|5         | 17/299 [00:04<00:33,  8.43it/s]Extracting embeddings:   6%|6         | 18/299 [00:04<00:33,  8.51it/s]Extracting embeddings:   6%|6         | 19/299 [00:04<00:32,  8.53it/s]Extracting embeddings:   7%|6         | 20/299 [00:04<00:32,  8.57it/s]Extracting embeddings:   7%|7         | 21/299 [00:05<00:32,  8.58it/s]Extracting embeddings:   7%|7         | 22/299 [00:05<00:32,  8.61it/s]Extracting embeddings:   8%|7         | 23/299 [00:05<00:32,  8.61it/s]Extracting embeddings:   8%|8         | 24/299 [00:05<00:31,  8.63it/s]Extracting embeddings:   8%|8         | 25/299 [00:05<00:31,  8.63it/s]Extracting embeddings:   9%|8         | 26/299 [00:05<00:31,  8.65it/s]Extracting embeddings:   9%|9         | 27/299 [00:05<00:31,  8.63it/s]Extracting embeddings:   9%|9         | 28/299 [00:05<00:31,  8.66it/s]Extracting embeddings:  10%|9         | 29/299 [00:05<00:31,  8.64it/s]Extracting embeddings:  10%|#         | 30/299 [00:06<00:31,  8.66it/s]Extracting embeddings:  10%|#         | 31/299 [00:06<00:39,  6.74it/s]Extracting embeddings:  11%|#         | 32/299 [00:06<00:37,  7.19it/s]Extracting embeddings:  11%|#1        | 33/299 [00:06<00:35,  7.56it/s]Extracting embeddings:  11%|#1        | 34/299 [00:06<00:33,  7.87it/s]Extracting embeddings:  12%|#1        | 35/299 [00:06<00:32,  8.07it/s]Extracting embeddings:  12%|#2        | 36/299 [00:06<00:31,  8.25it/s]Extracting embeddings:  12%|#2        | 37/299 [00:07<00:31,  8.35it/s]Extracting embeddings:  13%|#2        | 38/299 [00:07<00:30,  8.45it/s]Extracting embeddings:  13%|#3        | 39/299 [00:07<00:30,  8.49it/s]Extracting embeddings:  13%|#3        | 40/299 [00:07<00:30,  8.55it/s]Extracting embeddings:  14%|#3        | 41/299 [00:07<00:30,  8.57it/s]Extracting embeddings:  14%|#4        | 42/299 [00:07<00:29,  8.61it/s]Extracting embeddings:  14%|#4        | 43/299 [00:07<00:29,  8.61it/s]Extracting embeddings:  15%|#4        | 44/299 [00:07<00:29,  8.64it/s]Extracting embeddings:  15%|#5        | 45/299 [00:07<00:29,  8.63it/s]Extracting embeddings:  15%|#5        | 46/299 [00:08<00:29,  8.66it/s]Extracting embeddings:  16%|#5        | 47/299 [00:08<00:29,  8.64it/s]Extracting embeddings:  16%|#6        | 48/299 [00:08<00:28,  8.67it/s]Extracting embeddings:  16%|#6        | 49/299 [00:08<00:28,  8.66it/s]Extracting embeddings:  17%|#6        | 50/299 [00:08<00:28,  8.68it/s]Extracting embeddings:  17%|#7        | 51/299 [00:08<00:28,  8.66it/s]Extracting embeddings:  17%|#7        | 52/299 [00:08<00:28,  8.68it/s]Extracting embeddings:  18%|#7        | 53/299 [00:08<00:28,  8.66it/s]Extracting embeddings:  18%|#8        | 54/299 [00:08<00:28,  8.68it/s]Extracting embeddings:  18%|#8        | 55/299 [00:09<00:28,  8.66it/s]Extracting embeddings:  19%|#8        | 56/299 [00:09<00:28,  8.68it/s]Extracting embeddings:  19%|#9        | 57/299 [00:09<00:27,  8.66it/s]Extracting embeddings:  19%|#9        | 58/299 [00:09<00:27,  8.68it/s]Extracting embeddings:  20%|#9        | 59/299 [00:09<00:27,  8.66it/s]Extracting embeddings:  20%|##        | 60/299 [00:09<00:27,  8.68it/s]Extracting embeddings:  20%|##        | 61/299 [00:09<00:27,  8.66it/s]Extracting embeddings:  21%|##        | 62/299 [00:09<00:27,  8.68it/s]Extracting embeddings:  21%|##1       | 63/299 [00:10<00:27,  8.67it/s]Extracting embeddings:  21%|##1       | 64/299 [00:10<00:27,  8.69it/s]Extracting embeddings:  22%|##1       | 65/299 [00:10<00:26,  8.67it/s]Extracting embeddings:  22%|##2       | 66/299 [00:10<00:26,  8.69it/s]Extracting embeddings:  22%|##2       | 67/299 [00:10<00:26,  8.67it/s]Extracting embeddings:  23%|##2       | 68/299 [00:10<00:26,  8.69it/s]Extracting embeddings:  23%|##3       | 69/299 [00:10<00:26,  8.66it/s]Extracting embeddings:  23%|##3       | 70/299 [00:10<00:26,  8.69it/s]Extracting embeddings:  24%|##3       | 71/299 [00:10<00:26,  8.66it/s]Extracting embeddings:  24%|##4       | 72/299 [00:11<00:26,  8.68it/s]Extracting embeddings:  24%|##4       | 73/299 [00:11<00:26,  8.67it/s]Extracting embeddings:  25%|##4       | 74/299 [00:11<00:25,  8.69it/s]Extracting embeddings:  25%|##5       | 75/299 [00:11<00:25,  8.67it/s]Extracting embeddings:  25%|##5       | 76/299 [00:11<00:25,  8.69it/s]Extracting embeddings:  26%|##5       | 77/299 [00:11<00:25,  8.67it/s]Extracting embeddings:  26%|##6       | 78/299 [00:11<00:25,  8.68it/s]Extracting embeddings:  26%|##6       | 79/299 [00:11<00:25,  8.66it/s]Extracting embeddings:  27%|##6       | 80/299 [00:11<00:25,  8.68it/s]Extracting embeddings:  27%|##7       | 81/299 [00:12<00:25,  8.66it/s]Extracting embeddings:  27%|##7       | 82/299 [00:12<00:25,  8.68it/s]Extracting embeddings:  28%|##7       | 83/299 [00:12<00:24,  8.66it/s]Extracting embeddings:  28%|##8       | 84/299 [00:12<00:24,  8.68it/s]Extracting embeddings:  28%|##8       | 85/299 [00:12<00:31,  6.81it/s]Extracting embeddings:  29%|##8       | 86/299 [00:12<00:29,  7.25it/s]Extracting embeddings:  29%|##9       | 87/299 [00:12<00:27,  7.59it/s]Extracting embeddings:  29%|##9       | 88/299 [00:12<00:26,  7.89it/s]Extracting embeddings:  30%|##9       | 89/299 [00:13<00:25,  8.08it/s]Extracting embeddings:  30%|###       | 90/299 [00:13<00:25,  8.26it/s]Extracting embeddings:  30%|###       | 91/299 [00:13<00:24,  8.35it/s]Extracting embeddings:  31%|###       | 92/299 [00:13<00:24,  8.45it/s]Extracting embeddings:  31%|###1      | 93/299 [00:13<00:24,  8.50it/s]Extracting embeddings:  31%|###1      | 94/299 [00:13<00:23,  8.56it/s]Extracting embeddings:  32%|###1      | 95/299 [00:13<00:23,  8.57it/s]Extracting embeddings:  32%|###2      | 96/299 [00:13<00:23,  8.61it/s]Extracting embeddings:  32%|###2      | 97/299 [00:14<00:23,  8.60it/s]Extracting embeddings:  33%|###2      | 98/299 [00:14<00:23,  8.63it/s]Extracting embeddings:  33%|###3      | 99/299 [00:14<00:23,  8.62it/s]Extracting embeddings:  33%|###3      | 100/299 [00:14<00:23,  8.65it/s]Extracting embeddings:  34%|###3      | 101/299 [00:14<00:22,  8.63it/s]Extracting embeddings:  34%|###4      | 102/299 [00:14<00:22,  8.65it/s]Extracting embeddings:  34%|###4      | 103/299 [00:14<00:22,  8.63it/s]Extracting embeddings:  35%|###4      | 104/299 [00:14<00:22,  8.66it/s]Extracting embeddings:  35%|###5      | 105/299 [00:14<00:22,  8.63it/s]Extracting embeddings:  35%|###5      | 106/299 [00:15<00:22,  8.66it/s]Extracting embeddings:  36%|###5      | 107/299 [00:15<00:22,  8.64it/s]Extracting embeddings:  36%|###6      | 108/299 [00:15<00:22,  8.66it/s]Extracting embeddings:  36%|###6      | 109/299 [00:15<00:22,  8.64it/s]Extracting embeddings:  37%|###6      | 110/299 [00:15<00:21,  8.66it/s]Extracting embeddings:  37%|###7      | 111/299 [00:15<00:21,  8.65it/s]Extracting embeddings:  37%|###7      | 112/299 [00:15<00:21,  8.67it/s]Extracting embeddings:  38%|###7      | 113/299 [00:15<00:21,  8.65it/s]Extracting embeddings:  38%|###8      | 114/299 [00:16<00:21,  8.67it/s]Extracting embeddings:  38%|###8      | 115/299 [00:16<00:21,  8.66it/s]Extracting embeddings:  39%|###8      | 116/299 [00:16<00:21,  8.68it/s]Extracting embeddings:  39%|###9      | 117/299 [00:16<00:21,  8.65it/s]Extracting embeddings:  39%|###9      | 118/299 [00:16<00:20,  8.68it/s]Extracting embeddings:  40%|###9      | 119/299 [00:16<00:20,  8.65it/s]Extracting embeddings:  40%|####      | 120/299 [00:16<00:20,  8.68it/s]Extracting embeddings:  40%|####      | 121/299 [00:16<00:20,  8.65it/s]Extracting embeddings:  41%|####      | 122/299 [00:16<00:20,  8.67it/s]Extracting embeddings:  41%|####1     | 123/299 [00:17<00:20,  8.65it/s]Extracting embeddings:  41%|####1     | 124/299 [00:17<00:20,  8.67it/s]Extracting embeddings:  42%|####1     | 125/299 [00:17<00:20,  8.65it/s]Extracting embeddings:  42%|####2     | 126/299 [00:17<00:19,  8.67it/s]Extracting embeddings:  42%|####2     | 127/299 [00:17<00:19,  8.65it/s]Extracting embeddings:  43%|####2     | 128/299 [00:17<00:19,  8.67it/s]Extracting embeddings:  43%|####3     | 129/299 [00:17<00:19,  8.65it/s]Extracting embeddings:  43%|####3     | 130/299 [00:17<00:19,  8.67it/s]Extracting embeddings:  44%|####3     | 131/299 [00:17<00:19,  8.65it/s]Extracting embeddings:  44%|####4     | 132/299 [00:18<00:24,  6.85it/s]Extracting embeddings:  44%|####4     | 133/299 [00:18<00:22,  7.26it/s]Extracting embeddings:  45%|####4     | 134/299 [00:18<00:21,  7.63it/s]Extracting embeddings:  45%|####5     | 135/299 [00:18<00:20,  7.89it/s]Extracting embeddings:  45%|####5     | 136/299 [00:18<00:20,  8.12it/s]Extracting embeddings:  46%|####5     | 137/299 [00:18<00:19,  8.25it/s]Extracting embeddings:  46%|####6     | 138/299 [00:18<00:19,  8.38it/s]Extracting embeddings:  46%|####6     | 139/299 [00:18<00:18,  8.44it/s]Extracting embeddings:  47%|####6     | 140/299 [00:19<00:18,  8.52it/s]Extracting embeddings:  47%|####7     | 141/299 [00:19<00:18,  8.54it/s]Extracting embeddings:  47%|####7     | 142/299 [00:19<00:18,  8.59it/s]Extracting embeddings:  48%|####7     | 143/299 [00:19<00:18,  8.59it/s]Extracting embeddings:  48%|####8     | 144/299 [00:19<00:17,  8.63it/s]Extracting embeddings:  48%|####8     | 145/299 [00:19<00:17,  8.61it/s]Extracting embeddings:  49%|####8     | 146/299 [00:19<00:17,  8.64it/s]Extracting embeddings:  49%|####9     | 147/299 [00:19<00:17,  8.63it/s]Extracting embeddings:  49%|####9     | 148/299 [00:20<00:17,  8.65it/s]Extracting embeddings:  50%|####9     | 149/299 [00:20<00:17,  8.63it/s]Extracting embeddings:  50%|#####     | 150/299 [00:20<00:17,  8.66it/s]Extracting embeddings:  51%|#####     | 151/299 [00:20<00:17,  8.64it/s]Extracting embeddings:  51%|#####     | 152/299 [00:20<00:16,  8.67it/s]Extracting embeddings:  51%|#####1    | 153/299 [00:20<00:16,  8.65it/s]Extracting embeddings:  52%|#####1    | 154/299 [00:20<00:16,  8.67it/s]Extracting embeddings:  52%|#####1    | 155/299 [00:20<00:16,  8.64it/s]Extracting embeddings:  52%|#####2    | 156/299 [00:20<00:16,  8.67it/s]Extracting embeddings:  53%|#####2    | 157/299 [00:21<00:16,  8.63it/s]Extracting embeddings:  53%|#####2    | 158/299 [00:21<00:16,  8.66it/s]Extracting embeddings:  53%|#####3    | 159/299 [00:21<00:16,  8.64it/s]Extracting embeddings:  54%|#####3    | 160/299 [00:21<00:16,  8.66it/s]Extracting embeddings:  54%|#####3    | 161/299 [00:21<00:15,  8.63it/s]Extracting embeddings:  54%|#####4    | 162/299 [00:21<00:15,  8.66it/s]Extracting embeddings:  55%|#####4    | 163/299 [00:21<00:15,  8.64it/s]Extracting embeddings:  55%|#####4    | 164/299 [00:21<00:15,  8.66it/s]Extracting embeddings:  55%|#####5    | 165/299 [00:22<00:15,  8.64it/s]Extracting embeddings:  56%|#####5    | 166/299 [00:22<00:15,  8.67it/s]Extracting embeddings:  56%|#####5    | 167/299 [00:22<00:15,  8.64it/s]Extracting embeddings:  56%|#####6    | 168/299 [00:22<00:15,  8.67it/s]Extracting embeddings:  57%|#####6    | 169/299 [00:22<00:15,  8.64it/s]Extracting embeddings:  57%|#####6    | 170/299 [00:22<00:14,  8.66it/s]Extracting embeddings:  57%|#####7    | 171/299 [00:22<00:14,  8.65it/s]Extracting embeddings:  58%|#####7    | 172/299 [00:22<00:14,  8.67it/s]Extracting embeddings:  58%|#####7    | 173/299 [00:22<00:14,  8.65it/s]Extracting embeddings:  58%|#####8    | 174/299 [00:23<00:14,  8.67it/s]Extracting embeddings:  59%|#####8    | 175/299 [00:23<00:14,  8.65it/s]Extracting embeddings:  59%|#####8    | 176/299 [00:23<00:14,  8.67it/s]Extracting embeddings:  59%|#####9    | 177/299 [00:23<00:14,  8.65it/s]Extracting embeddings:  60%|#####9    | 178/299 [00:23<00:17,  6.84it/s]Extracting embeddings:  60%|#####9    | 179/299 [00:23<00:16,  7.25it/s]Extracting embeddings:  60%|######    | 180/299 [00:23<00:15,  7.63it/s]Extracting embeddings:  61%|######    | 181/299 [00:23<00:14,  7.89it/s]Extracting embeddings:  61%|######    | 182/299 [00:24<00:14,  8.12it/s]Extracting embeddings:  61%|######1   | 183/299 [00:24<00:14,  8.25it/s]Extracting embeddings:  62%|######1   | 184/299 [00:24<00:13,  8.38it/s]Extracting embeddings:  62%|######1   | 185/299 [00:24<00:13,  8.44it/s]Extracting embeddings:  62%|######2   | 186/299 [00:24<00:13,  8.52it/s]Extracting embeddings:  63%|######2   | 187/299 [00:24<00:13,  8.54it/s]Extracting embeddings:  63%|######2   | 188/299 [00:24<00:12,  8.59it/s]Extracting embeddings:  63%|######3   | 189/299 [00:24<00:12,  8.59it/s]Extracting embeddings:  64%|######3   | 190/299 [00:24<00:12,  8.62it/s]Extracting embeddings:  64%|######3   | 191/299 [00:25<00:12,  8.61it/s]Extracting embeddings:  64%|######4   | 192/299 [00:25<00:12,  8.64it/s]Extracting embeddings:  65%|######4   | 193/299 [00:25<00:12,  8.62it/s]Extracting embeddings:  65%|######4   | 194/299 [00:25<00:12,  8.65it/s]Extracting embeddings:  65%|######5   | 195/299 [00:25<00:12,  8.63it/s]Extracting embeddings:  66%|######5   | 196/299 [00:25<00:11,  8.66it/s]Extracting embeddings:  66%|######5   | 197/299 [00:25<00:11,  8.64it/s]Extracting embeddings:  66%|######6   | 198/299 [00:25<00:11,  8.66it/s]Extracting embeddings:  67%|######6   | 199/299 [00:26<00:11,  8.64it/s]Extracting embeddings:  67%|######6   | 200/299 [00:26<00:11,  8.67it/s]Extracting embeddings:  67%|######7   | 201/299 [00:26<00:11,  8.65it/s]Extracting embeddings:  68%|######7   | 202/299 [00:26<00:11,  8.67it/s]Extracting embeddings:  68%|######7   | 203/299 [00:26<00:11,  8.64it/s]Extracting embeddings:  68%|######8   | 204/299 [00:26<00:10,  8.67it/s]Extracting embeddings:  69%|######8   | 205/299 [00:26<00:10,  8.64it/s]Extracting embeddings:  69%|######8   | 206/299 [00:26<00:10,  8.67it/s]Extracting embeddings:  69%|######9   | 207/299 [00:26<00:10,  8.64it/s]Extracting embeddings:  70%|######9   | 208/299 [00:27<00:10,  8.67it/s]Extracting embeddings:  70%|######9   | 209/299 [00:27<00:10,  8.65it/s]Extracting embeddings:  70%|#######   | 210/299 [00:27<00:10,  8.66it/s]Extracting embeddings:  71%|#######   | 211/299 [00:27<00:10,  8.64it/s]Extracting embeddings:  71%|#######   | 212/299 [00:27<00:10,  8.67it/s]Extracting embeddings:  71%|#######1  | 213/299 [00:27<00:09,  8.64it/s]Extracting embeddings:  72%|#######1  | 214/299 [00:27<00:09,  8.66it/s]Extracting embeddings:  72%|#######1  | 215/299 [00:27<00:09,  8.64it/s]Extracting embeddings:  72%|#######2  | 216/299 [00:28<00:09,  8.66it/s]Extracting embeddings:  73%|#######2  | 217/299 [00:28<00:09,  8.64it/s]Extracting embeddings:  73%|#######2  | 218/299 [00:28<00:09,  8.67it/s]Extracting embeddings:  73%|#######3  | 219/299 [00:28<00:09,  8.64it/s]Extracting embeddings:  74%|#######3  | 220/299 [00:28<00:09,  8.67it/s]Extracting embeddings:  74%|#######3  | 221/299 [00:28<00:09,  8.65it/s]Extracting embeddings:  74%|#######4  | 222/299 [00:28<00:08,  8.67it/s]Extracting embeddings:  75%|#######4  | 223/299 [00:28<00:08,  8.64it/s]Extracting embeddings:  75%|#######4  | 224/299 [00:29<00:10,  6.85it/s]Extracting embeddings:  75%|#######5  | 225/299 [00:29<00:10,  7.26it/s]Extracting embeddings:  76%|#######5  | 226/299 [00:29<00:09,  7.64it/s]Extracting embeddings:  76%|#######5  | 227/299 [00:29<00:09,  7.90it/s]Extracting embeddings:  76%|#######6  | 228/299 [00:29<00:08,  8.13it/s]Extracting embeddings:  77%|#######6  | 229/299 [00:29<00:08,  8.26it/s]Extracting embeddings:  77%|#######6  | 230/299 [00:29<00:08,  8.40it/s]Extracting embeddings:  77%|#######7  | 231/299 [00:29<00:08,  8.45it/s]Extracting embeddings:  78%|#######7  | 232/299 [00:29<00:07,  8.53it/s]Extracting embeddings:  78%|#######7  | 233/299 [00:30<00:07,  8.55it/s]Extracting embeddings:  78%|#######8  | 234/299 [00:30<00:07,  8.60it/s]Extracting embeddings:  79%|#######8  | 235/299 [00:30<00:07,  8.60it/s]Extracting embeddings:  79%|#######8  | 236/299 [00:30<00:07,  8.64it/s]Extracting embeddings:  79%|#######9  | 237/299 [00:30<00:07,  8.62it/s]Extracting embeddings:  80%|#######9  | 238/299 [00:30<00:07,  8.65it/s]Extracting embeddings:  80%|#######9  | 239/299 [00:30<00:06,  8.63it/s]Extracting embeddings:  80%|########  | 240/299 [00:30<00:06,  8.66it/s]Extracting embeddings:  81%|########  | 241/299 [00:30<00:06,  8.64it/s]Extracting embeddings:  81%|########  | 242/299 [00:31<00:06,  8.66it/s]Extracting embeddings:  81%|########1 | 243/299 [00:31<00:06,  8.64it/s]Extracting embeddings:  82%|########1 | 244/299 [00:31<00:06,  8.66it/s]Extracting embeddings:  82%|########1 | 245/299 [00:31<00:06,  8.64it/s]Extracting embeddings:  82%|########2 | 246/299 [00:31<00:06,  8.66it/s]Extracting embeddings:  83%|########2 | 247/299 [00:31<00:06,  8.64it/s]Extracting embeddings:  83%|########2 | 248/299 [00:31<00:05,  8.67it/s]Extracting embeddings:  83%|########3 | 249/299 [00:31<00:05,  8.64it/s]Extracting embeddings:  84%|########3 | 250/299 [00:32<00:05,  8.67it/s]Extracting embeddings:  84%|########3 | 251/299 [00:32<00:05,  8.64it/s]Extracting embeddings:  84%|########4 | 252/299 [00:32<00:05,  8.66it/s]Extracting embeddings:  85%|########4 | 253/299 [00:32<00:05,  8.64it/s]Extracting embeddings:  85%|########4 | 254/299 [00:32<00:05,  8.66it/s]Extracting embeddings:  85%|########5 | 255/299 [00:32<00:05,  8.64it/s]Extracting embeddings:  86%|########5 | 256/299 [00:32<00:04,  8.66it/s]Extracting embeddings:  86%|########5 | 257/299 [00:32<00:04,  8.64it/s]Extracting embeddings:  86%|########6 | 258/299 [00:32<00:04,  8.66it/s]Extracting embeddings:  87%|########6 | 259/299 [00:33<00:04,  8.64it/s]Extracting embeddings:  87%|########6 | 260/299 [00:33<00:04,  8.66it/s]Extracting embeddings:  87%|########7 | 261/299 [00:33<00:04,  8.64it/s]Extracting embeddings:  88%|########7 | 262/299 [00:33<00:04,  8.66it/s]Extracting embeddings:  88%|########7 | 263/299 [00:33<00:04,  8.64it/s]Extracting embeddings:  88%|########8 | 264/299 [00:33<00:04,  8.67it/s]Extracting embeddings:  89%|########8 | 265/299 [00:33<00:03,  8.65it/s]Extracting embeddings:  89%|########8 | 266/299 [00:33<00:03,  8.67it/s]Extracting embeddings:  89%|########9 | 267/299 [00:34<00:03,  8.64it/s]Extracting embeddings:  90%|########9 | 268/299 [00:34<00:03,  8.67it/s]Extracting embeddings:  90%|########9 | 269/299 [00:34<00:03,  8.65it/s]Extracting embeddings:  90%|######### | 270/299 [00:34<00:04,  6.82it/s]Extracting embeddings:  91%|######### | 271/299 [00:34<00:03,  7.24it/s]Extracting embeddings:  91%|######### | 272/299 [00:34<00:03,  7.62it/s]Extracting embeddings:  91%|#########1| 273/299 [00:34<00:03,  7.89it/s]Extracting embeddings:  92%|#########1| 274/299 [00:34<00:03,  8.11it/s]Extracting embeddings:  92%|#########1| 275/299 [00:35<00:02,  8.25it/s]Extracting embeddings:  92%|#########2| 276/299 [00:35<00:02,  8.39it/s]Extracting embeddings:  93%|#########2| 277/299 [00:35<00:02,  8.44it/s]Extracting embeddings:  93%|#########2| 278/299 [00:35<00:02,  8.52it/s]Extracting embeddings:  93%|#########3| 279/299 [00:35<00:02,  8.54it/s]Extracting embeddings:  94%|#########3| 280/299 [00:35<00:02,  8.60it/s]Extracting embeddings:  94%|#########3| 281/299 [00:35<00:02,  8.60it/s]Extracting embeddings:  94%|#########4| 282/299 [00:35<00:01,  8.64it/s]Extracting embeddings:  95%|#########4| 283/299 [00:35<00:01,  8.63it/s]Extracting embeddings:  95%|#########4| 284/299 [00:36<00:01,  8.65it/s]Extracting embeddings:  95%|#########5| 285/299 [00:36<00:01,  8.63it/s]Extracting embeddings:  96%|#########5| 286/299 [00:36<00:01,  8.66it/s]Extracting embeddings:  96%|#########5| 287/299 [00:36<00:01,  8.64it/s]Extracting embeddings:  96%|#########6| 288/299 [00:36<00:01,  8.66it/s]Extracting embeddings:  97%|#########6| 289/299 [00:36<00:01,  8.64it/s]Extracting embeddings:  97%|#########6| 290/299 [00:36<00:01,  8.67it/s]Extracting embeddings:  97%|#########7| 291/299 [00:36<00:00,  8.65it/s]Extracting embeddings:  98%|#########7| 292/299 [00:36<00:00,  8.67it/s]Extracting embeddings:  98%|#########7| 293/299 [00:37<00:00,  8.65it/s]Extracting embeddings:  98%|#########8| 294/299 [00:37<00:00,  8.68it/s]Extracting embeddings:  99%|#########8| 295/299 [00:37<00:00,  8.65it/s]Extracting embeddings:  99%|#########8| 296/299 [00:37<00:00,  8.68it/s]Extracting embeddings:  99%|#########9| 297/299 [00:37<00:00,  8.65it/s]Extracting embeddings: 100%|#########9| 298/299 [00:37<00:00,  8.67it/s]Extracting embeddings: 100%|##########| 299/299 [00:37<00:00,  7.93it/s]
  Embedding matrix shape: (152624, 384)

Computing PCA for n_samples=512...
  Computed 384 eigenvalues
  Top 10 eigenvalues: [8.4044868e-01 6.2495980e-02 2.6070729e-02 3.5633524e-03 3.1869843e-06
 2.0632606e-06 1.5257550e-06 1.1156023e-06 8.1463270e-07 6.8151888e-07]
  Variance explained by top 10: 100.00%

Computing PCA for n_samples=4096...
  Computed 384 eigenvalues
  Top 10 eigenvalues: [8.9536607e-01 5.8083691e-02 2.8407618e-02 3.4513026e-03 3.1306472e-06
 2.1082012e-06 1.4422707e-06 1.1136740e-06 7.9228062e-07 6.8638599e-07]
  Variance explained by top 10: 100.00%

Computing PCA for n_samples=16384...
  Computed 384 eigenvalues
  Top 10 eigenvalues: [8.8821924e-01 6.2313050e-02 2.7254382e-02 3.4479969e-03 3.1903219e-06
 2.0772554e-06 1.4399070e-06 1.1117528e-06 8.0094003e-07 6.7238847e-07]
  Variance explained by top 10: 100.00%

Computing PCA for n_samples=65536...
  Computed 384 eigenvalues
  Top 10 eigenvalues: [8.9241457e-01 6.3336685e-02 2.7903745e-02 3.5239828e-03 3.1572647e-06
 2.0556081e-06 1.4548532e-06 1.0984023e-06 7.9246780e-07 6.6528042e-07]
  Variance explained by top 10: 100.00%

Computing PCA for n_samples=152624...
  Computed 384 eigenvalues
  Top 10 eigenvalues: [8.9444858e-01 6.2461246e-02 2.7933035e-02 3.5089087e-03 3.1589568e-06
 2.0622322e-06 1.4517180e-06 1.0906321e-06 7.8610782e-07 6.6735635e-07]
  Variance explained by top 10: 100.00%

Fitting full PCA for classification (n=152624)...

Loading membership data from split 'validation' (no species filter)...
Loading dataset from HuggingFace (path=eczech/gpn-animal-promoter-dataset, revision=f009db443a914d4113922e3028de0666b85c24d6, split=validation)...
Dataset size: 8,792 records

Preparing sequences (cropping to 512 bp and filtering empty)...
  Records before filtering: 8,792
  Records after filtering: 8,792
  Empty sequences filtered: 0
Sampling 8192 records...
Extracting records...
  Unique species: 5
Loading AutoModelForCausalLM from plantcad/marin_exp2101__pcv2_pretrain_c4096__checkpoints subfolder=checkpoints/gpn_promoter_pretrain_c512_v0.2 with dtype=torch.bfloat16...
  Hidden size: 384
  Parameters: 9,450,624 (9.5M)
  Device: cuda, Dtype: torch.bfloat16
  Model:
Qwen2ForCausalLM(
  (model): Qwen2Model(
    (embed_tokens): Embedding(7, 384)
    (layers): ModuleList(
      (0-3): 4 x Qwen2DecoderLayer(
        (self_attn): Qwen2Attention(
          (q_proj): Linear(in_features=384, out_features=384, bias=True)
          (k_proj): Linear(in_features=384, out_features=384, bias=True)
          (v_proj): Linear(in_features=384, out_features=384, bias=True)
          (o_proj): Linear(in_features=384, out_features=384, bias=False)
        )
        (mlp): Qwen2MLP(
          (gate_proj): Linear(in_features=384, out_features=1536, bias=False)
          (up_proj): Linear(in_features=384, out_features=1536, bias=False)
          (down_proj): Linear(in_features=1536, out_features=384, bias=False)
          (act_fn): SiLU()
        )
        (input_layernorm): Qwen2RMSNorm((384,), eps=1e-06)
        (post_attention_layernorm): Qwen2RMSNorm((384,), eps=1e-06)
      )
    )
    (norm): Qwen2RMSNorm((384,), eps=1e-06)
    (rotary_emb): Qwen2RotaryEmbedding()
  )
  (lm_head): Linear(in_features=384, out_features=7, bias=False)
)
Extracting embeddings:   0%|          | 0/16 [00:00<?, ?it/s]Extracting embeddings:   6%|6         | 1/16 [00:00<00:01,  8.40it/s]Extracting embeddings:  12%|#2        | 2/16 [00:00<00:01,  8.54it/s]Extracting embeddings:  19%|#8        | 3/16 [00:00<00:01,  8.62it/s]Extracting embeddings:  25%|##5       | 4/16 [00:00<00:01,  8.66it/s]Extracting embeddings:  31%|###1      | 5/16 [00:00<00:01,  8.69it/s]Extracting embeddings:  38%|###7      | 6/16 [00:00<00:01,  8.71it/s]Extracting embeddings:  44%|####3     | 7/16 [00:00<00:01,  8.73it/s]Extracting embeddings:  50%|#####     | 8/16 [00:00<00:00,  8.73it/s]Extracting embeddings:  56%|#####6    | 9/16 [00:01<00:00,  8.74it/s]Extracting embeddings:  62%|######2   | 10/16 [00:01<00:00,  8.74it/s]Extracting embeddings:  69%|######8   | 11/16 [00:01<00:00,  8.74it/s]Extracting embeddings:  75%|#######5  | 12/16 [00:01<00:00,  8.74it/s]Extracting embeddings:  81%|########1 | 13/16 [00:01<00:00,  8.75it/s]Extracting embeddings:  88%|########7 | 14/16 [00:01<00:00,  8.74it/s]Extracting embeddings:  94%|#########3| 15/16 [00:01<00:00,  8.75it/s]Extracting embeddings: 100%|##########| 16/16 [00:01<00:00,  8.74it/s]Extracting embeddings: 100%|##########| 16/16 [00:01<00:00,  8.71it/s]
  Embedding matrix shape: (8192, 384)

Saving checkpoint to: results/sep/v28/eigenspectrum_smarin_l512_n512_4096_16384_65536_152624_pmean.pkl

For n=152624:
  Components needed for 90% variance: 1
  Components needed for 95% variance: 2
  Effective sample size: 1.21389925
  Condition number: 2.50093927e+16

Figure saved to: results/sep/v28/eigenspectrum_smarin_n152624_l512_pmean.png
PDF saved to: results/sep/v28/eigenspectrum_smarin_n152624_l512_pmean.pdf
Eigenvalue data exported to: results/sep/v28/eigenspectrum_smarin_n152624_l512_pmean.csv

======================================================================
PC SCALING ANALYSIS
Testing n_components: [0, 1, 2, 3, 4, 8, 16, 32, 64, 128, 256, 384]
======================================================================
Extracting sequence features:   0%|          | 0/152624 [00:00<?, ?it/s]Extracting sequence features:   2%|2         | 3710/152624 [00:00<00:04, 36874.36it/s]Extracting sequence features:   5%|4         | 7578/152624 [00:00<00:03, 37928.44it/s]Extracting sequence features:   8%|7         | 11483/152624 [00:00<00:03, 38429.44it/s]Extracting sequence features:  10%|#         | 15350/152624 [00:00<00:03, 38520.16it/s]Extracting sequence features:  13%|#2        | 19223/152624 [00:00<00:03, 38595.59it/s]Extracting sequence features:  15%|#5        | 23125/152624 [00:00<00:03, 38737.85it/s]Extracting sequence features:  18%|#7        | 27020/152624 [00:00<00:03, 38803.90it/s]Extracting sequence features:  20%|##        | 30901/152624 [00:00<00:03, 38771.20it/s]Extracting sequence features:  23%|##2       | 34797/152624 [00:00<00:03, 38823.88it/s]Extracting sequence features:  25%|##5       | 38680/152624 [00:01<00:02, 38805.46it/s]Extracting sequence features:  28%|##7       | 42561/152624 [00:01<00:02, 38641.43it/s]Extracting sequence features:  30%|###       | 46459/152624 [00:01<00:02, 38743.62it/s]Extracting sequence features:  33%|###2      | 50345/152624 [00:01<00:02, 38774.00it/s]Extracting sequence features:  36%|###5      | 54223/152624 [00:01<00:02, 38762.11it/s]Extracting sequence features:  38%|###8      | 58125/152624 [00:01<00:02, 38817.65it/s]Extracting sequence features:  41%|####      | 62007/152624 [00:01<00:02, 38775.94it/s]Extracting sequence features:  43%|####3     | 65885/152624 [00:01<00:02, 38752.96it/s]Extracting sequence features:  46%|####5     | 69776/152624 [00:01<00:02, 38754.01it/s]Extracting sequence features:  48%|####8     | 73684/152624 [00:01<00:02, 38850.35it/s]Extracting sequence features:  51%|#####     | 77570/152624 [00:02<00:01, 38818.29it/s]Extracting sequence features:  53%|#####3    | 81452/152624 [00:02<00:01, 38753.72it/s]Extracting sequence features:  56%|#####5    | 85365/152624 [00:02<00:01, 38862.62it/s]Extracting sequence features:  58%|#####8    | 89252/152624 [00:02<00:01, 38859.07it/s]Extracting sequence features:  61%|######1   | 93138/152624 [00:02<00:01, 38842.51it/s]Extracting sequence features:  64%|######3   | 97025/152624 [00:02<00:01, 38846.90it/s]Extracting sequence features:  66%|######6   | 100910/152624 [00:02<00:01, 38823.59it/s]Extracting sequence features:  69%|######8   | 104801/152624 [00:02<00:01, 38847.83it/s]Extracting sequence features:  71%|#######1  | 108697/152624 [00:02<00:01, 38825.94it/s]Extracting sequence features:  74%|#######3  | 112583/152624 [00:02<00:01, 38827.39it/s]Extracting sequence features:  76%|#######6  | 116466/152624 [00:03<00:00, 38779.46it/s]Extracting sequence features:  79%|#######8  | 120347/152624 [00:03<00:00, 38786.70it/s]Extracting sequence features:  81%|########1 | 124226/152624 [00:03<00:00, 38770.06it/s]Extracting sequence features:  84%|########3 | 128104/152624 [00:03<00:00, 38703.51it/s]Extracting sequence features:  86%|########6 | 132011/152624 [00:03<00:00, 38724.93it/s]Extracting sequence features:  89%|########9 | 135909/152624 [00:03<00:00, 38789.66it/s]Extracting sequence features:  92%|#########1| 139809/152624 [00:03<00:00, 38850.74it/s]Extracting sequence features:  94%|#########4| 143695/152624 [00:03<00:00, 38792.20it/s]Extracting sequence features:  97%|#########6| 147586/152624 [00:03<00:00, 38826.69it/s]Extracting sequence features:  99%|#########9| 151471/152624 [00:03<00:00, 38825.70it/s]Extracting sequence features: 100%|##########| 152624/152624 [00:03<00:00, 38752.76it/s]

  Membership task: 152624 train + 8192 membership -> 8192 each (balanced)
[membership[n_comp=0]] 2 classes, 16384 samples
  Classes: membership, train
  membership           Performance by n_components:
    Accuracy:  0.508 0.674 0.679 0.684 0.685 0.687 0.687 0.687 0.687 0.687 0.687 0.687
    F1:        0.508 0.670 0.676 0.681 0.683 0.685 0.685 0.685 0.685 0.685 0.685 0.685
    ROC AUC:   0.512 0.716 0.720 0.726 0.729 0.730 0.730 0.730 0.730 0.730 0.730 0.730
    AUPRC:     0.514 0.701 0.706 0.711 0.710 0.711 0.711 0.711 0.711 0.711 0.711 0.711
[species[n_comp=0]] 6 classes, 152624 samples
  Classes: Caenorhabditis elegans, Callithrix jacchus, Drosophila melanogaster, Fundulus heteroclitus, Homo sapiens, Mus musculus
  species              Performance by n_components:
    Accuracy:  0.212 0.348 0.364 0.379 0.394 0.520 0.555 0.564 0.577 0.589 0.595 0.597
    F1:        0.143 0.290 0.310 0.328 0.366 0.545 0.589 0.605 0.622 0.635 0.642 0.645
    ROC AUC:   0.501 0.714 0.742 0.762 0.775 0.862 0.876 0.880 0.885 0.889 0.892 0.893
    AUPRC:     0.167 0.301 0.331 0.355 0.386 0.591 0.635 0.657 0.670 0.684 0.695 0.698
[gc_content[n_comp=0]] 5 classes, 152624 samples
  Classes: 0.146-0.391, 0.391-0.453, 0.453-0.523, 0.523-0.625, 0.625-1.000
  gc_content           Performance by n_components:
    Accuracy:  0.202 0.842 0.842 0.846 0.849 0.864 0.898 0.913 0.920 0.922 0.922 0.922
    F1:        0.200 0.842 0.842 0.847 0.850 0.864 0.898 0.913 0.920 0.922 0.922 0.922
    ROC AUC:   0.504 0.978 0.978 0.979 0.980 0.983 0.990 0.993 0.994 0.994 0.994 0.994
    AUPRC:     0.201 0.906 0.908 0.914 0.916 0.931 0.961 0.972 0.976 0.977 0.976 0.975
[repeat_fraction[n_comp=0]] 5 classes, 152624 samples
  Classes: 0.000-0.041, 0.041-0.092, 0.092-0.160, 0.160-0.271, 0.271-1.000
  repeat_fraction      Performance by n_components:
    Accuracy:  0.209 0.328 0.349 0.360 0.370 0.406 0.444 0.451 0.469 0.476 0.481 0.483
    F1:        0.171 0.320 0.345 0.356 0.367 0.404 0.444 0.451 0.470 0.477 0.482 0.484
    ROC AUC:   0.500 0.684 0.701 0.712 0.720 0.754 0.783 0.790 0.802 0.806 0.809 0.809
    AUPRC:     0.200 0.334 0.355 0.367 0.379 0.421 0.462 0.472 0.492 0.497 0.502 0.503
[kmer_entropy_1[n_comp=0]] 5 classes, 152624 samples
  Classes: 0.000-1.908, 1.908-1.949, 1.949-1.972, 1.972-1.987, 1.987-2.000
  kmer_entropy_1       Performance by n_components:
    Accuracy:  0.198 0.618 0.664 0.701 0.709 0.738 0.772 0.786 0.789 0.788 0.785 0.785
    F1:        0.197 0.615 0.662 0.701 0.709 0.739 0.773 0.787 0.790 0.789 0.786 0.786
    ROC AUC:   0.502 0.879 0.911 0.931 0.934 0.944 0.956 0.960 0.961 0.960 0.959 0.959
    AUPRC:     0.200 0.625 0.693 0.746 0.756 0.784 0.823 0.838 0.843 0.841 0.838 0.836
[kmer_entropy_3[n_comp=0]] 5 classes, 152624 samples
  Classes: 0.000-5.534, 5.534-5.648, 5.648-5.716, 5.716-5.777, 5.777-5.937
  kmer_entropy_3       Performance by n_components:
    Accuracy:  0.202 0.466 0.530 0.562 0.593 0.645 0.674 0.682 0.692 0.697 0.694 0.694
    F1:        0.202 0.458 0.526 0.557 0.590 0.644 0.674 0.683 0.692 0.697 0.694 0.694
    ROC AUC:   0.501 0.777 0.830 0.852 0.875 0.901 0.917 0.921 0.926 0.927 0.926 0.926
    AUPRC:     0.200 0.470 0.544 0.582 0.620 0.679 0.712 0.722 0.736 0.738 0.737 0.737
[kmer_entropy_9[n_comp=0]] 5 classes, 152624 samples
  Classes: 0.000-8.930, 8.930-8.957, 8.957-8.969, 8.969-8.973, 8.973-8.977
  kmer_entropy_9       Performance by n_components:
    Accuracy:  0.335 0.377 0.401 0.422 0.431 0.453 0.471 0.490 0.507 0.515 0.517 0.516
    F1:        0.100 0.207 0.249 0.274 0.283 0.310 0.331 0.353 0.370 0.379 0.381 0.380
    ROC AUC:   0.500 0.584 0.617 0.642 0.652 0.686 0.699 0.720 0.740 0.750 0.751 0.750
    AUPRC:     0.201 0.266 0.297 0.322 0.335 0.367 0.385 0.409 0.429 0.441 0.442 0.441
[dinuc_CG[n_comp=0]] 5 classes, 152624 samples
  Classes: 0.000-0.012, 0.012-0.025, 0.025-0.043, 0.043-0.072, 0.072-0.229
  dinuc_CG             Performance by n_components:
    Accuracy:  0.212 0.447 0.500 0.528 0.595 0.759 0.804 0.823 0.834 0.836 0.836 0.834
    F1:        0.186 0.413 0.496 0.527 0.595 0.760 0.806 0.824 0.835 0.838 0.837 0.836
    ROC AUC:   0.503 0.764 0.800 0.824 0.874 0.951 0.966 0.972 0.975 0.976 0.976 0.975
    AUPRC:     0.202 0.445 0.505 0.545 0.631 0.809 0.865 0.889 0.900 0.904 0.904 0.903
[dinuc_GC[n_comp=0]] 5 classes, 152624 samples
  Classes: 0.000-0.039, 0.039-0.053, 0.053-0.068, 0.068-0.098, 0.098-0.233
  dinuc_GC             Performance by n_components:
    Accuracy:  0.209 0.629 0.639 0.642 0.651 0.669 0.688 0.722 0.740 0.750 0.754 0.756
    F1:        0.187 0.631 0.639 0.642 0.651 0.668 0.688 0.722 0.739 0.750 0.754 0.756
    ROC AUC:   0.502 0.892 0.897 0.899 0.904 0.913 0.923 0.936 0.942 0.946 0.947 0.947
    AUPRC:     0.201 0.651 0.662 0.667 0.676 0.701 0.722 0.760 0.777 0.789 0.792 0.791
[dinuc_AT[n_comp=0]] 5 classes, 152624 samples
  Classes: 0.000-0.023, 0.023-0.041, 0.041-0.061, 0.061-0.080, 0.080-0.249
  dinuc_AT             Performance by n_components:
    Accuracy:  0.208 0.666 0.668 0.671 0.671 0.689 0.721 0.737 0.754 0.768 0.772 0.773
    F1:        0.175 0.670 0.672 0.675 0.674 0.692 0.724 0.739 0.756 0.770 0.775 0.775
    ROC AUC:   0.501 0.915 0.916 0.917 0.918 0.927 0.938 0.944 0.951 0.955 0.956 0.956
    AUPRC:     0.202 0.694 0.701 0.702 0.706 0.728 0.762 0.780 0.803 0.817 0.823 0.823
[dinuc_TA[n_comp=0]] 5 classes, 152624 samples
  Classes: 0.000-0.020, 0.020-0.033, 0.033-0.049, 0.049-0.065, 0.065-0.227
  dinuc_TA             Performance by n_components:
    Accuracy:  0.214 0.612 0.615 0.614 0.622 0.677 0.698 0.712 0.746 0.751 0.755 0.755
    F1:        0.157 0.610 0.613 0.611 0.619 0.677 0.697 0.712 0.745 0.751 0.755 0.755
    ROC AUC:   0.501 0.888 0.890 0.891 0.895 0.920 0.929 0.935 0.947 0.949 0.950 0.950
    AUPRC:     0.200 0.626 0.635 0.638 0.649 0.711 0.734 0.749 0.786 0.792 0.793 0.793
[dinuc_AA[n_comp=0]] 5 classes, 152624 samples
  Classes: 0.000-0.037, 0.037-0.061, 0.061-0.084, 0.084-0.112, 0.112-0.346
  dinuc_AA             Performance by n_components:
    Accuracy:  0.203 0.523 0.575 0.622 0.628 0.662 0.704 0.729 0.739 0.751 0.752 0.752
    F1:        0.185 0.523 0.574 0.622 0.627 0.661 0.704 0.729 0.739 0.751 0.751 0.752
    ROC AUC:   0.502 0.833 0.866 0.894 0.898 0.913 0.931 0.941 0.945 0.948 0.948 0.948
    AUPRC:     0.201 0.533 0.597 0.652 0.662 0.697 0.745 0.775 0.786 0.796 0.796 0.796
[dinuc_TT[n_comp=0]] 5 classes, 152624 samples
  Classes: 0.000-0.037, 0.037-0.061, 0.061-0.084, 0.084-0.112, 0.112-0.335
  dinuc_TT             Performance by n_components:
    Accuracy:  0.204 0.528 0.550 0.641 0.647 0.674 0.723 0.733 0.748 0.753 0.754 0.755
    F1:        0.188 0.526 0.548 0.639 0.645 0.672 0.721 0.732 0.747 0.752 0.753 0.754
    ROC AUC:   0.501 0.836 0.851 0.901 0.904 0.918 0.938 0.942 0.947 0.949 0.949 0.949
    AUPRC:     0.201 0.537 0.568 0.667 0.675 0.709 0.763 0.776 0.790 0.798 0.800 0.799

PC scaling curves saved to: results/sep/v28/pc_scaling_curves.png
PC scaling curves PDF saved to: results/sep/v28/pc_scaling_curves.pdf
PC scaling data exported to: results/sep/v28/pc_scaling_curves.csv

======================================================================
SUMMARY: F1 by n_components
======================================================================
Target                     0       1       2       3       4       8      16      32      64     128     256     384
--------------------------------------------------------------------------------------------------------------------
dinuc_AA               0.185   0.523   0.574   0.622   0.627   0.661   0.704   0.729   0.739   0.751   0.751   0.752
dinuc_AT               0.175   0.670   0.672   0.675   0.674   0.692   0.724   0.739   0.756   0.770   0.775   0.775
dinuc_CG               0.186   0.413   0.496   0.527   0.595   0.760   0.806   0.824   0.835   0.838   0.837   0.836
dinuc_GC               0.187   0.631   0.639   0.642   0.651   0.668   0.688   0.722   0.739   0.750   0.754   0.756
dinuc_TA               0.157   0.610   0.613   0.611   0.619   0.677   0.697   0.712   0.745   0.751   0.755   0.755
dinuc_TT               0.188   0.526   0.548   0.639   0.645   0.672   0.721   0.732   0.747   0.752   0.753   0.754
gc_content             0.200   0.842   0.842   0.847   0.850   0.864   0.898   0.913   0.920   0.922   0.922   0.922
kmer_entropy_1         0.197   0.615   0.662   0.701   0.709   0.739   0.773   0.787   0.790   0.789   0.786   0.786
kmer_entropy_3         0.202   0.458   0.526   0.557   0.590   0.644   0.674   0.683   0.692   0.697   0.694   0.694
kmer_entropy_9         0.100   0.207   0.249   0.274   0.283   0.310   0.331   0.353   0.370   0.379   0.381   0.380
membership             0.508   0.670   0.676   0.681   0.683   0.685   0.685   0.685   0.685   0.685   0.685   0.685
repeat_fraction        0.171   0.320   0.345   0.356   0.367   0.404   0.444   0.451   0.470   0.477   0.482   0.484
species                0.143   0.290   0.310   0.328   0.366   0.545   0.589   0.605   0.622   0.635   0.642   0.645

Training species classifier with n_components=384 PCs...
[Species] 6 classes, 152624 samples
  Classes: Caenorhabditis elegans, Callithrix jacchus, Drosophila melanogaster, Fundulus heteroclitus, Homo sapiens, Mus musculus

[Species] n_classes=6, acc=0.597, f1=0.645
Confusion matrix saved to: results/sep/v28/eigenspectrum_smarin_n152624_l512_pmean_confusion_matrix.png
Confusion matrix PDF saved to: results/sep/v28/eigenspectrum_smarin_n152624_l512_pmean_confusion_matrix.pdf
Confusion matrix data exported to: results/sep/v28/eigenspectrum_smarin_n152624_l512_pmean_confusion_matrix.csv
Classification metrics exported to: results/sep/v28/eigenspectrum_smarin_n152624_l512_pmean_confusion_matrix_metrics.csv

Run completed: 2026-01-03T12:37:31.014656

Done!
