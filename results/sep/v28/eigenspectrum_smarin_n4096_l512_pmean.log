Run started: 2025-12-29T08:08:38.127745
Arguments: Namespace(source='marin', n_samples=[512, 1024, 4096], seq_len=512, pooling_method='mean', model_path='plantcad/marin_exp2101__pcv2_pretrain_c4096__checkpoints', model_subfolder='checkpoints/gpn_promoter_pretrain_c512_v0.2', seed=42, batch_size=512, device='cuda', output_dir='eigenspectrum_results_v28', force=False, species_filter=None, species_column='organism', split='train', dataset_path='eczech/gpn-animal-promoter-dataset', dataset_config=None, dataset_revision='8db35b9536d08bede9231c15b4f3ccff923ed237', text_column='seq', tokenization_mode='strict', dataset_sample_size=None)

Found existing checkpoint: eigenspectrum_results_v28/eigenspectrum_smarin_l512_n512_1024_4096_pmean.pkl
Use --force to recompute

Loading checkpoint from: eigenspectrum_results_v28/eigenspectrum_smarin_l512_n512_1024_4096_pmean.pkl

For n=4096:
  Components needed for 90% variance: 1
  Components needed for 95% variance: 2
  Effective sample size: 1.18905187
  Condition number: 2.16678609e+16

Figure saved to: eigenspectrum_results_v28/eigenspectrum_smarin_n4096_l512_pmean.png
PDF saved to: eigenspectrum_results_v28/eigenspectrum_smarin_n4096_l512_pmean.pdf
Eigenvalue data exported to: eigenspectrum_results_v28/eigenspectrum_smarin_n4096_l512_pmean.csv

======================================================================
PC SCALING ANALYSIS
Testing n_components: [0, 1, 2, 3, 4, 8, 16, 32, 64, 128, 256, 384]
======================================================================
Extracting sequence features:   0%|          | 0/4096 [00:00<?, ?it/s]Extracting sequence features:  98%|#########7| 4005/4096 [00:00<00:00, 40040.49it/s]Extracting sequence features: 100%|##########| 4096/4096 [00:00<00:00, 39868.07it/s]
[species[0]] Filtered: 401/405 classes, 4092/4096 samples
  Classes: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, ... (+391 more)
[species[1]] Filtered: 401/405 classes, 4092/4096 samples
  Classes: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, ... (+391 more)
[species[2]] Filtered: 401/405 classes, 4092/4096 samples
  Classes: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, ... (+391 more)
[species[3]] Filtered: 401/405 classes, 4092/4096 samples
  Classes: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, ... (+391 more)
[species[4]] Filtered: 401/405 classes, 4092/4096 samples
  Classes: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, ... (+391 more)
[species[8]] Filtered: 401/405 classes, 4092/4096 samples
  Classes: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, ... (+391 more)
[species[16]] Filtered: 401/405 classes, 4092/4096 samples
  Classes: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, ... (+391 more)
[species[32]] Filtered: 401/405 classes, 4092/4096 samples
  Classes: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, ... (+391 more)
[species[64]] Filtered: 401/405 classes, 4092/4096 samples
  Classes: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, ... (+391 more)
[species[128]] Filtered: 401/405 classes, 4092/4096 samples
  Classes: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, ... (+391 more)
[species[256]] Filtered: 401/405 classes, 4092/4096 samples
  Classes: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, ... (+391 more)
[species[384]] Filtered: 401/405 classes, 4092/4096 samples
  Classes: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, ... (+391 more)
  species              F1: 0.00 0.00 0.00 0.00 0.00 0.00 0.01 0.01 0.01 0.01 0.00 0.00
[gc_content[0]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[gc_content[1]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[gc_content[2]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[gc_content[3]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[gc_content[4]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[gc_content[8]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[gc_content[16]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[gc_content[32]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[gc_content[64]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[gc_content[128]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[gc_content[256]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[gc_content[384]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
  gc_content           F1: 0.21 0.84 0.83 0.83 0.83 0.83 0.88 0.88 0.89 0.87 0.88 0.87
[repeat_fraction[0]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[repeat_fraction[1]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[repeat_fraction[2]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[repeat_fraction[3]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[repeat_fraction[4]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[repeat_fraction[8]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[repeat_fraction[16]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[repeat_fraction[32]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[repeat_fraction[64]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[repeat_fraction[128]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[repeat_fraction[256]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[repeat_fraction[384]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
  repeat_fraction      F1: 0.20 0.26 0.30 0.30 0.27 0.35 0.37 0.38 0.40 0.39 0.38 0.36
[kmer_entropy_1[0]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[kmer_entropy_1[1]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[kmer_entropy_1[2]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[kmer_entropy_1[3]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[kmer_entropy_1[4]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[kmer_entropy_1[8]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[kmer_entropy_1[16]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[kmer_entropy_1[32]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[kmer_entropy_1[64]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[kmer_entropy_1[128]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[kmer_entropy_1[256]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[kmer_entropy_1[384]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
  kmer_entropy_1       F1: 0.18 0.61 0.64 0.68 0.70 0.70 0.70 0.72 0.72 0.71 0.69 0.70
[kmer_entropy_3[0]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[kmer_entropy_3[1]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[kmer_entropy_3[2]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[kmer_entropy_3[3]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[kmer_entropy_3[4]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[kmer_entropy_3[8]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[kmer_entropy_3[16]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[kmer_entropy_3[32]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[kmer_entropy_3[64]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[kmer_entropy_3[128]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[kmer_entropy_3[256]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[kmer_entropy_3[384]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
  kmer_entropy_3       F1: 0.21 0.48 0.53 0.55 0.56 0.61 0.64 0.63 0.65 0.66 0.65 0.64
[kmer_entropy_9[0]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[kmer_entropy_9[1]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[kmer_entropy_9[2]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[kmer_entropy_9[3]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[kmer_entropy_9[4]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[kmer_entropy_9[8]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[kmer_entropy_9[16]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[kmer_entropy_9[32]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[kmer_entropy_9[64]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[kmer_entropy_9[128]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[kmer_entropy_9[256]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[kmer_entropy_9[384]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
  kmer_entropy_9       F1: 0.16 0.28 0.30 0.32 0.32 0.34 0.36 0.34 0.35 0.38 0.36 0.37
[dinuc_CG[0]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[dinuc_CG[1]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[dinuc_CG[2]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[dinuc_CG[3]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[dinuc_CG[4]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[dinuc_CG[8]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[dinuc_CG[16]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[dinuc_CG[32]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[dinuc_CG[64]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[dinuc_CG[128]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[dinuc_CG[256]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[dinuc_CG[384]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
  dinuc_CG             F1: 0.21 0.39 0.43 0.44 0.50 0.65 0.69 0.73 0.73 0.73 0.70 0.71
[dinuc_GC[0]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[dinuc_GC[1]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[dinuc_GC[2]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[dinuc_GC[3]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[dinuc_GC[4]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[dinuc_GC[8]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[dinuc_GC[16]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[dinuc_GC[32]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[dinuc_GC[64]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[dinuc_GC[128]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[dinuc_GC[256]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[dinuc_GC[384]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
  dinuc_GC             F1: 0.21 0.57 0.56 0.54 0.54 0.57 0.58 0.62 0.64 0.63 0.64 0.62
[dinuc_AT[0]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[dinuc_AT[1]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[dinuc_AT[2]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[dinuc_AT[3]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[dinuc_AT[4]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[dinuc_AT[8]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[dinuc_AT[16]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[dinuc_AT[32]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[dinuc_AT[64]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[dinuc_AT[128]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[dinuc_AT[256]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[dinuc_AT[384]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
  dinuc_AT             F1: 0.18 0.63 0.59 0.60 0.63 0.65 0.69 0.68 0.68 0.70 0.69 0.69
[dinuc_TA[0]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[dinuc_TA[1]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[dinuc_TA[2]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[dinuc_TA[3]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[dinuc_TA[4]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[dinuc_TA[8]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[dinuc_TA[16]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[dinuc_TA[32]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[dinuc_TA[64]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[dinuc_TA[128]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[dinuc_TA[256]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[dinuc_TA[384]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
  dinuc_TA             F1: 0.19 0.62 0.62 0.61 0.60 0.66 0.69 0.70 0.71 0.71 0.71 0.69
[dinuc_AA[0]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[dinuc_AA[1]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[dinuc_AA[2]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[dinuc_AA[3]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[dinuc_AA[4]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[dinuc_AA[8]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[dinuc_AA[16]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[dinuc_AA[32]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[dinuc_AA[64]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[dinuc_AA[128]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[dinuc_AA[256]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[dinuc_AA[384]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
  dinuc_AA             F1: 0.18 0.53 0.50 0.61 0.60 0.64 0.68 0.68 0.70 0.68 0.67 0.66
[dinuc_TT[0]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[dinuc_TT[1]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[dinuc_TT[2]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[dinuc_TT[3]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[dinuc_TT[4]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[dinuc_TT[8]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[dinuc_TT[16]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[dinuc_TT[32]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[dinuc_TT[64]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[dinuc_TT[128]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[dinuc_TT[256]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
[dinuc_TT[384]] 5 classes, 4096 samples
  Classes: 0, 1, 2, 3, 4
  dinuc_TT             F1: 0.17 0.50 0.47 0.60 0.59 0.60 0.65 0.65 0.66 0.65 0.66 0.64

PC scaling curves saved to: eigenspectrum_results_v28/pc_scaling_curves.png
PC scaling curves PDF saved to: eigenspectrum_results_v28/pc_scaling_curves.pdf
PC scaling data exported to: eigenspectrum_results_v28/pc_scaling_curves.csv

======================================================================
SUMMARY: F1 by n_components
======================================================================
Target                     0       1       2       3       4       8      16      32      64     128     256     384
--------------------------------------------------------------------------------------------------------------------
dinuc_AA               0.179   0.525   0.502   0.609   0.602   0.638   0.684   0.677   0.702   0.684   0.672   0.664
dinuc_AT               0.181   0.635   0.593   0.603   0.627   0.654   0.694   0.685   0.684   0.704   0.693   0.686
dinuc_CG               0.206   0.393   0.433   0.445   0.501   0.654   0.695   0.731   0.732   0.728   0.702   0.711
dinuc_GC               0.206   0.571   0.557   0.540   0.543   0.573   0.578   0.625   0.640   0.626   0.635   0.622
dinuc_TA               0.188   0.625   0.617   0.610   0.600   0.657   0.693   0.705   0.714   0.707   0.707   0.690
dinuc_TT               0.167   0.495   0.467   0.597   0.587   0.600   0.652   0.648   0.659   0.650   0.658   0.640
gc_content             0.210   0.838   0.826   0.834   0.829   0.833   0.875   0.885   0.889   0.875   0.881   0.872
kmer_entropy_1         0.182   0.614   0.639   0.682   0.699   0.697   0.700   0.718   0.719   0.706   0.690   0.701
kmer_entropy_3         0.210   0.483   0.534   0.548   0.563   0.615   0.644   0.628   0.650   0.657   0.648   0.637
kmer_entropy_9         0.158   0.276   0.296   0.324   0.320   0.336   0.362   0.344   0.347   0.378   0.360   0.368
repeat_fraction        0.196   0.262   0.302   0.301   0.273   0.348   0.365   0.380   0.397   0.388   0.383   0.361
species                0.001   0.003   0.005   0.004   0.003   0.000   0.005   0.009   0.006   0.005   0.002   0.000

Training species classifier with n_components=384 PCs...
