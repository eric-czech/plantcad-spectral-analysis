Run started: 2025-12-30T22:54:41.342488
Arguments: Namespace(source='marin', n_samples=[512, 4096, 16384, 65536, 262144], seq_len=512, pooling_method='mean', model_path='plantcad/marin_exp2101__pcv2_pretrain_c4096__checkpoints', model_subfolder='checkpoints/gpn_promoter_pretrain_c512_v0.2', model_revision=None, seed=42, batch_size=512, device='cuda', dtype=torch.bfloat16, output_dir='results/sep/v31', force=False, species_filter=None, species_filter_file=None, species_column='organism', split='train', dataset_path='eczech/gpn-animal-promoter-dataset', dataset_config=None, dataset_revision='f009db443a914d4113922e3028de0666b85c24d6', text_column='seq', tokenization_mode='strict', dataset_sample_size=None, dataset_shuffle=False, dataset_dir=None, min_samples_per_class=16)

============================================================
Eigenspectrum Analysis of DNA Sequences
============================================================
Parameters:
  - Source: marin
  - Sample sizes: [512, 4096, 16384, 65536, 262144]
  - Sequence length: 512 bp
  - Feature dimension: model hidden size
  - Pooling method: mean

Loading dataset from HuggingFace (path=eczech/gpn-animal-promoter-dataset, revision=f009db443a914d4113922e3028de0666b85c24d6, split=train)...
Dataset size: 9,038,354 records

Preparing sequences (cropping to 512 bp and filtering empty)...
  Records before filtering: 9,038,354
  Records after filtering: 9,038,354
  Empty sequences filtered: 0
Sampling 262144 records...
Extracting records...
  Unique species: 417
Loading AutoModelForCausalLM from plantcad/marin_exp2101__pcv2_pretrain_c4096__checkpoints subfolder=checkpoints/gpn_promoter_pretrain_c512_v0.2 with dtype=torch.bfloat16...
  Hidden size: 384
  Parameters: 9,450,624 (9.5M)
  Device: cuda, Dtype: torch.bfloat16
  Model:
Qwen2ForCausalLM(
  (model): Qwen2Model(
    (embed_tokens): Embedding(7, 384)
    (layers): ModuleList(
      (0-3): 4 x Qwen2DecoderLayer(
        (self_attn): Qwen2Attention(
          (q_proj): Linear(in_features=384, out_features=384, bias=True)
          (k_proj): Linear(in_features=384, out_features=384, bias=True)
          (v_proj): Linear(in_features=384, out_features=384, bias=True)
          (o_proj): Linear(in_features=384, out_features=384, bias=False)
        )
        (mlp): Qwen2MLP(
          (gate_proj): Linear(in_features=384, out_features=1536, bias=False)
          (up_proj): Linear(in_features=384, out_features=1536, bias=False)
          (down_proj): Linear(in_features=1536, out_features=384, bias=False)
          (act_fn): SiLU()
        )
        (input_layernorm): Qwen2RMSNorm((384,), eps=1e-06)
        (post_attention_layernorm): Qwen2RMSNorm((384,), eps=1e-06)
      )
    )
    (norm): Qwen2RMSNorm((384,), eps=1e-06)
    (rotary_emb): Qwen2RotaryEmbedding()
  )
  (lm_head): Linear(in_features=384, out_features=7, bias=False)
)
Extracting embeddings:   0%|          | 0/512 [00:00<?, ?it/s]Extracting embeddings:   0%|          | 1/512 [00:02<19:40,  2.31s/it]Extracting embeddings:   0%|          | 2/512 [00:02<08:40,  1.02s/it]Extracting embeddings:   1%|          | 3/512 [00:02<05:09,  1.65it/s]Extracting embeddings:   1%|          | 4/512 [00:02<03:30,  2.42it/s]Extracting embeddings:   1%|          | 5/512 [00:02<02:35,  3.26it/s]Extracting embeddings:   1%|1         | 6/512 [00:02<02:02,  4.13it/s]Extracting embeddings:   1%|1         | 7/512 [00:03<01:41,  4.97it/s]Extracting embeddings:   2%|1         | 8/512 [00:03<01:27,  5.74it/s]Extracting embeddings:   2%|1         | 9/512 [00:03<01:18,  6.40it/s]Extracting embeddings:   2%|1         | 10/512 [00:03<01:12,  6.94it/s]Extracting embeddings:   2%|2         | 11/512 [00:03<01:07,  7.38it/s]Extracting embeddings:   2%|2         | 12/512 [00:03<01:04,  7.70it/s]Extracting embeddings:   3%|2         | 13/512 [00:03<01:02,  7.96it/s]Extracting embeddings:   3%|2         | 14/512 [00:03<01:01,  8.13it/s]Extracting embeddings:   3%|2         | 15/512 [00:03<01:00,  8.27it/s]Extracting embeddings:   3%|3         | 16/512 [00:04<00:59,  8.36it/s]Extracting embeddings:   3%|3         | 17/512 [00:04<00:58,  8.44it/s]Extracting embeddings:   4%|3         | 18/512 [00:04<00:58,  8.48it/s]Extracting embeddings:   4%|3         | 19/512 [00:04<00:57,  8.52it/s]Extracting embeddings:   4%|3         | 20/512 [00:04<00:57,  8.54it/s]Extracting embeddings:   4%|4         | 21/512 [00:04<00:57,  8.56it/s]Extracting embeddings:   4%|4         | 22/512 [00:04<00:57,  8.57it/s]Extracting embeddings:   4%|4         | 23/512 [00:04<00:56,  8.59it/s]Extracting embeddings:   5%|4         | 24/512 [00:04<00:56,  8.59it/s]Extracting embeddings:   5%|4         | 25/512 [00:05<00:56,  8.60it/s]Extracting embeddings:   5%|5         | 26/512 [00:05<00:56,  8.59it/s]Extracting embeddings:   5%|5         | 27/512 [00:05<00:56,  8.60it/s]Extracting embeddings:   5%|5         | 28/512 [00:05<00:56,  8.60it/s]Extracting embeddings:   6%|5         | 29/512 [00:05<00:56,  8.61it/s]Extracting embeddings:   6%|5         | 30/512 [00:05<00:56,  8.60it/s]Extracting embeddings:   6%|6         | 31/512 [00:05<00:55,  8.61it/s]Extracting embeddings:   6%|6         | 32/512 [00:05<00:55,  8.60it/s]Extracting embeddings:   6%|6         | 33/512 [00:06<00:55,  8.61it/s]Extracting embeddings:   7%|6         | 34/512 [00:06<00:55,  8.61it/s]Extracting embeddings:   7%|6         | 35/512 [00:06<00:55,  8.62it/s]Extracting embeddings:   7%|7         | 36/512 [00:06<00:55,  8.61it/s]Extracting embeddings:   7%|7         | 37/512 [00:06<00:55,  8.62it/s]Extracting embeddings:   7%|7         | 38/512 [00:06<00:55,  8.62it/s]Extracting embeddings:   8%|7         | 39/512 [00:06<00:54,  8.62it/s]Extracting embeddings:   8%|7         | 40/512 [00:06<00:54,  8.61it/s]Extracting embeddings:   8%|8         | 41/512 [00:06<00:54,  8.62it/s]Extracting embeddings:   8%|8         | 42/512 [00:07<00:54,  8.62it/s]Extracting embeddings:   8%|8         | 43/512 [00:07<00:54,  8.62it/s]Extracting embeddings:   9%|8         | 44/512 [00:07<00:54,  8.62it/s]Extracting embeddings:   9%|8         | 45/512 [00:07<00:54,  8.63it/s]Extracting embeddings:   9%|8         | 46/512 [00:07<00:54,  8.61it/s]Extracting embeddings:   9%|9         | 47/512 [00:07<00:53,  8.62it/s]Extracting embeddings:   9%|9         | 48/512 [00:07<00:53,  8.62it/s]Extracting embeddings:  10%|9         | 49/512 [00:07<00:53,  8.62it/s]Extracting embeddings:  10%|9         | 50/512 [00:08<00:53,  8.62it/s]Extracting embeddings:  10%|9         | 51/512 [00:08<00:53,  8.63it/s]Extracting embeddings:  10%|#         | 52/512 [00:08<00:53,  8.63it/s]Extracting embeddings:  10%|#         | 53/512 [00:08<00:53,  8.63it/s]Extracting embeddings:  11%|#         | 54/512 [00:08<00:53,  8.63it/s]Extracting embeddings:  11%|#         | 55/512 [00:08<00:52,  8.63it/s]Extracting embeddings:  11%|#         | 56/512 [00:08<00:52,  8.63it/s]Extracting embeddings:  11%|#1        | 57/512 [00:08<00:52,  8.62it/s]Extracting embeddings:  11%|#1        | 58/512 [00:08<00:52,  8.62it/s]Extracting embeddings:  12%|#1        | 59/512 [00:09<00:52,  8.63it/s]Extracting embeddings:  12%|#1        | 60/512 [00:09<00:52,  8.63it/s]Extracting embeddings:  12%|#1        | 61/512 [00:09<00:52,  8.64it/s]Extracting embeddings:  12%|#2        | 62/512 [00:09<00:52,  8.63it/s]Extracting embeddings:  12%|#2        | 63/512 [00:09<00:52,  8.63it/s]Extracting embeddings:  12%|#2        | 64/512 [00:09<00:51,  8.63it/s]Extracting embeddings:  13%|#2        | 65/512 [00:09<00:51,  8.63it/s]Extracting embeddings:  13%|#2        | 66/512 [00:09<00:51,  8.63it/s]Extracting embeddings:  13%|#3        | 67/512 [00:09<00:51,  8.64it/s]Extracting embeddings:  13%|#3        | 68/512 [00:10<00:51,  8.63it/s]Extracting embeddings:  13%|#3        | 69/512 [00:10<00:51,  8.63it/s]Extracting embeddings:  14%|#3        | 70/512 [00:10<00:51,  8.63it/s]Extracting embeddings:  14%|#3        | 71/512 [00:10<00:51,  8.63it/s]Extracting embeddings:  14%|#4        | 72/512 [00:10<00:50,  8.63it/s]Extracting embeddings:  14%|#4        | 73/512 [00:10<00:50,  8.64it/s]Extracting embeddings:  14%|#4        | 74/512 [00:10<00:50,  8.63it/s]Extracting embeddings:  15%|#4        | 75/512 [00:10<00:50,  8.64it/s]Extracting embeddings:  15%|#4        | 76/512 [00:11<01:05,  6.68it/s]Extracting embeddings:  15%|#5        | 77/512 [00:11<01:00,  7.14it/s]Extracting embeddings:  15%|#5        | 78/512 [00:11<00:57,  7.52it/s]Extracting embeddings:  15%|#5        | 79/512 [00:11<00:55,  7.82it/s]Extracting embeddings:  16%|#5        | 80/512 [00:11<00:53,  8.04it/s]Extracting embeddings:  16%|#5        | 81/512 [00:11<00:52,  8.21it/s]Extracting embeddings:  16%|#6        | 82/512 [00:11<00:51,  8.32it/s]Extracting embeddings:  16%|#6        | 83/512 [00:11<00:50,  8.41it/s]Extracting embeddings:  16%|#6        | 84/512 [00:12<00:50,  8.47it/s]Extracting embeddings:  17%|#6        | 85/512 [00:12<00:50,  8.53it/s]Extracting embeddings:  17%|#6        | 86/512 [00:12<00:49,  8.55it/s]Extracting embeddings:  17%|#6        | 87/512 [00:12<00:49,  8.58it/s]Extracting embeddings:  17%|#7        | 88/512 [00:12<00:49,  8.59it/s]Extracting embeddings:  17%|#7        | 89/512 [00:12<00:49,  8.60it/s]Extracting embeddings:  18%|#7        | 90/512 [00:12<00:49,  8.61it/s]Extracting embeddings:  18%|#7        | 91/512 [00:12<00:48,  8.62it/s]Extracting embeddings:  18%|#7        | 92/512 [00:12<00:48,  8.62it/s]Extracting embeddings:  18%|#8        | 93/512 [00:13<00:48,  8.63it/s]Extracting embeddings:  18%|#8        | 94/512 [00:13<00:48,  8.63it/s]Extracting embeddings:  19%|#8        | 95/512 [00:13<00:48,  8.63it/s]Extracting embeddings:  19%|#8        | 96/512 [00:13<00:48,  8.63it/s]Extracting embeddings:  19%|#8        | 97/512 [00:13<00:48,  8.64it/s]Extracting embeddings:  19%|#9        | 98/512 [00:13<00:47,  8.63it/s]Extracting embeddings:  19%|#9        | 99/512 [00:13<00:47,  8.64it/s]Extracting embeddings:  20%|#9        | 100/512 [00:13<00:47,  8.64it/s]Extracting embeddings:  20%|#9        | 101/512 [00:14<00:47,  8.64it/s]Extracting embeddings:  20%|#9        | 102/512 [00:14<00:47,  8.64it/s]Extracting embeddings:  20%|##        | 103/512 [00:14<00:47,  8.65it/s]Extracting embeddings:  20%|##        | 104/512 [00:14<00:47,  8.64it/s]Extracting embeddings:  21%|##        | 105/512 [00:14<00:47,  8.64it/s]Extracting embeddings:  21%|##        | 106/512 [00:14<00:46,  8.64it/s]Extracting embeddings:  21%|##        | 107/512 [00:14<00:46,  8.65it/s]Extracting embeddings:  21%|##1       | 108/512 [00:14<00:46,  8.64it/s]Extracting embeddings:  21%|##1       | 109/512 [00:14<00:46,  8.64it/s]Extracting embeddings:  21%|##1       | 110/512 [00:15<00:46,  8.64it/s]Extracting embeddings:  22%|##1       | 111/512 [00:15<00:46,  8.64it/s]Extracting embeddings:  22%|##1       | 112/512 [00:15<00:46,  8.64it/s]Extracting embeddings:  22%|##2       | 113/512 [00:15<00:46,  8.64it/s]Extracting embeddings:  22%|##2       | 114/512 [00:15<00:46,  8.64it/s]Extracting embeddings:  22%|##2       | 115/512 [00:15<00:45,  8.64it/s]Extracting embeddings:  23%|##2       | 116/512 [00:15<00:45,  8.64it/s]Extracting embeddings:  23%|##2       | 117/512 [00:15<00:45,  8.64it/s]Extracting embeddings:  23%|##3       | 118/512 [00:15<00:45,  8.64it/s]Extracting embeddings:  23%|##3       | 119/512 [00:16<00:45,  8.64it/s]Extracting embeddings:  23%|##3       | 120/512 [00:16<00:45,  8.64it/s]Extracting embeddings:  24%|##3       | 121/512 [00:16<00:45,  8.65it/s]Extracting embeddings:  24%|##3       | 122/512 [00:16<00:45,  8.64it/s]Extracting embeddings:  24%|##4       | 123/512 [00:16<00:44,  8.65it/s]Extracting embeddings:  24%|##4       | 124/512 [00:16<00:44,  8.65it/s]Extracting embeddings:  24%|##4       | 125/512 [00:16<00:44,  8.65it/s]Extracting embeddings:  25%|##4       | 126/512 [00:16<00:44,  8.65it/s]Extracting embeddings:  25%|##4       | 127/512 [00:17<00:44,  8.65it/s]Extracting embeddings:  25%|##5       | 128/512 [00:17<00:44,  8.64it/s]Extracting embeddings:  25%|##5       | 129/512 [00:17<00:44,  8.65it/s]Extracting embeddings:  25%|##5       | 130/512 [00:17<00:44,  8.64it/s]Extracting embeddings:  26%|##5       | 131/512 [00:17<00:44,  8.65it/s]Extracting embeddings:  26%|##5       | 132/512 [00:17<00:43,  8.65it/s]Extracting embeddings:  26%|##5       | 133/512 [00:17<00:43,  8.65it/s]Extracting embeddings:  26%|##6       | 134/512 [00:17<00:43,  8.64it/s]Extracting embeddings:  26%|##6       | 135/512 [00:17<00:43,  8.65it/s]Extracting embeddings:  27%|##6       | 136/512 [00:18<00:43,  8.65it/s]Extracting embeddings:  27%|##6       | 137/512 [00:18<00:43,  8.65it/s]Extracting embeddings:  27%|##6       | 138/512 [00:18<00:43,  8.64it/s]Extracting embeddings:  27%|##7       | 139/512 [00:18<00:43,  8.65it/s]Extracting embeddings:  27%|##7       | 140/512 [00:18<00:43,  8.64it/s]Extracting embeddings:  28%|##7       | 141/512 [00:18<00:42,  8.65it/s]Extracting embeddings:  28%|##7       | 142/512 [00:18<00:42,  8.64it/s]Extracting embeddings:  28%|##7       | 143/512 [00:18<00:42,  8.65it/s]Extracting embeddings:  28%|##8       | 144/512 [00:19<00:42,  8.65it/s]Extracting embeddings:  28%|##8       | 145/512 [00:19<00:42,  8.66it/s]Extracting embeddings:  29%|##8       | 146/512 [00:19<00:42,  8.66it/s]Extracting embeddings:  29%|##8       | 147/512 [00:19<00:42,  8.67it/s]Extracting embeddings:  29%|##8       | 148/512 [00:19<00:42,  8.66it/s]Extracting embeddings:  29%|##9       | 149/512 [00:19<00:41,  8.66it/s]Extracting embeddings:  29%|##9       | 150/512 [00:19<00:41,  8.65it/s]Extracting embeddings:  29%|##9       | 151/512 [00:19<00:41,  8.66it/s]Extracting embeddings:  30%|##9       | 152/512 [00:19<00:41,  8.66it/s]Extracting embeddings:  30%|##9       | 153/512 [00:20<00:41,  8.66it/s]Extracting embeddings:  30%|###       | 154/512 [00:20<00:41,  8.66it/s]Extracting embeddings:  30%|###       | 155/512 [00:20<00:41,  8.67it/s]Extracting embeddings:  30%|###       | 156/512 [00:20<00:41,  8.66it/s]Extracting embeddings:  31%|###       | 157/512 [00:20<00:40,  8.67it/s]Extracting embeddings:  31%|###       | 158/512 [00:20<00:40,  8.67it/s]Extracting embeddings:  31%|###1      | 159/512 [00:20<00:40,  8.67it/s]Extracting embeddings:  31%|###1      | 160/512 [00:20<00:40,  8.67it/s]Extracting embeddings:  31%|###1      | 161/512 [00:20<00:40,  8.67it/s]Extracting embeddings:  32%|###1      | 162/512 [00:21<00:40,  8.66it/s]Extracting embeddings:  32%|###1      | 163/512 [00:21<00:40,  8.67it/s]Extracting embeddings:  32%|###2      | 164/512 [00:21<00:40,  8.67it/s]Extracting embeddings:  32%|###2      | 165/512 [00:21<00:40,  8.67it/s]Extracting embeddings:  32%|###2      | 166/512 [00:21<00:39,  8.67it/s]Extracting embeddings:  33%|###2      | 167/512 [00:21<00:39,  8.67it/s]Extracting embeddings:  33%|###2      | 168/512 [00:21<00:39,  8.67it/s]Extracting embeddings:  33%|###3      | 169/512 [00:21<00:39,  8.67it/s]Extracting embeddings:  33%|###3      | 170/512 [00:22<00:39,  8.67it/s]Extracting embeddings:  33%|###3      | 171/512 [00:22<00:39,  8.67it/s]Extracting embeddings:  34%|###3      | 172/512 [00:22<00:39,  8.67it/s]Extracting embeddings:  34%|###3      | 173/512 [00:22<00:39,  8.67it/s]Extracting embeddings:  34%|###3      | 174/512 [00:22<00:39,  8.66it/s]Extracting embeddings:  34%|###4      | 175/512 [00:22<00:38,  8.67it/s]Extracting embeddings:  34%|###4      | 176/512 [00:22<00:38,  8.66it/s]Extracting embeddings:  35%|###4      | 177/512 [00:22<00:38,  8.67it/s]Extracting embeddings:  35%|###4      | 178/512 [00:22<00:38,  8.66it/s]Extracting embeddings:  35%|###4      | 179/512 [00:23<00:38,  8.67it/s]Extracting embeddings:  35%|###5      | 180/512 [00:23<00:38,  8.66it/s]Extracting embeddings:  35%|###5      | 181/512 [00:23<00:38,  8.67it/s]Extracting embeddings:  36%|###5      | 182/512 [00:23<00:38,  8.67it/s]Extracting embeddings:  36%|###5      | 183/512 [00:23<00:37,  8.67it/s]Extracting embeddings:  36%|###5      | 184/512 [00:23<00:37,  8.67it/s]Extracting embeddings:  36%|###6      | 185/512 [00:23<00:37,  8.67it/s]Extracting embeddings:  36%|###6      | 186/512 [00:23<00:37,  8.67it/s]Extracting embeddings:  37%|###6      | 187/512 [00:23<00:37,  8.67it/s]Extracting embeddings:  37%|###6      | 188/512 [00:24<00:37,  8.67it/s]Extracting embeddings:  37%|###6      | 189/512 [00:24<00:37,  8.67it/s]Extracting embeddings:  37%|###7      | 190/512 [00:24<00:37,  8.67it/s]Extracting embeddings:  37%|###7      | 191/512 [00:24<00:37,  8.67it/s]Extracting embeddings:  38%|###7      | 192/512 [00:24<00:36,  8.67it/s]Extracting embeddings:  38%|###7      | 193/512 [00:24<00:36,  8.67it/s]Extracting embeddings:  38%|###7      | 194/512 [00:24<00:36,  8.67it/s]Extracting embeddings:  38%|###8      | 195/512 [00:24<00:36,  8.67it/s]Extracting embeddings:  38%|###8      | 196/512 [00:25<00:36,  8.67it/s]Extracting embeddings:  38%|###8      | 197/512 [00:25<00:36,  8.67it/s]Extracting embeddings:  39%|###8      | 198/512 [00:25<00:36,  8.67it/s]Extracting embeddings:  39%|###8      | 199/512 [00:25<00:36,  8.68it/s]Extracting embeddings:  39%|###9      | 200/512 [00:25<00:35,  8.67it/s]Extracting embeddings:  39%|###9      | 201/512 [00:25<00:35,  8.68it/s]Extracting embeddings:  39%|###9      | 202/512 [00:25<00:35,  8.67it/s]Extracting embeddings:  40%|###9      | 203/512 [00:25<00:35,  8.68it/s]Extracting embeddings:  40%|###9      | 204/512 [00:25<00:35,  8.67it/s]Extracting embeddings:  40%|####      | 205/512 [00:26<00:35,  8.67it/s]Extracting embeddings:  40%|####      | 206/512 [00:26<00:35,  8.67it/s]Extracting embeddings:  40%|####      | 207/512 [00:26<00:35,  8.68it/s]Extracting embeddings:  41%|####      | 208/512 [00:26<00:35,  8.67it/s]Extracting embeddings:  41%|####      | 209/512 [00:26<00:34,  8.68it/s]Extracting embeddings:  41%|####1     | 210/512 [00:26<00:34,  8.67it/s]Extracting embeddings:  41%|####1     | 211/512 [00:26<00:34,  8.68it/s]Extracting embeddings:  41%|####1     | 212/512 [00:26<00:34,  8.67it/s]Extracting embeddings:  42%|####1     | 213/512 [00:26<00:34,  8.67it/s]Extracting embeddings:  42%|####1     | 214/512 [00:27<00:34,  8.67it/s]Extracting embeddings:  42%|####1     | 215/512 [00:27<00:34,  8.67it/s]Extracting embeddings:  42%|####2     | 216/512 [00:27<00:34,  8.66it/s]Extracting embeddings:  42%|####2     | 217/512 [00:27<00:34,  8.67it/s]Extracting embeddings:  43%|####2     | 218/512 [00:27<00:33,  8.67it/s]Extracting embeddings:  43%|####2     | 219/512 [00:27<00:33,  8.68it/s]Extracting embeddings:  43%|####2     | 220/512 [00:27<00:33,  8.67it/s]Extracting embeddings:  43%|####3     | 221/512 [00:27<00:33,  8.68it/s]Extracting embeddings:  43%|####3     | 222/512 [00:28<00:33,  8.67it/s]Extracting embeddings:  44%|####3     | 223/512 [00:28<00:33,  8.68it/s]Extracting embeddings:  44%|####3     | 224/512 [00:28<00:33,  8.67it/s]Extracting embeddings:  44%|####3     | 225/512 [00:28<00:33,  8.67it/s]Extracting embeddings:  44%|####4     | 226/512 [00:28<00:32,  8.67it/s]Extracting embeddings:  44%|####4     | 227/512 [00:28<00:32,  8.68it/s]Extracting embeddings:  45%|####4     | 228/512 [00:28<00:32,  8.67it/s]Extracting embeddings:  45%|####4     | 229/512 [00:28<00:32,  8.68it/s]Extracting embeddings:  45%|####4     | 230/512 [00:28<00:32,  8.67it/s]Extracting embeddings:  45%|####5     | 231/512 [00:29<00:32,  8.67it/s]Extracting embeddings:  45%|####5     | 232/512 [00:29<00:32,  8.67it/s]Extracting embeddings:  46%|####5     | 233/512 [00:29<00:32,  8.68it/s]Extracting embeddings:  46%|####5     | 234/512 [00:29<00:32,  8.67it/s]Extracting embeddings:  46%|####5     | 235/512 [00:29<00:31,  8.68it/s]Extracting embeddings:  46%|####6     | 236/512 [00:29<00:31,  8.67it/s]Extracting embeddings:  46%|####6     | 237/512 [00:29<00:31,  8.67it/s]Extracting embeddings:  46%|####6     | 238/512 [00:29<00:31,  8.67it/s]Extracting embeddings:  47%|####6     | 239/512 [00:29<00:31,  8.68it/s]Extracting embeddings:  47%|####6     | 240/512 [00:30<00:31,  8.67it/s]Extracting embeddings:  47%|####7     | 241/512 [00:30<00:31,  8.67it/s]Extracting embeddings:  47%|####7     | 242/512 [00:30<00:31,  8.67it/s]Extracting embeddings:  47%|####7     | 243/512 [00:30<00:31,  8.68it/s]Extracting embeddings:  48%|####7     | 244/512 [00:30<00:30,  8.67it/s]Extracting embeddings:  48%|####7     | 245/512 [00:30<00:30,  8.67it/s]Extracting embeddings:  48%|####8     | 246/512 [00:30<00:30,  8.67it/s]Extracting embeddings:  48%|####8     | 247/512 [00:30<00:30,  8.67it/s]Extracting embeddings:  48%|####8     | 248/512 [00:31<00:39,  6.74it/s]Extracting embeddings:  49%|####8     | 249/512 [00:31<00:36,  7.18it/s]Extracting embeddings:  49%|####8     | 250/512 [00:31<00:34,  7.55it/s]Extracting embeddings:  49%|####9     | 251/512 [00:31<00:33,  7.85it/s]Extracting embeddings:  49%|####9     | 252/512 [00:31<00:32,  8.06it/s]Extracting embeddings:  49%|####9     | 253/512 [00:31<00:31,  8.23it/s]Extracting embeddings:  50%|####9     | 254/512 [00:31<00:30,  8.34it/s]Extracting embeddings:  50%|####9     | 255/512 [00:31<00:30,  8.43it/s]Extracting embeddings:  50%|#####     | 256/512 [00:32<00:30,  8.49it/s]Extracting embeddings:  50%|#####     | 257/512 [00:32<00:29,  8.54it/s]Extracting embeddings:  50%|#####     | 258/512 [00:32<00:29,  8.57it/s]Extracting embeddings:  51%|#####     | 259/512 [00:32<00:29,  8.59it/s]Extracting embeddings:  51%|#####     | 260/512 [00:32<00:29,  8.61it/s]Extracting embeddings:  51%|#####     | 261/512 [00:32<00:29,  8.62it/s]Extracting embeddings:  51%|#####1    | 262/512 [00:32<00:28,  8.62it/s]Extracting embeddings:  51%|#####1    | 263/512 [00:32<00:28,  8.64it/s]Extracting embeddings:  52%|#####1    | 264/512 [00:32<00:28,  8.64it/s]Extracting embeddings:  52%|#####1    | 265/512 [00:33<00:28,  8.64it/s]Extracting embeddings:  52%|#####1    | 266/512 [00:33<00:28,  8.64it/s]Extracting embeddings:  52%|#####2    | 267/512 [00:33<00:28,  8.65it/s]Extracting embeddings:  52%|#####2    | 268/512 [00:33<00:28,  8.64it/s]Extracting embeddings:  53%|#####2    | 269/512 [00:33<00:28,  8.65it/s]Extracting embeddings:  53%|#####2    | 270/512 [00:33<00:27,  8.65it/s]Extracting embeddings:  53%|#####2    | 271/512 [00:33<00:27,  8.65it/s]Extracting embeddings:  53%|#####3    | 272/512 [00:33<00:27,  8.65it/s]Extracting embeddings:  53%|#####3    | 273/512 [00:34<00:27,  8.65it/s]Extracting embeddings:  54%|#####3    | 274/512 [00:34<00:27,  8.65it/s]Extracting embeddings:  54%|#####3    | 275/512 [00:34<00:27,  8.66it/s]Extracting embeddings:  54%|#####3    | 276/512 [00:34<00:27,  8.65it/s]Extracting embeddings:  54%|#####4    | 277/512 [00:34<00:27,  8.66it/s]Extracting embeddings:  54%|#####4    | 278/512 [00:34<00:27,  8.65it/s]Extracting embeddings:  54%|#####4    | 279/512 [00:34<00:26,  8.66it/s]Extracting embeddings:  55%|#####4    | 280/512 [00:34<00:26,  8.65it/s]Extracting embeddings:  55%|#####4    | 281/512 [00:34<00:26,  8.66it/s]Extracting embeddings:  55%|#####5    | 282/512 [00:35<00:26,  8.66it/s]Extracting embeddings:  55%|#####5    | 283/512 [00:35<00:26,  8.66it/s]Extracting embeddings:  55%|#####5    | 284/512 [00:35<00:26,  8.66it/s]Extracting embeddings:  56%|#####5    | 285/512 [00:35<00:26,  8.66it/s]Extracting embeddings:  56%|#####5    | 286/512 [00:35<00:26,  8.66it/s]Extracting embeddings:  56%|#####6    | 287/512 [00:35<00:25,  8.66it/s]Extracting embeddings:  56%|#####6    | 288/512 [00:35<00:25,  8.65it/s]Extracting embeddings:  56%|#####6    | 289/512 [00:35<00:25,  8.66it/s]Extracting embeddings:  57%|#####6    | 290/512 [00:35<00:25,  8.65it/s]Extracting embeddings:  57%|#####6    | 291/512 [00:36<00:25,  8.66it/s]Extracting embeddings:  57%|#####7    | 292/512 [00:36<00:25,  8.66it/s]Extracting embeddings:  57%|#####7    | 293/512 [00:36<00:25,  8.66it/s]Extracting embeddings:  57%|#####7    | 294/512 [00:36<00:25,  8.65it/s]Extracting embeddings:  58%|#####7    | 295/512 [00:36<00:25,  8.66it/s]Extracting embeddings:  58%|#####7    | 296/512 [00:36<00:24,  8.65it/s]Extracting embeddings:  58%|#####8    | 297/512 [00:36<00:24,  8.66it/s]Extracting embeddings:  58%|#####8    | 298/512 [00:36<00:24,  8.65it/s]Extracting embeddings:  58%|#####8    | 299/512 [00:37<00:24,  8.66it/s]Extracting embeddings:  59%|#####8    | 300/512 [00:37<00:24,  8.65it/s]Extracting embeddings:  59%|#####8    | 301/512 [00:37<00:24,  8.66it/s]Extracting embeddings:  59%|#####8    | 302/512 [00:37<00:24,  8.65it/s]Extracting embeddings:  59%|#####9    | 303/512 [00:37<00:24,  8.65it/s]Extracting embeddings:  59%|#####9    | 304/512 [00:37<00:24,  8.65it/s]Extracting embeddings:  60%|#####9    | 305/512 [00:37<00:23,  8.66it/s]Extracting embeddings:  60%|#####9    | 306/512 [00:37<00:23,  8.66it/s]Extracting embeddings:  60%|#####9    | 307/512 [00:37<00:23,  8.66it/s]Extracting embeddings:  60%|######    | 308/512 [00:38<00:23,  8.66it/s]Extracting embeddings:  60%|######    | 309/512 [00:38<00:23,  8.66it/s]Extracting embeddings:  61%|######    | 310/512 [00:38<00:23,  8.66it/s]Extracting embeddings:  61%|######    | 311/512 [00:38<00:23,  8.67it/s]Extracting embeddings:  61%|######    | 312/512 [00:38<00:23,  8.66it/s]Extracting embeddings:  61%|######1   | 313/512 [00:38<00:22,  8.67it/s]Extracting embeddings:  61%|######1   | 314/512 [00:38<00:22,  8.66it/s]Extracting embeddings:  62%|######1   | 315/512 [00:38<00:22,  8.67it/s]Extracting embeddings:  62%|######1   | 316/512 [00:38<00:22,  8.66it/s]Extracting embeddings:  62%|######1   | 317/512 [00:39<00:22,  8.67it/s]Extracting embeddings:  62%|######2   | 318/512 [00:39<00:22,  8.66it/s]Extracting embeddings:  62%|######2   | 319/512 [00:39<00:22,  8.66it/s]Extracting embeddings:  62%|######2   | 320/512 [00:39<00:22,  8.66it/s]Extracting embeddings:  63%|######2   | 321/512 [00:39<00:22,  8.66it/s]Extracting embeddings:  63%|######2   | 322/512 [00:39<00:21,  8.66it/s]Extracting embeddings:  63%|######3   | 323/512 [00:39<00:21,  8.66it/s]Extracting embeddings:  63%|######3   | 324/512 [00:39<00:21,  8.66it/s]Extracting embeddings:  63%|######3   | 325/512 [00:40<00:21,  8.66it/s]Extracting embeddings:  64%|######3   | 326/512 [00:40<00:21,  8.65it/s]Extracting embeddings:  64%|######3   | 327/512 [00:40<00:21,  8.66it/s]Extracting embeddings:  64%|######4   | 328/512 [00:40<00:21,  8.65it/s]Extracting embeddings:  64%|######4   | 329/512 [00:40<00:21,  8.66it/s]Extracting embeddings:  64%|######4   | 330/512 [00:40<00:21,  8.65it/s]Extracting embeddings:  65%|######4   | 331/512 [00:40<00:20,  8.66it/s]Extracting embeddings:  65%|######4   | 332/512 [00:40<00:20,  8.66it/s]Extracting embeddings:  65%|######5   | 333/512 [00:40<00:20,  8.66it/s]Extracting embeddings:  65%|######5   | 334/512 [00:41<00:20,  8.65it/s]Extracting embeddings:  65%|######5   | 335/512 [00:41<00:20,  8.66it/s]Extracting embeddings:  66%|######5   | 336/512 [00:41<00:20,  8.66it/s]Extracting embeddings:  66%|######5   | 337/512 [00:41<00:20,  8.66it/s]Extracting embeddings:  66%|######6   | 338/512 [00:41<00:20,  8.66it/s]Extracting embeddings:  66%|######6   | 339/512 [00:41<00:19,  8.66it/s]Extracting embeddings:  66%|######6   | 340/512 [00:41<00:19,  8.66it/s]Extracting embeddings:  67%|######6   | 341/512 [00:41<00:19,  8.66it/s]Extracting embeddings:  67%|######6   | 342/512 [00:41<00:19,  8.66it/s]Extracting embeddings:  67%|######6   | 343/512 [00:42<00:19,  8.66it/s]Extracting embeddings:  67%|######7   | 344/512 [00:42<00:19,  8.65it/s]Extracting embeddings:  67%|######7   | 345/512 [00:42<00:19,  8.66it/s]Extracting embeddings:  68%|######7   | 346/512 [00:42<00:19,  8.65it/s]Extracting embeddings:  68%|######7   | 347/512 [00:42<00:19,  8.66it/s]Extracting embeddings:  68%|######7   | 348/512 [00:42<00:18,  8.66it/s]Extracting embeddings:  68%|######8   | 349/512 [00:42<00:18,  8.66it/s]Extracting embeddings:  68%|######8   | 350/512 [00:42<00:18,  8.65it/s]Extracting embeddings:  69%|######8   | 351/512 [00:43<00:18,  8.66it/s]Extracting embeddings:  69%|######8   | 352/512 [00:43<00:18,  8.65it/s]Extracting embeddings:  69%|######8   | 353/512 [00:43<00:18,  8.66it/s]Extracting embeddings:  69%|######9   | 354/512 [00:43<00:18,  8.65it/s]Extracting embeddings:  69%|######9   | 355/512 [00:43<00:18,  8.66it/s]Extracting embeddings:  70%|######9   | 356/512 [00:43<00:18,  8.66it/s]Extracting embeddings:  70%|######9   | 357/512 [00:43<00:17,  8.66it/s]Extracting embeddings:  70%|######9   | 358/512 [00:43<00:17,  8.65it/s]Extracting embeddings:  70%|#######   | 359/512 [00:43<00:17,  8.66it/s]Extracting embeddings:  70%|#######   | 360/512 [00:44<00:17,  8.65it/s]Extracting embeddings:  71%|#######   | 361/512 [00:44<00:17,  8.66it/s]Extracting embeddings:  71%|#######   | 362/512 [00:44<00:17,  8.65it/s]Extracting embeddings:  71%|#######   | 363/512 [00:44<00:17,  8.66it/s]Extracting embeddings:  71%|#######1  | 364/512 [00:44<00:17,  8.65it/s]Extracting embeddings:  71%|#######1  | 365/512 [00:44<00:16,  8.65it/s]Extracting embeddings:  71%|#######1  | 366/512 [00:44<00:16,  8.65it/s]Extracting embeddings:  72%|#######1  | 367/512 [00:44<00:16,  8.65it/s]Extracting embeddings:  72%|#######1  | 368/512 [00:44<00:16,  8.65it/s]Extracting embeddings:  72%|#######2  | 369/512 [00:45<00:16,  8.66it/s]Extracting embeddings:  72%|#######2  | 370/512 [00:45<00:16,  8.65it/s]Extracting embeddings:  72%|#######2  | 371/512 [00:45<00:16,  8.65it/s]Extracting embeddings:  73%|#######2  | 372/512 [00:45<00:16,  8.65it/s]Extracting embeddings:  73%|#######2  | 373/512 [00:45<00:16,  8.65it/s]Extracting embeddings:  73%|#######3  | 374/512 [00:45<00:15,  8.65it/s]Extracting embeddings:  73%|#######3  | 375/512 [00:45<00:15,  8.66it/s]Extracting embeddings:  73%|#######3  | 376/512 [00:45<00:15,  8.65it/s]Extracting embeddings:  74%|#######3  | 377/512 [00:46<00:15,  8.65it/s]Extracting embeddings:  74%|#######3  | 378/512 [00:46<00:15,  8.65it/s]Extracting embeddings:  74%|#######4  | 379/512 [00:46<00:15,  8.65it/s]Extracting embeddings:  74%|#######4  | 380/512 [00:46<00:15,  8.65it/s]Extracting embeddings:  74%|#######4  | 381/512 [00:46<00:15,  8.65it/s]Extracting embeddings:  75%|#######4  | 382/512 [00:46<00:15,  8.64it/s]Extracting embeddings:  75%|#######4  | 383/512 [00:46<00:14,  8.65it/s]Extracting embeddings:  75%|#######5  | 384/512 [00:46<00:14,  8.65it/s]Extracting embeddings:  75%|#######5  | 385/512 [00:46<00:14,  8.65it/s]Extracting embeddings:  75%|#######5  | 386/512 [00:47<00:14,  8.65it/s]Extracting embeddings:  76%|#######5  | 387/512 [00:47<00:14,  8.66it/s]Extracting embeddings:  76%|#######5  | 388/512 [00:47<00:14,  8.65it/s]Extracting embeddings:  76%|#######5  | 389/512 [00:47<00:14,  8.66it/s]Extracting embeddings:  76%|#######6  | 390/512 [00:47<00:14,  8.65it/s]Extracting embeddings:  76%|#######6  | 391/512 [00:47<00:13,  8.65it/s]Extracting embeddings:  77%|#######6  | 392/512 [00:47<00:13,  8.65it/s]Extracting embeddings:  77%|#######6  | 393/512 [00:47<00:13,  8.66it/s]Extracting embeddings:  77%|#######6  | 394/512 [00:47<00:13,  8.65it/s]Extracting embeddings:  77%|#######7  | 395/512 [00:48<00:13,  8.65it/s]Extracting embeddings:  77%|#######7  | 396/512 [00:48<00:13,  8.65it/s]Extracting embeddings:  78%|#######7  | 397/512 [00:48<00:13,  8.65it/s]Extracting embeddings:  78%|#######7  | 398/512 [00:48<00:13,  8.65it/s]Extracting embeddings:  78%|#######7  | 399/512 [00:48<00:13,  8.65it/s]Extracting embeddings:  78%|#######8  | 400/512 [00:48<00:12,  8.65it/s]Extracting embeddings:  78%|#######8  | 401/512 [00:48<00:12,  8.65it/s]Extracting embeddings:  79%|#######8  | 402/512 [00:48<00:12,  8.65it/s]Extracting embeddings:  79%|#######8  | 403/512 [00:49<00:12,  8.65it/s]Extracting embeddings:  79%|#######8  | 404/512 [00:49<00:12,  8.65it/s]Extracting embeddings:  79%|#######9  | 405/512 [00:49<00:12,  8.65it/s]Extracting embeddings:  79%|#######9  | 406/512 [00:49<00:12,  8.65it/s]Extracting embeddings:  79%|#######9  | 407/512 [00:49<00:12,  8.65it/s]Extracting embeddings:  80%|#######9  | 408/512 [00:49<00:12,  8.64it/s]Extracting embeddings:  80%|#######9  | 409/512 [00:49<00:11,  8.65it/s]Extracting embeddings:  80%|########  | 410/512 [00:49<00:11,  8.64it/s]Extracting embeddings:  80%|########  | 411/512 [00:49<00:11,  8.65it/s]Extracting embeddings:  80%|########  | 412/512 [00:50<00:11,  8.65it/s]Extracting embeddings:  81%|########  | 413/512 [00:50<00:11,  8.65it/s]Extracting embeddings:  81%|########  | 414/512 [00:50<00:11,  8.64it/s]Extracting embeddings:  81%|########1 | 415/512 [00:50<00:11,  8.65it/s]Extracting embeddings:  81%|########1 | 416/512 [00:50<00:11,  8.64it/s]Extracting embeddings:  81%|########1 | 417/512 [00:50<00:10,  8.65it/s]Extracting embeddings:  82%|########1 | 418/512 [00:50<00:10,  8.64it/s]Extracting embeddings:  82%|########1 | 419/512 [00:50<00:10,  8.65it/s]Extracting embeddings:  82%|########2 | 420/512 [00:51<00:13,  6.68it/s]Extracting embeddings:  82%|########2 | 421/512 [00:51<00:12,  7.13it/s]Extracting embeddings:  82%|########2 | 422/512 [00:51<00:11,  7.51it/s]Extracting embeddings:  83%|########2 | 423/512 [00:51<00:11,  7.81it/s]Extracting embeddings:  83%|########2 | 424/512 [00:51<00:10,  8.03it/s]Extracting embeddings:  83%|########3 | 425/512 [00:51<00:10,  8.20it/s]Extracting embeddings:  83%|########3 | 426/512 [00:51<00:10,  8.31it/s]Extracting embeddings:  83%|########3 | 427/512 [00:51<00:10,  8.41it/s]Extracting embeddings:  84%|########3 | 428/512 [00:52<00:09,  8.46it/s]Extracting embeddings:  84%|########3 | 429/512 [00:52<00:09,  8.51it/s]Extracting embeddings:  84%|########3 | 430/512 [00:52<00:09,  8.54it/s]Extracting embeddings:  84%|########4 | 431/512 [00:52<00:09,  8.56it/s]Extracting embeddings:  84%|########4 | 432/512 [00:52<00:09,  8.57it/s]Extracting embeddings:  85%|########4 | 433/512 [00:52<00:09,  8.59it/s]Extracting embeddings:  85%|########4 | 434/512 [00:52<00:09,  8.59it/s]Extracting embeddings:  85%|########4 | 435/512 [00:52<00:08,  8.61it/s]Extracting embeddings:  85%|########5 | 436/512 [00:52<00:08,  8.61it/s]Extracting embeddings:  85%|########5 | 437/512 [00:53<00:08,  8.62it/s]Extracting embeddings:  86%|########5 | 438/512 [00:53<00:08,  8.61it/s]Extracting embeddings:  86%|########5 | 439/512 [00:53<00:08,  8.63it/s]Extracting embeddings:  86%|########5 | 440/512 [00:53<00:08,  8.62it/s]Extracting embeddings:  86%|########6 | 441/512 [00:53<00:08,  8.63it/s]Extracting embeddings:  86%|########6 | 442/512 [00:53<00:08,  8.63it/s]Extracting embeddings:  87%|########6 | 443/512 [00:53<00:07,  8.64it/s]Extracting embeddings:  87%|########6 | 444/512 [00:53<00:07,  8.63it/s]Extracting embeddings:  87%|########6 | 445/512 [00:54<00:07,  8.64it/s]Extracting embeddings:  87%|########7 | 446/512 [00:54<00:07,  8.64it/s]Extracting embeddings:  87%|########7 | 447/512 [00:54<00:07,  8.64it/s]Extracting embeddings:  88%|########7 | 448/512 [00:54<00:07,  8.64it/s]Extracting embeddings:  88%|########7 | 449/512 [00:54<00:07,  8.64it/s]Extracting embeddings:  88%|########7 | 450/512 [00:54<00:07,  8.63it/s]Extracting embeddings:  88%|########8 | 451/512 [00:54<00:07,  8.64it/s]Extracting embeddings:  88%|########8 | 452/512 [00:54<00:06,  8.64it/s]Extracting embeddings:  88%|########8 | 453/512 [00:54<00:06,  8.64it/s]Extracting embeddings:  89%|########8 | 454/512 [00:55<00:06,  8.64it/s]Extracting embeddings:  89%|########8 | 455/512 [00:55<00:06,  8.64it/s]Extracting embeddings:  89%|########9 | 456/512 [00:55<00:06,  8.64it/s]Extracting embeddings:  89%|########9 | 457/512 [00:55<00:06,  8.64it/s]Extracting embeddings:  89%|########9 | 458/512 [00:55<00:06,  8.64it/s]Extracting embeddings:  90%|########9 | 459/512 [00:55<00:06,  8.65it/s]Extracting embeddings:  90%|########9 | 460/512 [00:55<00:06,  8.64it/s]Extracting embeddings:  90%|######### | 461/512 [00:55<00:05,  8.65it/s]Extracting embeddings:  90%|######### | 462/512 [00:55<00:05,  8.64it/s]Extracting embeddings:  90%|######### | 463/512 [00:56<00:05,  8.65it/s]Extracting embeddings:  91%|######### | 464/512 [00:56<00:05,  8.64it/s]Extracting embeddings:  91%|######### | 465/512 [00:56<00:05,  8.65it/s]Extracting embeddings:  91%|#########1| 466/512 [00:56<00:05,  8.64it/s]Extracting embeddings:  91%|#########1| 467/512 [00:56<00:05,  8.64it/s]Extracting embeddings:  91%|#########1| 468/512 [00:56<00:05,  8.63it/s]Extracting embeddings:  92%|#########1| 469/512 [00:56<00:04,  8.64it/s]Extracting embeddings:  92%|#########1| 470/512 [00:56<00:04,  8.63it/s]Extracting embeddings:  92%|#########1| 471/512 [00:57<00:04,  8.64it/s]Extracting embeddings:  92%|#########2| 472/512 [00:57<00:04,  8.64it/s]Extracting embeddings:  92%|#########2| 473/512 [00:57<00:04,  8.64it/s]Extracting embeddings:  93%|#########2| 474/512 [00:57<00:04,  8.64it/s]Extracting embeddings:  93%|#########2| 475/512 [00:57<00:04,  8.64it/s]Extracting embeddings:  93%|#########2| 476/512 [00:57<00:04,  8.64it/s]Extracting embeddings:  93%|#########3| 477/512 [00:57<00:04,  8.64it/s]Extracting embeddings:  93%|#########3| 478/512 [00:57<00:03,  8.63it/s]Extracting embeddings:  94%|#########3| 479/512 [00:57<00:03,  8.65it/s]Extracting embeddings:  94%|#########3| 480/512 [00:58<00:03,  8.64it/s]Extracting embeddings:  94%|#########3| 481/512 [00:58<00:03,  8.65it/s]Extracting embeddings:  94%|#########4| 482/512 [00:58<00:03,  8.65it/s]Extracting embeddings:  94%|#########4| 483/512 [00:58<00:03,  8.65it/s]Extracting embeddings:  95%|#########4| 484/512 [00:58<00:03,  8.65it/s]Extracting embeddings:  95%|#########4| 485/512 [00:58<00:03,  8.66it/s]Extracting embeddings:  95%|#########4| 486/512 [00:58<00:03,  8.65it/s]Extracting embeddings:  95%|#########5| 487/512 [00:58<00:02,  8.66it/s]Extracting embeddings:  95%|#########5| 488/512 [00:58<00:02,  8.65it/s]Extracting embeddings:  96%|#########5| 489/512 [00:59<00:02,  8.66it/s]Extracting embeddings:  96%|#########5| 490/512 [00:59<00:02,  8.65it/s]Extracting embeddings:  96%|#########5| 491/512 [00:59<00:02,  8.66it/s]Extracting embeddings:  96%|#########6| 492/512 [00:59<00:02,  8.66it/s]Extracting embeddings:  96%|#########6| 493/512 [00:59<00:02,  8.66it/s]Extracting embeddings:  96%|#########6| 494/512 [00:59<00:02,  8.66it/s]Extracting embeddings:  97%|#########6| 495/512 [00:59<00:01,  8.66it/s]Extracting embeddings:  97%|#########6| 496/512 [00:59<00:01,  8.66it/s]Extracting embeddings:  97%|#########7| 497/512 [01:00<00:01,  8.66it/s]Extracting embeddings:  97%|#########7| 498/512 [01:00<00:01,  8.66it/s]Extracting embeddings:  97%|#########7| 499/512 [01:00<00:01,  8.66it/s]Extracting embeddings:  98%|#########7| 500/512 [01:00<00:01,  8.65it/s]Extracting embeddings:  98%|#########7| 501/512 [01:00<00:01,  8.66it/s]Extracting embeddings:  98%|#########8| 502/512 [01:00<00:01,  8.66it/s]Extracting embeddings:  98%|#########8| 503/512 [01:00<00:01,  8.67it/s]Extracting embeddings:  98%|#########8| 504/512 [01:00<00:00,  8.66it/s]Extracting embeddings:  99%|#########8| 505/512 [01:00<00:00,  8.66it/s]Extracting embeddings:  99%|#########8| 506/512 [01:01<00:00,  8.66it/s]Extracting embeddings:  99%|#########9| 507/512 [01:01<00:00,  8.67it/s]Extracting embeddings:  99%|#########9| 508/512 [01:01<00:00,  8.66it/s]Extracting embeddings:  99%|#########9| 509/512 [01:01<00:00,  8.66it/s]Extracting embeddings: 100%|#########9| 510/512 [01:01<00:00,  8.65it/s]Extracting embeddings: 100%|#########9| 511/512 [01:01<00:00,  8.66it/s]Extracting embeddings: 100%|##########| 512/512 [01:01<00:00,  8.66it/s]Extracting embeddings: 100%|##########| 512/512 [01:01<00:00,  8.29it/s]
  Embedding matrix shape: (262144, 384)

Computing PCA for n_samples=512...
  Computed 384 eigenvalues
  Top 10 eigenvalues: [9.4115597e-01 5.1653240e-02 4.1301571e-02 3.5604732e-03 2.9816972e-06
 2.3205364e-06 1.9296547e-06 9.7630175e-07 7.8734433e-07 7.4169759e-07]
  Variance explained by top 10: 100.00%

Computing PCA for n_samples=4096...
  Computed 384 eigenvalues
  Top 10 eigenvalues: [1.0161285e+00 6.4602971e-02 3.0564167e-02 3.7799855e-03 3.1057084e-06
 2.2515501e-06 1.7899083e-06 1.2023581e-06 8.9264034e-07 7.6406138e-07]
  Variance explained by top 10: 100.00%

Computing PCA for n_samples=16384...
  Computed 384 eigenvalues
  Top 10 eigenvalues: [1.0241188e+00 6.3535713e-02 3.2304473e-02 3.7620272e-03 3.1430498e-06
 2.2881561e-06 1.8117407e-06 1.2647253e-06 8.9512071e-07 7.5865631e-07]
  Variance explained by top 10: 100.00%

Computing PCA for n_samples=65536...
  Computed 384 eigenvalues
  Top 10 eigenvalues: [1.0255097e+00 6.4208426e-02 3.2601841e-02 3.8176016e-03 3.1178593e-06
 2.2968911e-06 1.8236714e-06 1.2810572e-06 8.8511962e-07 7.4820139e-07]
  Variance explained by top 10: 100.00%

Computing PCA for n_samples=262144...
  Computed 384 eigenvalues
  Top 10 eigenvalues: [1.0255244e+00 6.2342916e-02 3.1873189e-02 3.8169287e-03 3.1285922e-06
 2.2931538e-06 1.8074559e-06 1.2971814e-06 8.7764772e-07 7.5162518e-07]
  Variance explained by top 10: 100.00%

Fitting full PCA for classification (n=262144)...

Saving checkpoint to: results/sep/v31/eigenspectrum_smarin_l512_n512_4096_16384_65536_262144_pmean.pkl

For n=262144:
  Components needed for 90% variance: 1
  Components needed for 95% variance: 2
  Effective sample size: 1.19476771
  Condition number: 2.11784386e+16

Figure saved to: results/sep/v31/eigenspectrum_smarin_n262144_l512_pmean.png
PDF saved to: results/sep/v31/eigenspectrum_smarin_n262144_l512_pmean.pdf
Eigenvalue data exported to: results/sep/v31/eigenspectrum_smarin_n262144_l512_pmean.csv

======================================================================
PC SCALING ANALYSIS
Testing n_components: [0, 1, 2, 3, 4, 8, 16, 32, 64, 128, 256, 384]
======================================================================
Extracting sequence features:   0%|          | 0/262144 [00:00<?, ?it/s]Extracting sequence features:   2%|1         | 4134/262144 [00:00<00:06, 41338.66it/s]Extracting sequence features:   3%|3         | 8268/262144 [00:00<00:06, 40378.71it/s]Extracting sequence features:   5%|4         | 12308/262144 [00:00<00:06, 39715.61it/s]Extracting sequence features:   6%|6         | 16281/262144 [00:00<00:06, 39562.88it/s]Extracting sequence features:   8%|7         | 20238/262144 [00:00<00:06, 39406.85it/s]Extracting sequence features:   9%|9         | 24179/262144 [00:00<00:06, 39274.52it/s]Extracting sequence features:  11%|#         | 28124/262144 [00:00<00:05, 39327.09it/s]Extracting sequence features:  12%|#2        | 32057/262144 [00:00<00:05, 39302.28it/s]Extracting sequence features:  14%|#3        | 35988/262144 [00:00<00:05, 39273.31it/s]Extracting sequence features:  15%|#5        | 39916/262144 [00:01<00:05, 39158.60it/s]Extracting sequence features:  17%|#6        | 43855/262144 [00:01<00:05, 39191.69it/s]Extracting sequence features:  18%|#8        | 47810/262144 [00:01<00:05, 39294.66it/s]Extracting sequence features:  20%|#9        | 51761/262144 [00:01<00:05, 39354.32it/s]Extracting sequence features:  21%|##1       | 55697/262144 [00:01<00:05, 39350.90it/s]Extracting sequence features:  23%|##2       | 59633/262144 [00:01<00:05, 39308.07it/s]Extracting sequence features:  24%|##4       | 63564/262144 [00:01<00:05, 39276.79it/s]Extracting sequence features:  26%|##5       | 67508/262144 [00:01<00:04, 39321.87it/s]Extracting sequence features:  27%|##7       | 71441/262144 [00:01<00:04, 39253.27it/s]Extracting sequence features:  29%|##8       | 75377/262144 [00:01<00:04, 39283.11it/s]Extracting sequence features:  30%|###       | 79309/262144 [00:02<00:04, 39288.73it/s]Extracting sequence features:  32%|###1      | 83248/262144 [00:02<00:04, 39316.40it/s]Extracting sequence features:  33%|###3      | 87180/262144 [00:02<00:04, 39241.61it/s]Extracting sequence features:  35%|###4      | 91112/262144 [00:02<00:04, 39259.52it/s]Extracting sequence features:  36%|###6      | 95068/262144 [00:02<00:04, 39282.97it/s]Extracting sequence features:  38%|###7      | 99028/262144 [00:02<00:04, 39373.17it/s]Extracting sequence features:  39%|###9      | 102977/262144 [00:02<00:04, 39406.49it/s]Extracting sequence features:  41%|####      | 106918/262144 [00:02<00:03, 39366.40it/s]Extracting sequence features:  42%|####2     | 110855/262144 [00:02<00:03, 39336.17it/s]Extracting sequence features:  44%|####3     | 114789/262144 [00:02<00:03, 39244.01it/s]Extracting sequence features:  45%|####5     | 118722/262144 [00:03<00:03, 39220.59it/s]Extracting sequence features:  47%|####6     | 122652/262144 [00:03<00:03, 39233.00it/s]Extracting sequence features:  48%|####8     | 126602/262144 [00:03<00:03, 39311.45it/s]Extracting sequence features:  50%|####9     | 130534/262144 [00:03<00:03, 39308.74it/s]Extracting sequence features:  51%|#####1    | 134471/262144 [00:03<00:03, 39320.68it/s]Extracting sequence features:  53%|#####2    | 138404/262144 [00:03<00:03, 39299.50it/s]Extracting sequence features:  54%|#####4    | 142341/262144 [00:03<00:03, 39317.63it/s]Extracting sequence features:  56%|#####5    | 146273/262144 [00:03<00:02, 39312.09it/s]Extracting sequence features:  57%|#####7    | 150210/262144 [00:03<00:02, 39327.77it/s]Extracting sequence features:  59%|#####8    | 154143/262144 [00:03<00:02, 39308.81it/s]Extracting sequence features:  60%|######    | 158074/262144 [00:04<00:02, 39147.56it/s]Extracting sequence features:  62%|######1   | 161999/262144 [00:04<00:02, 39171.92it/s]Extracting sequence features:  63%|######3   | 165955/262144 [00:04<00:02, 39283.75it/s]Extracting sequence features:  65%|######4   | 169907/262144 [00:04<00:02, 39354.03it/s]Extracting sequence features:  66%|######6   | 173846/262144 [00:04<00:02, 39358.75it/s]Extracting sequence features:  68%|######7   | 177782/262144 [00:04<00:02, 39343.81it/s]Extracting sequence features:  69%|######9   | 181717/262144 [00:04<00:02, 39295.98it/s]Extracting sequence features:  71%|#######   | 185648/262144 [00:04<00:01, 39237.65it/s]Extracting sequence features:  72%|#######2  | 189580/262144 [00:04<00:01, 39261.44it/s]Extracting sequence features:  74%|#######3  | 193507/262144 [00:04<00:01, 39250.50it/s]Extracting sequence features:  75%|#######5  | 197472/262144 [00:05<00:01, 39369.84it/s]Extracting sequence features:  77%|#######6  | 201410/262144 [00:05<00:01, 39343.60it/s]Extracting sequence features:  78%|#######8  | 205345/262144 [00:05<00:01, 39276.50it/s]Extracting sequence features:  80%|#######9  | 209274/262144 [00:05<00:01, 39278.40it/s]Extracting sequence features:  81%|########1 | 213202/262144 [00:05<00:01, 39273.98it/s]Extracting sequence features:  83%|########2 | 217130/262144 [00:05<00:01, 39227.09it/s]Extracting sequence features:  84%|########4 | 221056/262144 [00:05<00:01, 39233.70it/s]Extracting sequence features:  86%|########5 | 224980/262144 [00:05<00:00, 39224.06it/s]Extracting sequence features:  87%|########7 | 228918/262144 [00:05<00:00, 39269.43it/s]Extracting sequence features:  89%|########8 | 232845/262144 [00:05<00:00, 39180.37it/s]Extracting sequence features:  90%|######### | 236766/262144 [00:06<00:00, 39159.93it/s]Extracting sequence features:  92%|#########1| 240689/262144 [00:06<00:00, 39136.97it/s]Extracting sequence features:  93%|#########3| 244618/262144 [00:06<00:00, 39182.49it/s]Extracting sequence features:  95%|#########4| 248537/262144 [00:06<00:00, 39183.82it/s]Extracting sequence features:  96%|#########6| 252463/262144 [00:06<00:00, 39194.17it/s]Extracting sequence features:  98%|#########7| 256390/262144 [00:06<00:00, 39183.65it/s]Extracting sequence features:  99%|#########9| 260313/262144 [00:06<00:00, 39181.17it/s]Extracting sequence features: 100%|##########| 262144/262144 [00:06<00:00, 39301.61it/s]
[species[n_comp=0]] Filtered: 406/417 classes, 262127/262144 samples
  Classes: Acanthaster planci, Acanthisitta chloris, Acanthopagrus latus, Acipenser ruthenus, Acropora millepora, Actinia tenebrosa, Adelges cooleyi, Aethina tumida, Agrilus planipennis, Alligator mississippiensis, ... (+396 more)
  species              Performance by n_components:
    Accuracy:  0.081 0.081 0.005 0.007 0.005 0.005 0.009 0.007 0.005 0.009 0.006 0.005
    F1:        0.000 0.001 0.002 0.003 0.003 0.003 0.006 0.004 0.001 0.004 0.005 0.003
    ROC AUC:   0.502 0.713 0.501 0.501 0.501 0.501 0.503 0.502 0.500 0.502 0.502 0.501
    AUPRC:     0.003 0.006 0.002 0.003 0.003 0.003 0.003 0.003 0.003 0.003 0.003 0.003
[gc_content[n_comp=0]] 5 classes, 262144 samples
  Classes: 0.094-0.365, 0.365-0.416, 0.416-0.475, 0.475-0.586, 0.586-1.000
  gc_content           Performance by n_components:
    Accuracy:  0.198 0.851 0.851 0.855 0.854 0.862 0.895 0.910 0.920 0.923 0.924 0.923
    F1:        0.190 0.852 0.851 0.855 0.855 0.862 0.895 0.910 0.920 0.923 0.924 0.923
    ROC AUC:   0.500 0.979 0.979 0.980 0.980 0.982 0.988 0.992 0.993 0.994 0.994 0.994
    AUPRC:     0.199 0.909 0.911 0.915 0.915 0.923 0.951 0.967 0.972 0.973 0.974 0.973
[repeat_fraction[n_comp=0]] 5 classes, 262144 samples
  Classes: 0.000-0.055, 0.055-0.123, 0.123-0.193, 0.193-0.311, 0.311-1.000
  repeat_fraction      Performance by n_components:
    Accuracy:  0.201 0.310 0.331 0.341 0.349 0.383 0.412 0.420 0.429 0.432 0.436 0.435
    F1:        0.198 0.304 0.323 0.331 0.341 0.375 0.405 0.414 0.423 0.426 0.430 0.429
    ROC AUC:   0.498 0.630 0.657 0.669 0.679 0.715 0.745 0.750 0.759 0.762 0.764 0.764
    AUPRC:     0.199 0.309 0.331 0.341 0.353 0.389 0.423 0.432 0.442 0.446 0.449 0.448
[kmer_entropy_1[n_comp=0]] 5 classes, 262144 samples
  Classes: 0.000-1.896, 1.896-1.944, 1.944-1.968, 1.968-1.985, 1.985-2.000
  kmer_entropy_1       Performance by n_components:
    Accuracy:  0.199 0.671 0.707 0.740 0.744 0.760 0.793 0.810 0.813 0.815 0.814 0.814
    F1:        0.198 0.670 0.708 0.740 0.745 0.761 0.794 0.810 0.814 0.815 0.814 0.814
    ROC AUC:   0.498 0.902 0.928 0.944 0.946 0.952 0.962 0.968 0.969 0.969 0.968 0.968
    AUPRC:     0.199 0.681 0.742 0.789 0.794 0.812 0.850 0.870 0.874 0.874 0.873 0.873
[kmer_entropy_3[n_comp=0]] 5 classes, 262144 samples
  Classes: 0.000-5.507, 5.507-5.650, 5.650-5.727, 5.727-5.794, 5.794-5.949
  kmer_entropy_3       Performance by n_components:
    Accuracy:  0.201 0.514 0.574 0.609 0.630 0.686 0.713 0.721 0.731 0.737 0.736 0.735
    F1:        0.201 0.507 0.571 0.605 0.627 0.685 0.713 0.721 0.732 0.737 0.736 0.735
    ROC AUC:   0.499 0.810 0.858 0.879 0.893 0.920 0.932 0.936 0.940 0.942 0.942 0.941
    AUPRC:     0.199 0.518 0.591 0.630 0.657 0.723 0.755 0.765 0.777 0.783 0.782 0.781
[kmer_entropy_9[n_comp=0]] 5 classes, 262144 samples
  Classes: 0.000-8.920, 8.920-8.957, 8.957-8.969, 8.969-8.973, 8.973-8.977
  kmer_entropy_9       Performance by n_components:
    Accuracy:  0.345 0.408 0.441 0.459 0.465 0.493 0.508 0.521 0.535 0.540 0.543 0.543
    F1:        0.102 0.250 0.286 0.304 0.312 0.342 0.362 0.378 0.392 0.398 0.400 0.400
    ROC AUC:   0.502 0.619 0.653 0.674 0.683 0.715 0.732 0.743 0.758 0.765 0.767 0.767
    AUPRC:     0.201 0.298 0.336 0.357 0.369 0.402 0.420 0.436 0.451 0.459 0.462 0.462
[dinuc_CG[n_comp=0]] 5 classes, 262144 samples
  Classes: 0.000-0.014, 0.014-0.027, 0.027-0.041, 0.041-0.067, 0.067-0.384
  dinuc_CG             Performance by n_components:
    Accuracy:  0.218 0.418 0.484 0.497 0.550 0.711 0.763 0.790 0.802 0.807 0.807 0.809
    F1:        0.148 0.409 0.487 0.499 0.549 0.715 0.766 0.794 0.805 0.810 0.810 0.812
    ROC AUC:   0.501 0.747 0.792 0.805 0.848 0.933 0.952 0.961 0.965 0.967 0.967 0.967
    AUPRC:     0.201 0.434 0.502 0.521 0.582 0.762 0.817 0.850 0.866 0.872 0.872 0.873
[dinuc_GC[n_comp=0]] 5 classes, 262144 samples
  Classes: 0.000-0.033, 0.033-0.045, 0.045-0.059, 0.059-0.086, 0.086-0.382
  dinuc_GC             Performance by n_components:
    Accuracy:  0.206 0.604 0.615 0.615 0.625 0.635 0.655 0.684 0.704 0.724 0.728 0.729
    F1:        0.185 0.607 0.619 0.618 0.628 0.638 0.658 0.687 0.707 0.727 0.731 0.732
    ROC AUC:   0.502 0.877 0.884 0.885 0.890 0.895 0.905 0.918 0.927 0.935 0.937 0.937
    AUPRC:     0.201 0.626 0.638 0.640 0.652 0.664 0.686 0.718 0.740 0.761 0.766 0.766
[dinuc_AT[n_comp=0]] 5 classes, 262144 samples
  Classes: 0.000-0.031, 0.031-0.055, 0.055-0.072, 0.072-0.092, 0.092-0.376
  dinuc_AT             Performance by n_components:
    Accuracy:  0.203 0.665 0.666 0.668 0.669 0.693 0.716 0.735 0.757 0.773 0.780 0.780
    F1:        0.166 0.669 0.670 0.672 0.672 0.696 0.719 0.737 0.760 0.775 0.782 0.782
    ROC AUC:   0.500 0.911 0.912 0.913 0.914 0.925 0.934 0.942 0.949 0.955 0.957 0.957
    AUPRC:     0.199 0.691 0.697 0.699 0.702 0.730 0.755 0.777 0.797 0.814 0.821 0.822
[dinuc_TA[n_comp=0]] 5 classes, 262144 samples
  Classes: 0.000-0.023, 0.023-0.045, 0.045-0.063, 0.063-0.082, 0.082-0.376
  dinuc_TA             Performance by n_components:
    Accuracy:  0.203 0.639 0.648 0.650 0.655 0.706 0.733 0.751 0.779 0.788 0.789 0.790
    F1:        0.183 0.642 0.653 0.654 0.658 0.709 0.735 0.754 0.781 0.790 0.791 0.791
    ROC AUC:   0.499 0.900 0.903 0.904 0.906 0.930 0.941 0.948 0.958 0.960 0.961 0.961
    AUPRC:     0.200 0.664 0.675 0.676 0.683 0.746 0.777 0.798 0.829 0.838 0.839 0.839
[dinuc_AA[n_comp=0]] 5 classes, 262144 samples
  Classes: 0.000-0.045, 0.045-0.072, 0.072-0.094, 0.094-0.117, 0.117-0.456
  dinuc_AA             Performance by n_components:
    Accuracy:  0.206 0.534 0.559 0.628 0.631 0.653 0.697 0.724 0.734 0.743 0.746 0.745
    F1:        0.172 0.530 0.557 0.625 0.628 0.650 0.695 0.723 0.733 0.741 0.744 0.744
    ROC AUC:   0.499 0.833 0.852 0.892 0.895 0.906 0.926 0.937 0.941 0.944 0.945 0.945
    AUPRC:     0.200 0.544 0.576 0.653 0.659 0.684 0.731 0.762 0.772 0.781 0.783 0.783
[dinuc_TT[n_comp=0]] 5 classes, 262144 samples
  Classes: 0.000-0.043, 0.043-0.072, 0.072-0.094, 0.094-0.117, 0.117-0.550
  dinuc_TT             Performance by n_components:
    Accuracy:  0.207 0.535 0.553 0.637 0.640 0.667 0.715 0.725 0.743 0.751 0.752 0.751
    F1:        0.181 0.536 0.553 0.637 0.640 0.667 0.715 0.725 0.743 0.751 0.752 0.751
    ROC AUC:   0.501 0.835 0.848 0.897 0.899 0.911 0.933 0.937 0.944 0.946 0.947 0.947
    AUPRC:     0.201 0.550 0.575 0.666 0.671 0.700 0.756 0.767 0.784 0.792 0.794 0.794

PC scaling curves saved to: results/sep/v31/pc_scaling_curves.png
PC scaling curves PDF saved to: results/sep/v31/pc_scaling_curves.pdf
PC scaling data exported to: results/sep/v31/pc_scaling_curves.csv

======================================================================
SUMMARY: F1 by n_components
======================================================================
Target                     0       1       2       3       4       8      16      32      64     128     256     384
--------------------------------------------------------------------------------------------------------------------
dinuc_AA               0.172   0.530   0.557   0.625   0.628   0.650   0.695   0.723   0.733   0.741   0.744   0.744
dinuc_AT               0.166   0.669   0.670   0.672   0.672   0.696   0.719   0.737   0.760   0.775   0.782   0.782
dinuc_CG               0.148   0.409   0.487   0.499   0.549   0.715   0.766   0.794   0.805   0.810   0.810   0.812
dinuc_GC               0.185   0.607   0.619   0.618   0.628   0.638   0.658   0.687   0.707   0.727   0.731   0.732
dinuc_TA               0.183   0.642   0.653   0.654   0.658   0.709   0.735   0.754   0.781   0.790   0.791   0.791
dinuc_TT               0.181   0.536   0.553   0.637   0.640   0.667   0.715   0.725   0.743   0.751   0.752   0.751
gc_content             0.190   0.852   0.851   0.855   0.855   0.862   0.895   0.910   0.920   0.923   0.924   0.923
kmer_entropy_1         0.198   0.670   0.708   0.740   0.745   0.761   0.794   0.810   0.814   0.815   0.814   0.814
kmer_entropy_3         0.201   0.507   0.571   0.605   0.627   0.685   0.713   0.721   0.732   0.737   0.736   0.735
kmer_entropy_9         0.102   0.250   0.286   0.304   0.312   0.342   0.362   0.378   0.392   0.398   0.400   0.400
repeat_fraction        0.198   0.304   0.323   0.331   0.341   0.375   0.405   0.414   0.423   0.426   0.430   0.429
species                0.000   0.001   0.002   0.003   0.003   0.003   0.006   0.004   0.001   0.004   0.005   0.003

Training species classifier with n_components=384 PCs...
[Species] Filtered: 406/417 classes, 262127/262144 samples
  Classes: Acanthaster planci, Acanthisitta chloris, Acanthopagrus latus, Acipenser ruthenus, Acropora millepora, Actinia tenebrosa, Adelges cooleyi, Aethina tumida, Agrilus planipennis, Alligator mississippiensis, ... (+396 more)

[Species] n_classes=406, acc=0.008, f1=0.005
Confusion matrix saved to: results/sep/v31/eigenspectrum_smarin_n262144_l512_pmean_confusion_matrix.png
Confusion matrix PDF saved to: results/sep/v31/eigenspectrum_smarin_n262144_l512_pmean_confusion_matrix.pdf
Confusion matrix data exported to: results/sep/v31/eigenspectrum_smarin_n262144_l512_pmean_confusion_matrix.csv
Classification metrics exported to: results/sep/v31/eigenspectrum_smarin_n262144_l512_pmean_confusion_matrix_metrics.csv

Run completed: 2025-12-30T23:21:46.765893

Done!
